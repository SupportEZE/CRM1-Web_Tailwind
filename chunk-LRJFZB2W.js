import{a as zt}from"./chunk-Z42RT33F.js";import{c as Ct}from"./chunk-7FUDRD4B.js";import{a as Ht}from"./chunk-PJTW4QXW.js";import{a as qt}from"./chunk-SQZ3YN6N.js";import{c as Wt}from"./chunk-CIBZCVJQ.js";import{a as z}from"./chunk-OTFCGVEU.js";import{a as Lt}from"./chunk-OEHD5D2Y.js";import{a as Yt}from"./chunk-GLWQGYBC.js";import{a as bt}from"./chunk-DC4QM32I.js";import{A as Nt,B as jt,C as Y,D as Qt,F as q,c as gt,r as At,s as Rt,t as Bt,v as Ot,w as Pt}from"./chunk-VHE3PQ3O.js";import{$ as ft,A as X,B as rt,C as dt,E as st,G as pt,Ga as Dt,H as mt,M as ct,Oa as St,P as ut,Pa as Et,Qa as It,R as vt,Ra as Mt,Ta as Tt,Ua as wt,V as _t,W as j,X as xt,Ya as kt,Z as W,Za as Ft,hb as H,jb as Vt,oa as yt,p as lt,w as N,wa as ht,z as ot}from"./chunk-GYDYF5F3.js";import{K as nt,M as at,e as J,f as B,g as O,n as tt,o as et,q as it,t as P}from"./chunk-PD5VTTIY.js";import{Aa as f,Ba as g,Bc as G,Hb as R,Lc as T,Mc as a,Nc as p,Ob as c,Oc as _,Pc as w,Sc as Z,Uc as U,Vc as $,Wc as K,Yc as S,Zc as F,_b as r,bc as I,cc as Q,ed as b,fd as k,gd as D,kc as i,lc as e,mc as u,nc as C,oc as y,qc as M,rb as n,sb as x,wc as h,yc as m}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{g as Xt}from"./chunk-66YHNWRR.js";function oe(l,o){if(l&1&&(i(0,"mat-option",20),a(1),e()),l&2){let t=o.$implicit;r("value",t.name),n(),p(t.name)}}function re(l,o){l&1&&(C(0),a(1,"This field is required"),y())}function de(l,o){if(l&1&&(i(0,"div",21),c(1,re,2,0,"ng-container",22),e()),l&2){m();let t=T(12);n(),r("ngIf",t.errors==null?null:t.errors.required)}}function se(l,o){l&1&&(C(0),a(1,"This field is required"),y())}function pe(l,o){if(l&1&&(i(0,"div",21),c(1,se,2,0,"ng-container",22),e()),l&2){m();let t=T(22);n(),r("ngIf",t.errors==null?null:t.errors.required)}}function me(l,o){if(l&1){let t=M();i(0,"div",4)(1,"app-modal-header",5),h("close",function(){f(t);let d=m();return g(d.closeModal())}),e(),i(2,"form",6,0),h("ngSubmit",function(){f(t);let d=T(3),v=m();return g(d.valid&&v.statusChange())}),i(4,"mat-dialog-content",7)(5,"div",8)(6,"label",9),a(7),i(8,"span",10),a(9,"*"),e()(),i(10,"mat-form-field",11)(11,"mat-select",12,1),K("ngModelChange",function(d){f(t);let v=m();return $(v.data.status,d)||(v.data.status=d),g(d)}),c(13,oe,2,2,"mat-option",13),e()(),c(14,de,2,1,"div",14),e(),i(15,"div",15)(16,"label",9),a(17,"Reason"),i(18,"span",10),a(19,"*"),e()(),i(20,"mat-form-field",16)(21,"textarea",17,2),K("ngModelChange",function(d){f(t);let v=m();return $(v.data.reason,d)||(v.data.reason=d),g(d)}),e()(),c(23,pe,2,1,"div",14),e()(),i(24,"mat-dialog-actions",18),u(25,"app-button",19),e()()()}if(l&2){let t=T(3),s=T(12),d=T(22),v=m();n(),r("title","Change Status")("closeBtn",!0),n(6),_("Status ",v.data.status,""),n(4),U("ngModel",v.data.status),n(2),r("ngForOf",v.modalData.options),n(),r("ngIf",s.touched||t.submitted),n(7),U("ngModel",v.data.reason),n(2),r("ngIf",d.touched||t.submitted),n(2),r("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("disabled",v.api.disabled)("formType",v.modalData.formType)("iconClass","ri-save-line")("loadingIconClass","ri-loader-2-fill")}}function ce(l,o){if(l&1){let t=M();i(0,"div",4)(1,"app-modal-header",5),h("close",function(){f(t);let d=m();return g(d.closeModal())}),e(),i(2,"form",23),h("ngSubmit",function(){f(t);let d=m();return g(d.updateLocation())}),i(3,"mat-dialog-content",7)(4,"div",24)(5,"div",25),u(6,"spk-input",26),e(),i(7,"div",25),u(8,"spk-input",27),e()()(),i(9,"mat-dialog-actions",28),u(10,"app-button",29)(11,"app-button",19),e()()()}if(l&2){let t=m();n(),r("title","Point Location")("closeBtn",!0),n(),r("formGroup",t.poinLocationForm),n(8),r("buttonType","button")("buttonClass","ti-btn ti-btn-outline-danger m-2")("label","Cancel"),n(),r("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("disabled",t.api.disabled)("formType","add")("iconClass","ri-save-line")("loadingIconClass","ri-loader-2-fill")}}var L=class l{constructor(o,t,s,d,v,Ut,$t,Kt){this.modalData=o;this.api=t;this.comanFuncation=s;this.dialogRef=d;this.fb=v;this.logService=Ut;this.toastr=$t;this.formValidation=Kt;this.data.status=o.status,this.data.reason=o.reason}data={};skloader=!1;poinLocationForm;pageType="add";originalData={};editId;ngOnInit(){this.poinLocationForm=this.fb.group({lat:["",X.required],long:["",X.required]}),this.modalData.pageType==="point_location"&&(this.data=this.modalData.data,this.data&&(this.originalData=this.data,this.poinLocationForm.patchValue(this.data),this.editId=this.data._id,this.pageType=this.data._id?"edit":"add"))}statusChange(){this.skloader=!0,this.comanFuncation.statusChange(this.data.status,this.modalData.DetailId,this.modalData.status,this.modalData.subModule,"without-toggle",this.modalData.apiPath,this.data.reason,this.modalData.reason).subscribe(o=>{this.skloader=!1,o&&this.dialogRef.close(!0)})}updateLocation(){if(this.poinLocationForm.valid){this.poinLocationForm.value._id=this.modalData.DetailId;let o=this.pageType==="edit";if(o&&this.logService.logActivityOnUpdate(o,this.originalData,this.poinLocationForm.value,this.modalData.submodule.module_id,this.modalData.submodule.title,"update",this.modalData.DetailId||null,()=>{},this.modalData.submodule.module_type)){this.api.disabled=!1,this.toastr.warning("No changes detected","","toast-top-right");return}this.api.disabled=!0,this.api.patch(this.poinLocationForm.value,"complaint/save-location").subscribe(t=>{t.statusCode==200&&(this.api.disabled=!1,this.dialogRef.close(!0),this.toastr.success(t.message,"","toast-top-right"))})}else this.formValidation.markFormGroupTouched(this.poinLocationForm)}closeModal(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||l)(x(Et),x(W),x(Wt),x(St),x(_t),x(z),x(N),x(Ot))};static \u0275cmp=R({type:l,selectors:[["app-complaint-modal"]],decls:2,vars:2,consts:[["f","ngForm"],["status","ngModel"],["reason","ngModel"],["class","mat-dialoge",4,"ngIf"],[1,"mat-dialoge"],[3,"close","title","closeBtn"],[3,"ngSubmit"],[1,"mat-typography"],[1,""],[1,"form-label","mb-0"],[1,"text-red-500"],[1,"mat-custom-field","remove-space"],["placeholder","Select an option","name","status","required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","mt-1 text-xs text-red-500 text-right",4,"ngIf"],[1,"mt-2"],[1,"mat-custom-field","remove-space","text-area-height"],["matInput","","placeholder","Type Here ...","name","reason","required","",3,"ngModelChange","ngModel"],["align","end",1,"gap-2"],[3,"buttonType","buttonClass","disabled","formType","iconClass","loadingIconClass"],[3,"value"],[1,"mt-1","text-xs","text-red-500","text-right"],[4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xxl:col-span-12","xl:col-span-12","lg:col-span-12","md:col-span-6","col-span-12"],["label","Latitude","formControlName","lat","type","number",1,"remove-default-class"],["label","Longitude","formControlName","long","type","number",1,"remove-default-class"],["align","end"],["mat-dialog-close","",3,"buttonType","buttonClass","label"]],template:function(t,s){t&1&&c(0,me,26,14,"div",3)(1,ce,12,12,"div",3),t&2&&(r("ngIf",s.modalData.lastPage==="complaint"),n(),r("ngIf",s.modalData.pageType==="point_location"))},dependencies:[xt,mt,ot,rt,dt,vt,ct,ut,H,yt,Mt,wt,Tt,Dt,ht,kt,q,B,O,pt,st,Pt,Y,P,j,At],encapsulation:2})};var E=Xt(Qt());var ue=()=>["Complaint Detail"],A=l=>({active:l}),V=()=>[];function ve(l,o){if(l&1&&(C(0),i(1,"tr",53)(2,"td")(3,"span",54),a(4,"Name :"),e()(),i(5,"td")(6,"div",39)(7,"span",55),a(8),e()()()(),i(9,"tr",53)(10,"td")(11,"span",54),a(12,"Priority Type :"),e()(),i(13,"td")(14,"span",56),a(15),b(16,"titlecase"),e()()(),i(17,"tr",53)(18,"td")(19,"span",54),a(20,"Date :"),e()(),i(21,"td")(22,"span",57),a(23),b(24,"date"),e(),i(25,"span",58),a(26),e()()(),i(27,"tr",53)(28,"td",59)(29,"span",54),a(30,"Remark :"),e()(),i(31,"td")(32,"span",60),a(33),e()()(),y()),l&2){let t=m(2);n(8),p((t.Detail==null?null:t.Detail.service_engineer_name)||"--"),n(7),_(" ",t.Detail!=null&&t.Detail.priority?k(16,6,t.Detail.priority):"--"," "),n(8),_(" ",t.Detail!=null&&t.Detail.visit_date?D(24,8,t.Detail==null?null:t.Detail.visit_date,"d MMM yyyy"):"--"," "),n(3),_(" ",t.getTatDaysReadable(t.Detail==null?null:t.Detail.tat_days)," "),n(6),G("matTooltip",t.Detail==null?null:t.Detail.remark),n(),p((t.Detail==null?null:t.Detail.remark)||"--")}}function _e(l,o){if(l&1&&(C(0),i(1,"tr",53)(2,"td")(3,"span",54),a(4,"Name :"),e()(),i(5,"td")(6,"div",39)(7,"span",55),a(8),e()()()(),i(9,"tr",53)(10,"td")(11,"span",54),a(12,"Type :"),e()(),i(13,"td")(14,"span",56),u(15,"i"),a(16),b(17,"titlecase"),e()()(),i(18,"tr",53)(19,"td")(20,"span",54),a(21,"Date :"),e()(),i(22,"td")(23,"span",57),a(24),b(25,"date"),e(),i(26,"span",58),a(27),e()()(),i(28,"tr",53)(29,"td",59)(30,"span",54),a(31,"Remark :"),e()(),i(32,"td")(33,"span",60),a(34),e()()(),y()),l&2){let t=m(2);n(8),w("",(t.Detail==null||t.Detail.last_activity==null||t.Detail.last_activity.customer_details==null?null:t.Detail.last_activity.customer_details.customer_name)||"--"," (",(t.Detail==null||t.Detail.last_activity==null||t.Detail.last_activity.customer_details==null?null:t.Detail.last_activity.customer_details.mobile)||"--",")"),n(7),Q("ri-",(t.Detail==null||t.Detail.last_activity==null?null:t.Detail.last_activity.visit_type)==="call"?"phone":"walk","-fill text-[11px] me-1"),n(),_(" ",!(t.Detail==null||t.Detail.last_activity==null)&&t.Detail.last_activity.visit_type?k(17,10,t.Detail.last_activity.visit_type):"--"," "),n(8),_(" ",!(t.Detail==null||t.Detail.last_activity==null)&&t.Detail.last_activity.activity_date?D(25,12,t.Detail==null||t.Detail.last_activity==null?null:t.Detail.last_activity.activity_date,"d MMM yyyy"):"--"," "),n(3),_(" ",t.getTatDaysReadable(t.Detail==null||t.Detail.last_activity==null?null:t.Detail.last_activity.tat_days)," "),n(6),G("matTooltip",t.Detail==null||t.Detail.last_activity==null?null:t.Detail.last_activity.remark),n(),p((t.Detail==null||t.Detail.last_activity==null?null:t.Detail.last_activity.remark)||"--")}}function xe(l,o){if(l&1&&(i(0,"div",39)(1,"div")(2,"span",40),a(3,"Reason"),e(),i(4,"span",41),a(5),e()()()),l&2){let t=m(2);n(5),_("",(t.Detail==null?null:t.Detail.reason)||"--"," ")}}function fe(l,o){if(l&1&&(i(0,"div",61)(1,"div")(2,"span",40),a(3),e(),i(4,"span",41),a(5),e()()()),l&2){let t=o.$implicit;n(3),p(t.key),n(2),p(t.value)}}function ge(l,o){if(l&1&&(i(0,"div")(1,"span",72),u(2,"i",73),e(),i(3,"p",66)(4,"span",67)(5,"span",68),a(6),e(),a(7),e(),i(8,"span",74),a(9),b(10,"titlecase"),b(11,"date"),e()(),i(12,"p",70)(13,"span",54),a(14,"Call Start : "),e(),a(15),b(16,"date"),e(),i(17,"p",70)(18,"span",54),a(19,"Call End : "),e(),a(20),b(21,"date"),e(),i(22,"p",70)(23,"span",54),a(24,"Remark : "),e(),a(25),e(),i(26,"audio",75),u(27,"source",76),e()()),l&2){let t=m().$implicit;n(6),_("",t==null||t.customer_details==null?null:t.customer_details.customer_name," "),n(),_("",t==null||t.customer_details==null?null:t.customer_details.mobile," "),n(2),w("",k(10,7,t.type)," - ",t!=null&&t.activity_date?D(11,9,t==null?null:t.activity_date,"d MMM yyyy, hh:mm a"):"--",""),n(6),_(" ",t!=null&&t.call_start?D(16,12,t==null?null:t.call_start,"hh:mm a"):"--"," "),n(5),_(" ",t!=null&&t.call_end?D(21,15,t==null?null:t.call_end,"hh:mm a"):"--"," "),n(5),_(" ",(t==null?null:t.remark)||"--"," ")}}function be(l,o){if(l&1&&(i(0,"li")(1,"div")(2,"span",64),u(3,"i",65),e(),i(4,"p",66)(5,"span",67)(6,"span",68),a(7),e(),a(8),e(),i(9,"span",69),a(10),b(11,"titlecase"),b(12,"date"),e()(),i(13,"p",70)(14,"span",54),a(15,"Visit Start : "),e(),a(16),b(17,"date"),e(),i(18,"p",70)(19,"span",54),a(20,"Start Address : "),e(),a(21),e(),i(22,"p",70)(23,"span",54),a(24,"Visit Stop : "),e(),a(25),b(26,"date"),e(),i(27,"p",70)(28,"span",54),a(29,"Stop Address : "),e(),a(30),e(),i(31,"p",70)(32,"span",54),a(33,"Avarage Meeting Time : "),e(),i(34,"span",71),a(35),e()(),i(36,"p",70)(37,"span",54),a(38,"Remark : "),e(),i(39,"span",71),a(40),e()()(),c(41,ge,28,18,"div",22),e()),l&2){let t=o.$implicit;n(7),_("",t==null||t.customer_details==null?null:t.customer_details.customer_name," "),n(),_("",t==null||t.customer_details==null?null:t.customer_details.mobile," "),n(2),w("",k(11,11,t.type)," - ",t!=null&&t.visit_date?D(12,13,t==null?null:t.visit_date,"d MMM yyyy, hh:mm a"):"--",""),n(6),_("",t!=null&&t.visit_start_time?D(17,16,t==null?null:t.visit_start_time,"hh:mm a"):"--"," "),n(5),_("",(t==null?null:t.start_address)||"--"," "),n(4),_("",t!=null&&t.visit_stop_time?D(26,19,t==null?null:t.visit_stop_time,"hh:mm a"):"--"," "),n(5),_("",(t==null?null:t.stop_address)||"--"," "),n(5),p((t==null?null:t.avarage_meeting_time)||"--"),n(5),p((t==null?null:t.remark)||"--"),n(),r("ngIf",t.type==="call")}}function Ce(l,o){l&1&&(C(0),u(1,"app-data-not-found"),y())}function ye(l,o){if(l&1&&(C(0),i(1,"ul",62),c(2,be,42,22,"li",63),e(),c(3,Ce,2,0,"ng-container",22),y()),l&2){let t=m(3);n(2),r("ngForOf",t.visitDetails),n(),r("ngIf",!t.visitDetails.length)}}function he(l,o){l&1&&(i(0,"div"),u(1,"app-skeleton"),e()),l&2&&(n(),I("h50 mb-2"))}function De(l,o){l&1&&(C(0),c(1,he,2,2,"div",63),y()),l&2&&(n(),r("ngForOf",S(1,V).constructor(5)))}function Se(l,o){if(l&1&&(i(0,"div"),c(1,ye,4,2,"ng-container",22)(2,De,2,2,"ng-container",22),e()),l&2){let t=m(2);n(),r("ngIf",!t.skLoading),n(),r("ngIf",t.skLoading)}}function Ee(l,o){if(l&1&&(C(0),u(1,"div",78),i(2,"div",79)(3,"div",39)(4,"div")(5,"span",40),a(6,"latitude"),e(),i(7,"span",41),a(8),e()()(),i(9,"div",39)(10,"div")(11,"span",40),a(12,"longitude"),e(),i(13,"span",41),a(14),e()()(),i(15,"div",39)(16,"div")(17,"span",40),a(18,"GPS Address"),e(),i(19,"span",41),a(20),e()()()(),y()),l&2){let t=m(3);n(8),p((t.Detail==null?null:t.Detail.lat)||"--"),n(6),p((t.Detail==null?null:t.Detail.long)||"--"),n(6),p((t.Detail==null?null:t.Detail.gps_address)||"--")}}function Ie(l,o){if(l&1){let t=M();C(0),i(1,"div",80)(2,"div",81)(3,"span",82),a(4,"location_on"),e(),i(5,"p",83),a(6,"Point your location first"),e(),i(7,"p",84),a(8,"Once location is point, map will appear here."),e(),i(9,"div",85)(10,"app-button",86),h("buttonClick",function(){f(t);let d=m(3);return g(d.openModal("point_location",d.Detail))}),e()()()(),y()}l&2&&(n(10),r("buttonType","submit")("buttonClass","m-0 ti-btn ti-btn-outline-success")("label","Point Your Location")("iconClass","ri-map-pin-user-line"))}function Me(l,o){if(l&1){let t=M();i(0,"div")(1,"app-showcode-card",77),h("action",function(){f(t);let d=m(2);return g(d.openModal("point_location",d.Detail))}),c(2,Ee,21,3,"ng-container",22)(3,Ie,11,4,"ng-container",22),e()()}if(l&2){let t=m(2);n(),I("box-title font-medium text-[15px] block text-primarytint1color"),r("title","Point Location")("titleView",!0)("actionIcons",!0)("iconClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-primary waves-effect waves-light")("boxHeader","pt-0 pb-0")("classbody","pt-0")("iconName",!t.Detail.lat||!t.Detail.long?"ri-add-line":"ri-pencil-line"),n(),r("ngIf",t.Detail.lat&&t.Detail.long),n(),r("ngIf",!t.Detail.lat||!t.Detail.long)}}function Te(l,o){if(l&1&&(i(0,"div"),u(1,"app-comments",87),e()),l&2){let t=m(2);n(),r("detailId",t.DetailId)("module","complaint")("showAvatar",!0)}}function we(l,o){if(l&1&&(i(0,"div",90),u(1,"spk-product-card",91),e()),l&2){let t=o.$implicit;n(),r("apiPath","complaint/get-doc")("imageData",t)("editBtn",!1)("delBtn",!1)("heading",!1)("subHeading",!1)}}function ke(l,o){if(l&1&&(C(0),i(1,"div",88),c(2,we,2,6,"div",89),e(),y()),l&2){let t=m(3);n(2),r("ngForOf",t.complaintImages)}}function Fe(l,o){l&1&&(C(0),u(1,"app-data-not-found"),y())}function Ve(l,o){if(l&1&&(i(0,"div"),c(1,ke,3,1,"ng-container",22)(2,Fe,2,0,"ng-container",22),e()),l&2){let t=m(2);n(),r("ngIf",t.complaintImages.length!==0),n(),r("ngIf",t.complaintImages.length===0)}}function Le(l,o){if(l&1&&(i(0,"tr",95)(1,"td",96),a(2),e(),i(3,"td"),a(4),b(5,"titlecase"),e(),i(6,"td",97),a(7),e(),i(8,"td",97),a(9),e()()),l&2){let t=o.$implicit,s=o.index,d=m(4);n(2),p(s+1),n(2),w("",t.product_name?k(5,7,t.product_name):"--"," -- (",t.product_code?t.product_code:"--",")"),n(3),w("",d.CURRENCY_SYMBOLS.RUPEE,"",t.qty?t.qty:"--",""),n(2),w("",d.CURRENCY_SYMBOLS.RUPEE,"",t.sub_total?t.sub_total:"0","")}}function Ae(l,o){if(l&1&&(C(0),c(1,Le,10,9,"tr",94),y()),l&2){let t=m(3);n(),r("ngForOf",t.invoiceDetails.items)}}function Re(l,o){l&1&&(i(0,"td"),u(1,"app-skeleton"),e()),l&2&&(n(),I("h20 bg-skeleton"))}function Be(l,o){l&1&&(i(0,"tr",99),c(1,Re,2,2,"td",63),e()),l&2&&(n(),r("ngForOf",S(1,V).constructor(5)))}function Oe(l,o){l&1&&(C(0),c(1,Be,2,2,"tr",98),y()),l&2&&(n(),r("ngForOf",S(1,V).constructor(4)))}function Pe(l,o){l&1&&(C(0),u(1,"app-data-not-found"),y())}function Ne(l,o){if(l&1&&(i(0,"div")(1,"div",92)(2,"spk-reusable-tables",93),c(3,Ae,2,1,"ng-container",22)(4,Oe,2,2,"ng-container",22),e(),c(5,Pe,2,0,"ng-container",22),e()()),l&2){let t=m(2);n(2),r("tableHead","border-b")("showS_No",!0)("columns",t.headers_one),n(),r("ngIf",!t.skLoading),n(),r("ngIf",t.skLoading),n(),r("ngIf",!t.invoiceDetails.items.length&&!t.skLoading)}}function je(l,o){if(l&1){let t=M();i(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13),a(5,"Activity"),e()(),i(6,"div",14)(7,"div",15),u(8,"spk-apexcharts",16),e()()(),i(9,"div",11)(10,"div",17)(11,"div",18)(12,"div",13),a(13,"Activity Information"),e()()(),i(14,"div",19)(15,"div",20)(16,"spk-reusable-tables",21),c(17,ve,34,11,"ng-container",22)(18,_e,35,15,"ng-container",22),e()()()(),u(19,"app-logs",23),e(),i(20,"div",24)(21,"div",25)(22,"div",17)(23,"div",26),a(24," Customer Detail "),e()(),i(25,"div",14)(26,"ul",27)(27,"li")(28,"div",28)(29,"div",29)(30,"div")(31,"span",30),a(32),e(),i(33,"span",31),a(34,"Customer Name"),e()()(),i(35,"div",29)(36,"div")(37,"span",30),a(38),e(),i(39,"span",31),a(40,"Customer Mobile"),e()()(),i(41,"div",29)(42,"div")(43,"span",30),a(44),e(),i(45,"span",31),a(46,"Customer Alternate Mobile"),e()()(),i(47,"div",29)(48,"div")(49,"span",30),a(50),e(),i(51,"span",31),a(52,"Address"),e()()()()()()()(),i(53,"app-showcode-card",32)(54,"div",33)(55,"div",34),a(56,"Basic Detail"),e(),i(57,"div",35),u(58,"app-icon-button",36),i(59,"app-icon-button",37),h("click",function(){f(t);let d=m();return g(d.addInvoice(d.Detail))}),e(),u(60,"app-icon-button",36),e()(),i(61,"div",38)(62,"div",39)(63,"div")(64,"span",40),a(65,"Created At"),e(),i(66,"span",41),a(67),b(68,"date"),e()()(),i(69,"div",39)(70,"div")(71,"span",40),a(72,"Created By"),e(),i(73,"span",41),a(74),e()()(),i(75,"div",39)(76,"div")(77,"span",40),a(78,"Complaint ID"),e(),i(79,"span",41),a(80),e()()(),i(81,"div",39)(82,"div")(83,"span",40),a(84,"Nature Of Problem"),e(),i(85,"span",41),a(86),e()()(),i(87,"div",39)(88,"div")(89,"span",40),a(90,"Product Name"),e(),i(91,"span",41),a(92),e()()(),i(93,"div",39)(94,"div")(95,"span",40),a(96,"Date Of Purchase"),e(),i(97,"span",41),a(98),e()()(),i(99,"div",39)(100,"div")(101,"span",40),a(102,"Technician Name"),e(),i(103,"span",41),a(104),e()()(),i(105,"div",39)(106,"div")(107,"span",40),a(108,"Technician Mobile"),e(),i(109,"span",41),a(110),e()()(),i(111,"div",39)(112,"div")(113,"span",40),a(114,"Complaint Status"),e(),i(115,"span",42),a(116),i(117,"a",43),h("click",function(){f(t);let d=m();return g(d.updateStatus())}),i(118,"i",44),a(119,"edit"),e()()()()(),c(120,xe,6,1,"div",45),i(121,"div",39)(122,"div")(123,"span",40),a(124,"Inspection Status"),e(),i(125,"span",41),a(126),e()()(),i(127,"div",39)(128,"div")(129,"span",40),a(130,"Closure Status"),e(),i(131,"span",41),a(132),e()()(),i(133,"div",39)(134,"div")(135,"span",40),a(136,"Closure Status"),e(),i(137,"span",41),a(138),e()()(),i(139,"div",39)(140,"div")(141,"span",40),a(142,"Closure Status"),e(),i(143,"span",41),a(144),e()()(),i(145,"div",39)(146,"div")(147,"span",40),a(148,"Closure Status"),e(),i(149,"span",41),a(150),e()()()(),u(151,"div",46),i(152,"div",47),c(153,fe,6,2,"div",48),b(154,"keyvalue"),e()(),i(155,"app-showcode-card",32)(156,"div",33)(157,"div",34),a(158,"Inspection Detail"),e()(),i(159,"div",38)(160,"div",39)(161,"div")(162,"span",40),a(163,"Created At"),e(),i(164,"span",41),a(165),b(166,"date"),e()()(),i(167,"div",39)(168,"div")(169,"span",40),a(170,"Created By"),e(),i(171,"span",41),a(172),e()()(),i(173,"div",39)(174,"div")(175,"span",40),a(176,"Product Verification"),e(),i(177,"span",41),a(178),e()()(),i(179,"div",39)(180,"div")(181,"span",40),a(182,"Purchase Bill"),e(),i(183,"span",41),a(184),e()()(),i(185,"div",39)(186,"div")(187,"span",40),a(188,"Purchase Location"),e(),i(189,"span",41),a(190),e()()(),i(191,"div",39)(192,"div")(193,"span",40),a(194,"Resolution Type"),e(),i(195,"span",41),a(196),e()()(),i(197,"div",39)(198,"div")(199,"span",40),a(200,"Warranty Verification"),e(),i(201,"span",41),a(202),e()()(),i(203,"div",39)(204,"div")(205,"span",40),a(206,"Warranty Slip"),e(),i(207,"span",41),a(208),e()()(),i(209,"div",39)(210,"div")(211,"span",40),a(212,"Inspection Remarks"),e(),i(213,"span",41),a(214),e()()()(),u(215,"div",46),e(),i(216,"div",25)(217,"div",12)(218,"nav",49)(219,"button",50),h("click",function(){f(t);let d=m();return g(d.activeTab="Visit Activity")}),a(220," Visit Activity "),e(),i(221,"button",50),h("click",function(){f(t);let d=m();return d.activeTab="point_location",g(d.loadMap())}),a(222," Point Location "),e(),i(223,"button",51),h("click",function(){f(t);let d=m();return g(d.activeTab="Comments")}),a(224," Comments "),e(),i(225,"button",51),h("click",function(){f(t);let d=m();return g(d.activeTab="Attachment")}),a(226," Attachment "),e(),i(227,"button",51),h("click",function(){f(t);let d=m();return g(d.activeTab="Invoice")}),a(228," Invoice "),e()()(),i(229,"div",52),c(230,Se,3,2,"div",22)(231,Me,4,11,"div",22)(232,Te,2,3,"div",22)(233,Ve,3,2,"div",22)(234,Ne,6,6,"div",22),e()()()()}if(l&2){let t=m();n(8),r("chartOptions",t.chartOptions1),n(8),r("showCheckbox",!1),n(),r("ngIf",t.assignType==="upcomming"),n(),r("ngIf",t.assignType==="last"),n(),r("logList",t.logList)("scrollHeight","400")("closeBtn",!1),n(13),p((t.Detail==null?null:t.Detail.customer_name)||"--"),n(6),p((t.Detail==null?null:t.Detail.customer_mobile)||"--"),n(6),p((t.Detail==null?null:t.Detail.alternate_mobile_no)||"--"),n(6),Z("",(t.Detail==null?null:t.Detail.address)||"--",", ",(t.Detail==null?null:t.Detail.city)||"--",", ",(t.Detail==null?null:t.Detail.district)||"--",", ",(t.Detail==null?null:t.Detail.state)||"--",", ",(t.Detail==null?null:t.Detail.pincode)||"--"," "),n(3),r("titleView",!1)("view",!1),n(5),r("icon","ri-mail-line")("buttonClass","ti-btn ti-btn-icon bg-primary/10 text-primary !border hover:bg-primary hover:text-white !rounded-full btn-wave"),n(),r("icon","ri-add-line")("buttonClass","ti-btn ti-btn-icon bg-secondary/10 text-secondary hover:bg-secondary hover:text-white !rounded-full btn-wave"),n(),r("icon","ri-whatsapp-line")("buttonClass","ti-btn ti-btn-icon bg-secondary/10 text-secondary hover:bg-secondary hover:text-white !rounded-full btn-wave"),n(7),p(t.Detail!=null&&t.Detail.created_at?D(68,60,t.Detail==null?null:t.Detail.created_at,"d MMM yyyy, hh:mm a"):"--"),n(7),p((t.Detail==null?null:t.Detail.created_name)||"--"),n(6),p((t.Detail==null?null:t.Detail.complaint_no)||"--"),n(6),p((t.Detail==null?null:t.Detail.nature_of_problem)||"--"),n(6),p((t.Detail==null?null:t.Detail.product_description)||"--"),n(6),p((t.Detail==null?null:t.Detail.date_of_purchase)||"--"),n(6),p((t.Detail==null?null:t.Detail.customer_name)||"--"),n(6),p((t.Detail==null?null:t.Detail.customer_mobile)||"--"),n(6),_("",(t.Detail==null?null:t.Detail.status)||"--"," "),n(4),r("ngIf",t.Detail.reason),n(6),p((t.Detail==null?null:t.Detail.inspection_status)||"--"),n(6),p((t.Detail==null?null:t.Detail.inspection_status)||"--"),n(6),p((t.Detail==null?null:t.Detail.inspection_status)||"--"),n(6),p((t.Detail==null?null:t.Detail.inspection_status)||"--"),n(6),p((t.Detail==null?null:t.Detail.inspection_status)||"--"),n(3),r("ngForOf",k(154,63,t.formattedKeysFormData)),n(2),r("titleView",!1)("view",!1),n(10),p(t.inspectionDetails!=null&&t.inspectionDetails.created_at?D(166,65,t.inspectionDetails==null?null:t.inspectionDetails.created_at,"d MMM yyyy, hh:mm a"):"--"),n(7),p((t.inspectionDetails==null?null:t.inspectionDetails.created_name)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.product_verification)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.purchase_bill)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.purchase_location)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.resolution_type)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.warranty_verification)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.warranty_slip)||"--"),n(6),p((t.inspectionDetails==null?null:t.inspectionDetails.inspection_remarks)||"--"),n(5),r("ngClass",F(68,A,t.activeTab==="Visit Activity")),n(2),r("ngClass",F(70,A,t.activeTab==="point_location")),n(2),r("ngClass",F(72,A,t.activeTab==="Comments")),n(2),r("ngClass",F(74,A,t.activeTab==="Attachment")),n(2),r("ngClass",F(76,A,t.activeTab==="Invoice")),n(3),r("ngIf",t.activeTab==="Visit Activity"),n(),r("ngIf",t.activeTab==="point_location"),n(),r("ngIf",t.activeTab==="Comments"),n(),r("ngIf",t.activeTab==="Attachment"),n(),r("ngIf",t.activeTab==="Invoice")}}function We(l,o){l&1&&(i(0,"div",39),u(1,"app-skeleton"),e()),l&2&&(n(),I("w180"))}function He(l,o){l&1&&u(0,"app-skeleton"),l&2&&I("wp100 h35 mb-3")}function Ye(l,o){l&1&&u(0,"app-skeleton"),l&2&&I("wp100 h35 mb-3")}function qe(l,o){l&1&&(i(0,"div",88)(1,"div",2)(2,"div",88)(3,"div",2)(4,"app-showcode-card",32)(5,"div")(6,"div",100),c(7,We,2,2,"div",101),e()()()(),i(8,"div",102)(9,"app-showcode-card",32),c(10,He,1,2,"app-skeleton",103),e()(),i(11,"div",104)(12,"app-showcode-card",32),c(13,Ye,1,2,"app-skeleton",103),e()()()()()),l&2&&(n(4),r("titleView",!1)("view",!1),n(3),r("ngForOf",S(9,V).constructor(10)),n(2),r("titleView",!1)("view",!1),n(),r("ngForOf",S(10,V).constructor(7)),n(2),r("titleView",!1)("view",!1),n(),r("ngForOf",S(11,V).constructor(7)))}var Gt=class l{constructor(o,t,s,d,v,Ut,$t,Kt,ze){this.router=o;this.route=t;this.api=s;this.logService=d;this.moduleService=v;this.dateService=Ut;this.alert=$t;this.dialog=Kt;this.toastr=ze}CURRENCY_SYMBOLS=lt;DetailId;Detail;formattedKeysFormData={};DetailFormData;complaintMainStages=[];visitDetails=[];invoiceDetails=[];complaintImages=[];inspectionDetails={};logList=[];skLoading=!1;skLoading1=!1;subModule={};originalData={};assignType="upcomming";activeTab="Visit Activity";taskActivity=[];accessRight={};zoom=3;map;myMap;latitude=0;longitude=0;statusOptions=[{name:"Close"},{name:"Cancel"}];chartOptions1={chart:{height:286,type:"radialBar",responsive:"true",offsetX:0,offsetY:15},plotOptions:{radialBar:{startAngle:-135,endAngle:135,size:120,imageWidth:50,imageHeight:50,track:{strokeWidth:"97%"},dropShadow:{enabled:!1,top:0,left:0,bottom:0,blur:3,opacity:.5},dataLabels:{name:{fontSize:"16px",color:void 0,offsetY:30},hollow:{size:"60%"},value:{offsetY:-10,fontSize:"22px",color:void 0,formatter:function(o){return o+"%"}}}}},colors:["rgba(var(--primary-rgb))"],fill:{type:"solid",gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:["#5c67f7"],inverseColors:!1,opacityFrom:1,opacityTo:1,stops:[0,100]}},stroke:{dashArray:3},series:[0],labels:["Complete"]};headers_one=[{label:"Product Description",table_class:""},{label:"Total Qty",table_class:"text-right"},{label:"Amount",table_class:"text-right"}];ngOnInit(){let o=this.moduleService.getAccessMap("WCMS","Complaint");o&&(this.accessRight=o);let t=this.moduleService.getSubModuleByName("WCMS","Complaint");t&&(this.subModule=t),this.route.paramMap.subscribe(s=>{this.DetailId=s.get("id"),this.DetailId&&this.getComplaintDetail()})}getComplaintDetail(){this.skLoading=!0,this.api.post({_id:this.DetailId},"complaint/detail").subscribe(o=>{o.statusCode===200&&(this.skLoading=!1,this.Detail=o.data,this.visitDetails=this.Detail.visit_details||[],this.invoiceDetails=this.Detail.invoice_details||{},this.inspectionDetails=this.Detail.inspection_details||{},this.complaintImages=this.Detail.complaint_images||{},this.logService.getLogs(this.subModule.module_id,t=>{this.logList=t},this.DetailId?this.DetailId:"",this.subModule.module_type),this.getLogs())})}loadMap(){let o="map";this.latitude=parseFloat(this.Detail?.lat),this.longitude=parseFloat(this.Detail?.long);let t=document.getElementById(o);t&&t._leaflet_id!=null&&(t._leaflet_id=null),setTimeout(()=>{this.myMap=E.map(o).setView([this.latitude,this.longitude],16),E.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:22,attribution:"&copy; OpenStreetMap contributors"}).addTo(this.myMap);let s=E.icon({iconUrl:"assets/images/highlight-marker.png",iconSize:[30,33],iconAnchor:[15,33],popupAnchor:[0,-30]});E.marker([this.latitude,this.longitude],{icon:s}).addTo(this.myMap).bindPopup(`<strong>Address:</strong><br>${this.Detail?.gps_address||"Not available"}`).openPopup()},100)}getKey(o){return Object.keys(o)[0]}getLogs(){this.logService.getLogs(this.subModule.module_id,o=>{this.logList=o},this.DetailId?this.DetailId:"",this.subModule.module_type)}formatAndPrintFormData(o){let t={};for(let s in o)if(o.hasOwnProperty(s)){let d=s.split("_").map(v=>v.charAt(0).toUpperCase()+v.slice(1)).join(" ");t[d]=o[s]}return t}editPage(o){this.router.navigate(["/apps/sfa/complaint/complaint-detail/"+this.DetailId+"/edit"])}addInvoice(o){this.dialog.open(zt,{width:"850px",data:{lastPage:"complaint-detail",complaint_id:this.Detail._id,service_engineer_id:this.Detail.service_engineer_id,customer_mobile:this.Detail.customer_mobile,customer_name:this.Detail.customer_name,address:this.Detail.address}}).afterClosed().subscribe(s=>{s===!0&&this.getComplaintDetail()})}openModal(o,t){let s={};s={lat:t.lat,long:t.long,_id:t._id,complaint_id:t._id},this.dialog.open(L,{width:"350px",panelClass:"mat-right-modal",position:{right:"0px"},data:{pageType:o,data:s,DetailId:this.DetailId,submodule:this.subModule}}).afterClosed().subscribe(v=>{v===!0&&(this.getComplaintDetail(),this.loadMap())})}getTatDaysReadable(o){if(!o)return"--";let t=o.match(/(\d+)h\s*(\d+)min\s*(\d+)sec/);if(!t)return o;let s=parseInt(t[1],10);if(s>=24){let d=Math.floor(s/24);return`${d} day${d>1?"s":""}`}else return`${s}h`}updateStatus(){this.dialog.open(L,{width:"450px",data:{lastPage:"complaint",DetailId:this.DetailId,subModule:this.subModule,options:this.statusOptions,apiPath:"complaint/status-update"}}).afterClosed().subscribe(t=>{t===!0&&this.getComplaintDetail()})}static \u0275fac=function(t){return new(t||l)(x(at),x(nt),x(W),x(z),x(bt),x(Vt),x(ft),x(It),x(N))};static \u0275cmp=R({type:l,selectors:[["app-complaint-detail"]],decls:9,vars:9,consts:[[3,"buttonClick1","title","title1","activeitem","buttonText1","icon1","btnShow1"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xl:col-span-12","col-span-12"],[1,"box","profile-card"],[1,"profile-banner-img"],["src","./assets/images/media/media-3.jpg","alt","...",1,"card-img-top"],[1,"box-body","pb-0","relative","profile-content"],["class","grid grid-cols-12 sm:gap-x-6 profile-content",4,"ngIf"],["class","grid grid-cols-12 sm:gap-x-6",4,"ngIf"],[1,"grid","grid-cols-12","sm:gap-x-6","profile-content"],[1,"xl:col-span-3","col-span-12"],[1,"box","overflow-hidden"],[1,"box-header","justify-between"],[1,"box-title"],[1,"box-body","pt-0"],["id","total-orders",1,"mt-45px","mb-3"],[3,"chartOptions"],[1,"box-header"],[1,"flex","items-center","justify-between","wp100"],[1,"box-body","p-0"],[1,"table-responsive"],["tableClass","table text-nowrap",3,"showCheckbox"],[4,"ngIf"],[3,"logList","scrollHeight","closeBtn"],[1,"xxl:col-span-9","xl:col-span-8","lg:col-span-8","md:col-span-7","col-span-12"],[1,"box"],[1,"box-title","text-primarytint1color","wp100","flex","justify-between"],[1,"ti-list-group","list-group-flush","border-0"],[1,"flex","items-center","gap-5","flex-wrap","text-[12px]"],[1,"flex","items-center","flex-wrap"],[1,"block","font-medium","text-primay"],[1,"text-textmuted","dark:text-textmuted/50"],[3,"titleView","view"],[1,"flex","justify-between","mb-3"],[1,"box-title","flex","items-center","text-primarytint1color"],[1,"md:mb-0","mb-2"],[3,"icon","buttonClass"],["matTooltip","Add New Invoice",3,"click","icon","buttonClass"],[1,"flex","gap-6","mb-1","flex-wrap","text-[11px]"],[1,"flex","items-center"],[1,"text-xs","text-textmuted","dark:text-textmuted/50"],[1,"block","font-medium"],[1,"flex","items-center","block","font-medium","badge","bg-info/10","text-info"],[1,"text-info","font-medium",3,"click"],[1,"material-icons","ms-1"],["class","flex items-center",4,"ngIf"],[1,"dropdown-divider","mb-3","mt-3"],[1,"flex","gap-5","mb-1","flex-wrap","text-[11px]"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],["aria-label","Tabs","role","tablist","aria-orientation","horizontal",1,"nav","nav-tabs","tab-style-8","scaleX","profile-settings-tab","gap-2","flex","mt-2"],["type","button",1,"nav-link","ti-btn-soft-primary","px-4","rounded-md","active",3,"click","ngClass"],["type","button",1,"nav-link","ti-btn-soft-primary","px-4","rounded-md",3,"click","ngClass"],[1,"box-body","tab-content"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10","text-[11px]"],[1,"font-medium","text-[11px]"],[1,"text-[11px]"],[1,"badge","bg-info/10","text-info","text-[11px]"],[1,"text-primary","font-medium","me-1","text-[11px]"],[1,"badge","bg-primary/10","text-primary","text-[12px]"],[1,"vertical-align-top"],[1,"text-[11px]","ellipsis","w180",3,"matTooltip"],[1,"flex","items-center","gap-2"],[1,"list-none","profile-timeline","mb-3"],[4,"ngFor","ngForOf"],[1,"avatar","avatar-sm","avatar-rounded","profile-timeline-avatar","bg-primarytint3color"],[1,"ri-walk-fill","text-[14px]"],[1,"text-textmuted","dark:text-textmuted/50","mb-2"],[1,"text-defaulttextcolor","dark:text-defaulttextcolor/80"],[1,"font-medium"],[1,"float-end","text-[11px]","badge","bg-primarytint3color/10","text-primarytint3color"],[1,"text-textmuted","dark:text-textmuted/50","mb-1","text-[12px]"],[1,"font-medium","text-success"],[1,"avatar","avatar-sm","avatar-rounded","profile-timeline-avatar","bg-info"],[1,"ri-phone-fill","text-[14px]"],[1,"float-end","text-[11px]","badge","bg-info/10","text-info"],["id","player2","controls",""],["src","./assets/audio/perfect-beauty.mp3","type","audio/mp3"],[3,"action","title","titleView","actionIcons","iconClass","boxHeader","classbody","iconName"],["id","map",2,"width","100%","height","300px"],[1,"flex","gap-6","mt-2","flex-wrap","text-[12px]"],[1,"max-w-sm","p-6","mx-auto","text-center"],[1,"flex","flex-col","items-center","space-y-3"],[1,"material-icons","text-6xl","text-danger"],[1,"text-lg","font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"border-t","border-block-start-dashed","sm:flex","justify-end"],[3,"buttonClick","buttonType","buttonClass","label","iconClass"],[3,"detailId","module","showAvatar"],[1,"grid","grid-cols-12","sm:gap-x-6"],["class","xxl:col-span-4 lg:col-span-3 xl:col-span-4 sm:col-span-6 col-span-12",4,"ngFor","ngForOf"],[1,"xxl:col-span-4","lg:col-span-3","xl:col-span-4","sm:col-span-6","col-span-12"],[3,"apiPath","imageData","editBtn","delBtn","heading","subHeading"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"tableHead","showS_No","columns"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"text-right"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"flex","gap-2","mb-1","flex-wrap"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"xl:col-span-4","col-span-12"],[3,"class",4,"ngFor","ngForOf"],[1,"xl:col-span-8","col-span-12"]],template:function(t,s){t&1&&(i(0,"app-page-header",0),h("buttonClick1",function(v){return s.editPage(v)}),e(),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),u(5,"img",5),e(),i(6,"div",6),c(7,je,235,78,"div",7)(8,qe,14,12,"div",8),e()()()()),t&2&&(r("title","WCMS")("title1",S(8,ue))("activeitem","Complaint Detail")("buttonText1","Edit Complaint")("icon1","edit")("btnShow1",!0),n(7),r("ngIf",!s.skLoading),n(),r("ngIf",s.skLoading))},dependencies:[q,J,B,O,Yt,gt,Rt,Y,qt,Bt,Nt,Ft,tt,et,it,Lt,Ct,P,j,jt,Ht,H],encapsulation:2})};export{Gt as ComplaintDetailComponent};
