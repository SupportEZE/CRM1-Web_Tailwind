import{a as ue}from"./chunk-J4NDCUAB.js";import{b as pe,c as me}from"./chunk-CIBZCVJQ.js";import{a as re}from"./chunk-OEHD5D2Y.js";import{a as _e}from"./chunk-GLWQGYBC.js";import{a as U}from"./chunk-DC4QM32I.js";import{F as ce,c as J,q as oe,s as le,u as se}from"./chunk-VHE3PQ3O.js";import{Aa as Z,B as Q,Ea as $,G as z,Ga as ee,Ha as te,Ia as ie,Ja as ne,Z as G,hb as ae,va as X,wa as Y,z as q}from"./chunk-GYDYF5F3.js";import{K as j,M as O,Q as K,e as R,f as H,g as A,n as N,o as W}from"./chunk-PD5VTTIY.js";import{Aa as _,Ba as u,Hb as E,Lc as D,Mc as p,Nc as h,Ob as g,Oc as F,Uc as v,Vc as y,Wc as x,Yc as T,_b as c,ac as V,bc as k,ed as w,fc as L,fd as B,gd as M,kc as o,lc as r,mc as C,nc as S,oc as P,qc as b,rb as a,sb as f,wc as d,yc as m,za as I}from"./chunk-2NSPOFEK.js";var he=()=>["Purchase"],ge=()=>[];function fe(l,n){l&1&&C(0,"app-page-header",12),l&2&&c("title","IRP")("title1",T(4,he))("activeitem","Purchase list")("btnShow1",!1)}function be(l,n){if(l&1){let e=b();o(0,"button",22),d("click",function(){_(e);let i=m(2);return i.filter.created_name="",u(i.getList())}),o(1,"mat-icon"),p(2,"close"),r()()}}function Ce(l,n){if(l&1){let e=b();o(0,"button",22),d("click",function(){_(e);let i=m(2);return i.filter.sender_customer_type_name="",u(i.getList())}),o(1,"mat-icon"),p(2,"close"),r()()}}function ve(l,n){if(l&1){let e=b();o(0,"button",22),d("click",function(){_(e);let i=m(2);return i.filter.receiver_customer_name="",u(i.getList())}),o(1,"mat-icon"),p(2,"close"),r()()}}function ye(l,n){if(l&1){let e=b();o(0,"tr",23)(1,"td"),p(2),r(),o(3,"td"),p(4),w(5,"date"),r(),o(6,"td",24),p(7),w(8,"titlecase"),r(),o(9,"td"),p(10),w(11,"date"),r(),o(12,"td")(13,"a",25),d("click",function(){let i=_(e).$implicit,s=m(2);return u(s.goToDetail(i._id))}),p(14),r()(),o(15,"td"),p(16),r(),o(17,"td"),p(18),r(),o(19,"td",26),p(20),r(),o(21,"td",26),p(22),r()()}if(l&2){let e=n.$implicit,t=n.index,i=m(2);V("bg-gray-400",i.isHighlighted(e._id)),a(2),h((i.pagination.cur_page-1)*i.pagination.limit+t+1),a(2),h(e.created_at?M(5,11,e.created_at,"dd MMM yyyy hh:mm a"):""),a(3),h(e.created_name?B(8,14,e.created_name):"---"),a(3),h(e.bill_date?M(11,16,e.bill_date,"dd MMM yyyy"):""),a(4),F(" ",e.bill_number?e.bill_number:""," "),a(2),h(e.customer_type_name?e.customer_type_name:"---"),a(2),h(e.customer_name?e.customer_name:"---"),a(2),h(e.total_item?e.total_item:"---"),a(2),h(e.total_qty?e.total_qty:"---")}}function xe(l,n){if(l&1){let e=b();S(0),o(1,"tr",13)(2,"td",14),p(3,"\xA0"),r(),o(4,"td")(5,"div",15)(6,"mat-form-field",16)(7,"input",17),x("ngModelChange",function(i){_(e);let s=m();return y(s.filter.created_at,i)||(s.filter.created_at=i),u(i)}),d("ngModelChange",function(){_(e);let i=m();return u(i.getList())}),r(),C(8,"mat-datepicker-toggle",18)(9,"mat-datepicker",null,0),r()()(),o(11,"td",14)(12,"div",15)(13,"mat-form-field",16)(14,"input",19),x("ngModelChange",function(i){_(e);let s=m();return y(s.filter.created_name,i)||(s.filter.created_name=i),u(i)}),d("keyup.enter",function(){_(e);let i=m();return u(i.getList())}),r(),g(15,be,3,0,"button",20),r()()(),o(16,"td",14)(17,"div",15)(18,"mat-form-field",16)(19,"input",19),x("ngModelChange",function(i){_(e);let s=m();return y(s.filter.sender_customer_type_name,i)||(s.filter.sender_customer_type_name=i),u(i)}),d("keyup.enter",function(){_(e);let i=m();return u(i.getList())}),r(),g(20,Ce,3,0,"button",20),r()()(),o(21,"td",14)(22,"div",15)(23,"mat-form-field",16)(24,"input",19),x("ngModelChange",function(i){_(e);let s=m();return y(s.filter.receiver_customer_name,i)||(s.filter.receiver_customer_name=i),u(i)}),d("keyup.enter",function(){_(e);let i=m();return u(i.getList())}),r(),g(25,ve,3,0,"button",20),r()()(),o(26,"td"),p(27,"\xA0"),r(),o(28,"td"),p(29,"\xA0"),r()(),g(30,ye,23,19,"tr",21),P()}if(l&2){let e=D(10),t=m();a(7),c("matDatepicker",e),v("ngModel",t.filter.created_at),a(),c("for",e),a(6),v("ngModel",t.filter.created_name),a(),L(t.filter.created_name?15:-1),a(4),v("ngModel",t.filter.sender_customer_type_name),a(),L(t.filter.sender_customer_type_name?20:-1),a(4),v("ngModel",t.filter.receiver_customer_name),a(),L(t.filter.receiver_customer_name?25:-1),a(5),c("ngForOf",t.listing)}}function Le(l,n){l&1&&(o(0,"td"),C(1,"app-skeleton"),r()),l&2&&(a(),k("h20 bg-skeleton"))}function Se(l,n){l&1&&(o(0,"tr",13),g(1,Le,2,2,"td",28),r()),l&2&&(a(),c("ngForOf",T(1,ge).constructor(9)))}function Pe(l,n){l&1&&(S(0),g(1,Se,2,2,"tr",27),P()),l&2&&(a(),c("ngForOf",T(1,ge).constructor(5)))}function Te(l,n){l&1&&(S(0),C(1,"app-data-not-found"),P())}var de=class l{constructor(n,e,t,i,s,we){this.comanFuncation=n;this.highlightService=e;this.router=t;this.api=i;this.route=s;this.moduleService=we}pageHeader=!0;btnLabel;customerDetail;_id;tabCount={};activeTab="Pending";skLoading=!1;highlightedId;pageKey="purchase-list";pagination={};filter={};listing=[];accessRight={};mainTabs=[];ngOnChanges(){console.log(this.customerDetail,"customerDetail"),this.getList()}ngOnInit(){this.mainTabs=this.getColumns();let n=this.moduleService.getAccessMap("Purchase");n&&(this.accessRight=n);let e=this.highlightService.getHighlight(this.pageKey);e!=null&&(this.activeTab=e.tab,this.highlightedId=e.rowId,this.pagination.cur_page=e.pageIndex,this.filter=e.filters,this.highlightService.clearHighlight(this.pageKey)),this.pageHeader&&this.getList()}onRefresh(){this.getList()}getList(){this.skLoading=!0,this.api.post({page:this.pagination.cur_page??1,activeTab:this.activeTab,_id:this._id,filters:this.filter},"purchase/read").subscribe(n=>{n.statusCode===200?(this.listing=n?.data?.result,this.tabCount=n?.data?.tabCounts,this.pagination=n.pagination,this.skLoading=!1,this.mainTabs=this.getColumns()):this.skLoading=!1})}getColumns(){return[{name:"Pending",label:"Pending",icon:"ri-time-fill",count:this.tabCount.pending_count?this.tabCount.pending_count:0},{name:"Approved",label:"Approved",icon:"ri-check-fill",count:this.tabCount.approved_count?this.tabCount.approved_count:0},{name:"Reject",label:"Reject",icon:"ri-close-fill",count:this.tabCount.reject_count?this.tabCount.reject_count:0}]}changeToPagination(n){n=="Previous"?this.pagination.prev&&this.pagination.cur_page>1&&(this.pagination.cur_page--,this.getList()):this.pagination.next&&(this.pagination.cur_page++,this.getList())}changeToPage(n){this.pagination.cur_page=n,this.getList()}isHighlighted(n){return this.highlightedId===n}setHighLight(n){this.comanFuncation.setHighLight(this.pageKey,n,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}goToDetail(n){this.setHighLight(n),this.router.navigate(["/apps/loyalty/purchase/purchase-detail/"+n])}goToPage(){let n;this.customerDetail&&(this.customerDetail.pageFrom="Detail Page",n=this.customerDetail),this.router.navigate(["/apps/loyalty/purchase/purchase-add"],{state:{detail:n}})}onTabChange(n){this.activeTab=n,this.getList()}invoiceColumn=[{label:"Date Created"},{label:"Created By"},{label:"Bill Date"},{label:"Bill No."},{label:"Category"},{label:"Influencer Detail"},{label:"Total Item",table_class:"text-center"},{label:"Total Qty",table_class:"text-center"}];static \u0275fac=function(e){return new(e||l)(f(me),f(pe),f(O),f(G),f(j),f(U))};static \u0275cmp=E({type:l,selectors:[["app-purchase-list"]],inputs:{pageHeader:"pageHeader",btnLabel:"btnLabel",customerDetail:"customerDetail",_id:"_id"},features:[I],decls:13,vars:25,consts:[["picker",""],[3,"title","title1","activeitem","btnShow1",4,"ngIf"],[1,"row"],[1,"col-xl-12"],[1,"py-4",3,"ngClass"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[3,"tabChange","tabs","activeTab","countShow"],[3,"onRefresh","button1","pageTitle","listLength","btnShow","refreshLabel","btnShow2","addBtnLabel"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"tableHead","showS_No","columns"],[4,"ngIf"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"title","title1","activeitem","btnShow1"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","created_at","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],["class","invoice-list border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"invoice-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"w150"],[1,"font-medium","text-primary","underline",3,"click"],[1,"text-center"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&(g(0,fe,1,5,"app-page-header",1),o(1,"div",2)(2,"div",3)(3,"div",4)(4,"nav",5)(5,"app-listing-tab",6),d("tabChange",function(s){return t.onTabChange(s.tab)}),r()(),o(6,"app-page-sub-header",7),d("onRefresh",function(){return t.onRefresh()})("button1",function(){return t.goToPage()}),r(),o(7,"div",8)(8,"spk-reusable-tables",9),g(9,xe,31,10,"ng-container",10)(10,Pe,2,2,"ng-container",10),r(),g(11,Te,2,0,"ng-container",10),o(12,"app-pagination-footer",11),d("preButtonClick",function(){return t.changeToPagination("Previous")})("nextButtonClick",function(){return t.changeToPagination("Next")})("pageChange",function(s){return t.changeToPage(s)}),r()()()()()),e&2&&(c("ngIf",t.pageHeader),a(3),c("ngClass",t.pageHeader?"box px-4":""),a(2),c("tabs",t.mainTabs)("activeTab",t.activeTab)("countShow",!0),a(),k("p-0 pt-3"),c("pageTitle","Purchase List")("listLength",t.listing.length)("btnShow",!0)("refreshLabel","Refresh")("btnShow2",t.accessRight==null?null:t.accessRight.addRight)("addBtnLabel","Add Purchase"),a(2),c("tableHead","border-b")("showS_No",!0)("columns",t.invoiceColumn),a(),c("ngIf",!t.skLoading),a(),c("ngIf",t.skLoading),a(),c("ngIf",t.listing.length===0&&!t.skLoading),a(),c("currentPage",t.pagination.cur_page)("totalPage",t.pagination.total_pages)("pageLimit",t.pagination.limit)("listLength",t.listing.length)("preBtn",!t.pagination.prev)("nextBtn",!t.pagination.next))},dependencies:[ce,R,H,A,q,Q,z,_e,J,le,oe,ue,se,N,W,K,re,ae,Z,te,ie,ne,$,ee,Y,X],encapsulation:2})};export{de as a};
