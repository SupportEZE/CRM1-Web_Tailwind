import{a as Lt}from"./chunk-J4NDCUAB.js";import{a as wt}from"./chunk-REKAXM5L.js";import{a as xt}from"./chunk-SQZ3YN6N.js";import{b as bt,c as vt}from"./chunk-CIBZCVJQ.js";import{a as ht}from"./chunk-OTFCGVEU.js";import{a as Ct}from"./chunk-HPLI5COI.js";import{b as yt}from"./chunk-DUVWFXSE.js";import{a as mt}from"./chunk-OEHD5D2Y.js";import{a as Tt}from"./chunk-GLWQGYBC.js";import{a as Z}from"./chunk-DC4QM32I.js";import{F as ut,c as X,q as dt,s as ft,u as gt}from"./chunk-VHE3PQ3O.js";import{$ as J,Aa as it,B as q,Ea as nt,G as Q,Ga as at,Ha as ot,Ia as rt,Ja as lt,Qa as st,W as U,Z as $,Za as ct,hb as _t,jb as pt,va as tt,w as Y,wa as et,z}from"./chunk-GYDYF5F3.js";import{M as j,Q as K,f as A,g as H,o as N,t as O}from"./chunk-PD5VTTIY.js";import{$c as R,Aa as p,Ba as m,Hb as E,Lc as P,Mc as f,Nc as b,Ob as u,Oc as k,Uc as v,Vc as T,Wc as x,Yc as G,Zc as D,_b as _,ac as F,bc as V,ed as B,fc as y,gd as W,kb as M,kc as l,lb as I,lc as r,mc as L,nc as w,oc as S,qc as C,rb as o,sb as h,wc as d,yc as s}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";var Vt=()=>["Gift Gallery"],kt=(i,a,t)=>({name:i,label:a,count:t}),Mt=i=>[i],Gt=()=>[];function It(i,a){if(i&1){let t=C();l(0,"app-listing-tab",21),d("tabChange",function(e){p(t);let c=s();return m(c.onTabChange(e.tab))}),r()}if(i&2){let t=a.$implicit,n=s();_("tabs",D(6,Mt,R(2,kt,t.name,t.label,t.count)))("activeTab",n.activeTab)}}function Et(i,a){i&1&&(l(0,"td",11),f(1,"\xA0"),r())}function Ft(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s();return e.filter.created_name="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function Pt(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s();return e.filter.title="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function Dt(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s();return e.filter.customer_type="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function Rt(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s(2);return e.filter.range_start="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function Bt(i,a){if(i&1){let t=C();l(0,"td",11)(1,"div",13)(2,"mat-form-field",14)(3,"input",17),x("ngModelChange",function(e){p(t);let c=s();return T(c.filter.range_start,e)||(c.filter.range_start=e),m(e)}),d("keyup.enter",function(){p(t);let e=s();return m(e.getGiftList())}),r(),u(4,Rt,3,0,"button",18),r()()()}if(i&2){let t=s();o(3),v("ngModel",t.filter.range_start),o(),y(t.filter.range_start?4:-1)}}function Wt(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s(2);return e.filter.range_end="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function At(i,a){if(i&1){let t=C();l(0,"td",11)(1,"div",13)(2,"mat-form-field",14)(3,"input",17),x("ngModelChange",function(e){p(t);let c=s();return T(c.filter.range_end,e)||(c.filter.range_end=e),m(e)}),d("keyup.enter",function(){p(t);let e=s();return m(e.getGiftList())}),r(),u(4,Wt,3,0,"button",18),r()()()}if(i&2){let t=s();o(3),v("ngModel",t.filter.range_end),o(),y(t.filter.range_end?4:-1)}}function Ht(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s(2);return e.filter.gift_point="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function Nt(i,a){if(i&1){let t=C();l(0,"td",11)(1,"div",13)(2,"mat-form-field",14)(3,"input",17),x("ngModelChange",function(e){p(t);let c=s();return T(c.filter.gift_point,e)||(c.filter.gift_point=e),m(e)}),d("keyup.enter",function(){p(t);let e=s();return m(e.getGiftList())}),r(),u(4,Ht,3,0,"button",18),r()()()}if(i&2){let t=s();o(3),v("ngModel",t.filter.gift_point),o(),y(t.filter.gift_point?4:-1)}}function Ot(i,a){if(i&1){let t=C();l(0,"button",22),d("click",function(){p(t);let e=s(2);return e.filter.point_value="",m(e.getGiftList())}),l(1,"mat-icon"),f(2,"close"),r()()}}function jt(i,a){if(i&1){let t=C();l(0,"td",11)(1,"div",13)(2,"mat-form-field",14)(3,"input",17),x("ngModelChange",function(e){p(t);let c=s();return T(c.filter.point_value,e)||(c.filter.point_value=e),m(e)}),d("keyup.enter",function(){p(t);let e=s();return m(e.getGiftList())}),r(),u(4,Ot,3,0,"button",18),r()()()}if(i&2){let t=s();o(3),v("ngModel",t.filter.point_value),o(),y(t.filter.point_value?4:-1)}}function Kt(i,a){i&1&&(l(0,"td",11),f(1,"\xA0"),r())}function Yt(i,a){if(i&1){let t=C();w(0),l(1,"img",33),d("click",function(){let e=p(t).$implicit,c=s(4);return m(c.comanFuncation.zoom(e._id,"gift-gallery/get-doc"))}),r(),S()}if(i&2){let t=a.$implicit;o(),_("src",t.signed_url,I)}}function zt(i,a){if(i&1&&(l(0,"td")(1,"div",30)(2,"span",31),u(3,Yt,2,1,"ng-container",32),r()()()),i&2){let t=s().$implicit;o(3),_("ngForOf",t.files)}}function qt(i,a){if(i&1&&(w(0),f(1),S()),i&2){let t=s().$implicit;o(),k(" ",t.title||"--"," ")}}function Qt(i,a){if(i&1){let t=C();l(0,"a",34),d("click",function(){p(t);let e=s().$implicit,c=s(2);return m(c.goToDetail(e._id))}),f(1),r()}if(i&2){let t=s().$implicit;o(),k(" ",t.title||"--"," ")}}function Ut(i,a){if(i&1&&(l(0,"td"),f(1),r()),i&2){let t=s().$implicit;o(),b(t.customer_type_name||"--")}}function $t(i,a){if(i&1&&(l(0,"td"),f(1),r()),i&2){let t=s().$implicit;o(),b(t.customer_type_name||"--")}}function Jt(i,a){if(i&1&&(l(0,"td"),f(1),r()),i&2){let t=s().$implicit;o(),b(t.range_start||"--")}}function Xt(i,a){if(i&1&&(l(0,"td"),f(1),r()),i&2){let t=s().$implicit;o(),b(t.range_end||"--")}}function Zt(i,a){if(i&1&&(l(0,"td"),f(1),r()),i&2){let t=s().$implicit;o(),b(t.point_value?t.point_value+" PT":"--")}}function te(i,a){if(i&1&&(l(0,"td"),f(1),r()),i&2){let t=s().$implicit;o(),b(t.point_value?t.point_value+" PT":"--")}}function ee(i,a){if(i&1){let t=C();l(0,"app-icon-button",35),d("clickEvent",function(){p(t);let e=s().$implicit,c=s(2);return m(c.delete(e._id,"gift-gallery/delete",e.gift_type))}),r()}i&2&&_("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}function ie(i,a){if(i&1){let t=C();l(0,"tr",10)(1,"td",11),f(2),r(),u(3,zt,4,1,"td",19),l(4,"td"),f(5),B(6,"date"),r(),l(7,"td"),f(8),r(),l(9,"td"),u(10,qt,2,1,"ng-container",19)(11,Qt,2,1,"a",24),r(),u(12,Ut,2,1,"td",19)(13,$t,2,1,"td",19)(14,Jt,2,1,"td",19)(15,Xt,2,1,"td",19)(16,Zt,2,1,"td",19)(17,te,2,1,"td",19),l(18,"td"),L(19,"span",25),r(),l(20,"td")(21,"span",26)(22,"app-toggle",27),d("checkedChange",function(e){let c=p(t).$implicit,g=s(2);return m(g.onToggleChange(e,c._id,c.status))}),r()()(),l(23,"td")(24,"div")(25,"app-icon-button",28),d("clickEvent",function(){let e=p(t).$implicit,c=s(2);return m(c.openMainLogModal(e._id))}),r(),u(26,ee,1,2,"app-icon-button",29),r()()()}if(i&2){let t=a.$implicit,n=a.index,e=s(2);F("bg-gray-400",e.isHighlighted(t._id)),o(2),b((e.pagination.cur_page-1)*e.pagination.limit+n+1),o(),_("ngIf",e.activeTab==="Gift"||e.activeTab==="Voucher"),o(2),b(t.created_at?W(6,19,t.created_at,"dd MMM yyyy hh:mm a"):"---"),o(3),b(t.created_name?t.created_name:"---"),o(2),_("ngIf",e.activeTab!=="Voucher"),o(),_("ngIf",e.activeTab==="Voucher"),o(),_("ngIf",e.activeTab==="Gift"||e.activeTab==="Voucher"),o(),_("ngIf",e.activeTab==="Cash"),o(),_("ngIf",e.activeTab==="Cash"),o(),_("ngIf",e.activeTab==="Cash"),o(),_("ngIf",e.activeTab==="Gift"||e.activeTab==="Voucher"),o(),_("ngIf",e.activeTab==="Cash"),o(2),_("innerHTML",t.description||"--",M),o(3),_("checked",t.isChecked),o(3),_("icon","ri-file-list-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light"),o(),_("ngIf",e.accessRight==null?null:e.accessRight.deleteRight)}}function ne(i,a){if(i&1&&(w(0),u(1,ie,27,22,"tr",23),S()),i&2){let t=s();o(),_("ngForOf",t.giftMasterList)}}function ae(i,a){i&1&&(l(0,"td"),L(1,"app-skeleton"),r()),i&2&&(o(),V("h20 bg-skeleton"))}function oe(i,a){i&1&&(l(0,"tr",10),u(1,ae,2,2,"td",32),r()),i&2&&(o(),_("ngForOf",G(1,Gt).constructor(10)))}function re(i,a){i&1&&(w(0),u(1,oe,2,2,"tr",36),S()),i&2&&(o(),_("ngForOf",G(1,Gt).constructor(9)))}function le(i,a){i&1&&(w(0),L(1,"app-data-not-found"),S())}var St=class i{constructor(a,t,n,e,c,g,se,ce,_e,pe){this.dialog=a;this.api=t;this.alert=n;this.router=e;this.dateService=c;this.toastr=g;this.moduleService=se;this.logService=ce;this.comanFuncation=_e;this.highlightService=pe}FORMID=Ct;filter={};skLoading=!1;view;pagination={};giftMasterList=[];cashMasterList=[];moduleFormId=0;moduleId=0;submodule={};activeTab="Gift";isChecked=!1;originalData={};mainTabs=[];giftTabs={};highlightedId;pageKey="qr-list";accessRight={};ngOnInit(){let a=this.moduleService.getAccessMap("IRP","Gift Gallery");a&&(this.accessRight=a);let t=this.moduleService.getSubModuleByName("IRP","Gift Gallery"),n=this.moduleService.getFormById("IRP","Qr Code",this.FORMID.ID.GiftList);t&&(this.submodule=t),n&&(this.moduleFormId=n.form_id);let e=this.highlightService.getHighlight(this.pageKey);e!=null&&(this.activeTab=e.tab,this.highlightedId=e.rowId,this.pagination.cur_page=e.pageIndex,this.filter=e.filters,this.highlightService.clearHighlight(this.pageKey)),this.getGiftList()}listColumns=[{label:"S.No",field:"S.No"},{label:"Images",field:"Images"},{label:"Created At",field:"Created At"},{label:"Created Name",field:"Created Name"},{label:"Title",field:"Title"},{label:"Customer Category",field:"Customer Category"},{label:"Range Start",field:"Range Start"},{label:"Range End",field:"Range End"},{label:"Eligible Points",field:"Eligible Points"},{label:"Per Point Value",field:"Per Point Value"},{label:"Description",field:"Description"},{label:"Status",field:"Status"},{label:"Action",field:"Action"}];get filteredListColumns(){return this.listColumns?this.activeTab==="Gift"||this.activeTab==="Voucher"?this.listColumns?.filter(a=>a.label!=="Range Start"&&a.label!=="Range End"&&a.label!=="Per Point Value")||[]:this.activeTab==="Cash"?this.listColumns?.filter(a=>a.label!=="Eligible Points"&&a.label!=="Start Date"&&a.label!=="End Date"&&a.label!=="Images")||[]:this.listColumns||[]:[]}isHighlighted(a){return this.highlightedId===a}setHighLight(a){this.comanFuncation.setHighLight(this.pageKey,a,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}goToDetail(a){this.setHighLight(a),this.router.navigate(["/apps/loyalty/gift-list/gift-detail/"+this.activeTab+"/"+a])}getGiftList(){this.skLoading=!0,this.api.post({filters:this.filter,activeTab:this.activeTab,page:this.pagination.cur_page??1},"gift-gallery/read").subscribe(a=>{if(a.statusCode==200){this.skLoading=!1,this.giftMasterList=a.data.result,this.giftTabs=a.data.activeTab,this.mainTabs=[{name:"Gift",label:"Gift",icon:"ri-team-fill",count:this.giftTabs.gift_count?this.giftTabs.gift_count:0},{name:"Cash",label:"Bank Transfer",icon:"ri-calendar-check-fill",count:this.giftTabs.cash_count?this.giftTabs.cash_count:0},{name:"Voucher",label:"Voucher",icon:"ri-calendar-check-fill",count:this.giftTabs.voucher_count?this.giftTabs.voucher_count:0}];for(let t=0;t<this.giftMasterList.length;t++){let n=this.giftMasterList[t];n.isChecked=n.status==="Active"}this.pagination=a.pagination}})}onTabChange(a){this.activeTab=a,this.getGiftList()}changeToPagination(a){a==="Next"&&this.pagination.cur_page<this.pagination.total_pages?this.pagination.cur_page++:a==="Previous"&&this.pagination.cur_page>1&&this.pagination.cur_page--,this.getGiftList()}changeToPage(a){this.pagination.cur_page=a,this.getGiftList()}goToGiftAdd(){this.router.navigate(["/apps/loyalty/gift-list/gift-add"])}delete(a,t,n){this.comanFuncation.delete(a,this.submodule,n,t,"single_action",a).subscribe(e=>{e===!0&&this.getGiftList()})}onRefresh(){this.filter={},this.getGiftList()}updateGift(a,t){this.router.navigate(["/apps/loyalty/gift-add"],{queryParams:{id:a,type:t}})}onDateChange(a,t){if(t){let n=this.dateService.formatToYYYYMMDD(t);this.filter[a]=n}else this.filter[a]=null;(this.filter.date_from&&this.filter.date_to||this.filter.created_at)&&this.getGiftList()}openMainLogModal(a){this.comanFuncation.listLogsModal(this.submodule.module_id,a,this.submodule.module_type).subscribe(t=>{})}onToggleChange(a,t,n){this.comanFuncation.statusChange(a,t,n,this.submodule,"toggle","gift-gallery/update-status").subscribe(e=>{e?this.getGiftList():this.getGiftList()})}static \u0275fac=function(t){return new(t||i)(h(st),h($),h(J),h(j),h(pt),h(Y),h(Z),h(ht),h(vt),h(bt))};static \u0275cmp=E({type:i,selectors:[["app-gift-list"]],decls:49,vars:41,consts:[["picker",""],[3,"title","title1","activeitem","btnShow1"],[1,"box","py-3","px-4"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[1,"row"],[1,"col-xl-12"],[3,"onRefresh","button1","pageTitle","refreshLabel","btnShow","btnShow2","addBtnLabel"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"tableHead","tableHeadColumn","showCheckbox","columns"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],["class","!text-center",4,"ngIf"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","createdAt","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],[4,"ngIf"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"tabChange","tabs","activeTab"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],["class","link-primary underline","matTooltip","View Detail",3,"click",4,"ngIf"],[3,"innerHTML"],[1,"badge"],[3,"checkedChange","checked"],["matTooltip","View Logs",3,"clickEvent","icon","buttonClass"],["matTooltip","Delete",3,"icon","buttonClass","clickEvent",4,"ngIf"],[1,"flex","items-center"],[1,"avatar","avatar-sm","me-2","avatar-rounded"],[4,"ngFor","ngForOf"],["alt","Gift Image",3,"click","src"],["matTooltip","View Detail",1,"link-primary","underline",3,"click"],["matTooltip","Delete",3,"clickEvent","icon","buttonClass"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"]],template:function(t,n){if(t&1){let e=C();L(0,"app-page-header",1),l(1,"div",2)(2,"nav",3),u(3,It,1,8,"app-listing-tab",4),r(),l(4,"div",5)(5,"div",6)(6,"app-page-sub-header",7),d("onRefresh",function(){return p(e),m(n.onRefresh())})("button1",function(){return p(e),m(n.goToGiftAdd())}),r(),l(7,"div",8)(8,"div",8)(9,"spk-reusable-tables",9)(10,"tr",10)(11,"td",11),f(12,"\xA0"),r(),u(13,Et,2,0,"td",12),l(14,"td")(15,"div",13)(16,"mat-form-field",14)(17,"input",15),x("ngModelChange",function(g){return p(e),T(n.filter.created_at,g)||(n.filter.created_at=g),m(g)}),d("ngModelChange",function(g){return p(e),m(n.onDateChange("created_at",g))}),r(),L(18,"mat-datepicker-toggle",16)(19,"mat-datepicker",null,0),r()()(),l(21,"td",11)(22,"div",13)(23,"mat-form-field",14)(24,"input",17),x("ngModelChange",function(g){return p(e),T(n.filter.created_name,g)||(n.filter.created_name=g),m(g)}),d("keyup.enter",function(){return p(e),m(n.getGiftList())}),r(),u(25,Ft,3,0,"button",18),r()()(),l(26,"td",11)(27,"div",13)(28,"mat-form-field",14)(29,"input",17),x("ngModelChange",function(g){return p(e),T(n.filter.title,g)||(n.filter.title=g),m(g)}),d("keyup.enter",function(){return p(e),m(n.getGiftList())}),r(),u(30,Pt,3,0,"button",18),r()()(),l(31,"td",11)(32,"div",13)(33,"mat-form-field",14)(34,"input",17),x("ngModelChange",function(g){return p(e),T(n.filter.customer_type,g)||(n.filter.customer_type=g),m(g)}),d("keyup.enter",function(){return p(e),m(n.getGiftList())}),r(),u(35,Dt,3,0,"button",18),r()()(),u(36,Bt,5,2,"td",12)(37,At,5,2,"td",12)(38,Nt,5,2,"td",12)(39,jt,5,2,"td",12)(40,Kt,2,0,"td",12),l(41,"td",11),f(42,"\xA0"),r(),l(43,"td",11),f(44,"\xA0"),r()(),u(45,ne,2,1,"ng-container",19)(46,re,2,2,"ng-container",19),r(),u(47,le,2,0,"ng-container",19),r(),l(48,"app-pagination-footer",20),d("preButtonClick",function(){return p(e),m(n.changeToPagination("Previous"))})("nextButtonClick",function(){return p(e),m(n.changeToPagination("Next"))})("pageChange",function(g){return p(e),m(n.changeToPage(g))}),r()()()()()}if(t&2){let e=P(20);_("title","IRP")("title1",G(40,Vt))("activeitem","Gift list")("btnShow1",!1),o(3),_("ngForOf",n.mainTabs),o(3),V("p-0 pt-3"),_("pageTitle","Gift List")("refreshLabel","Refresh")("btnShow",!0)("btnShow2",n.accessRight==null?null:n.accessRight.addRight)("addBtnLabel","Add Gift"),o(3),_("tableHead","border-b")("tableHeadColumn","!text-center")("showCheckbox",!1)("columns",n.filteredListColumns),o(4),_("ngIf",n.activeTab==="Gift"||n.activeTab==="Voucher"),o(4),_("matDatepicker",e),v("ngModel",n.filter.created_at),o(),_("for",e),o(6),v("ngModel",n.filter.created_name),o(),y(n.filter.created_name?25:-1),o(4),v("ngModel",n.filter.title),o(),y(n.filter.title?30:-1),o(4),v("ngModel",n.filter.customer_type),o(),y(n.filter.customer_type?35:-1),o(),_("ngIf",n.activeTab==="Cash"),o(),_("ngIf",n.activeTab==="Cash"),o(),_("ngIf",n.activeTab==="Gift"||n.activeTab==="Voucher"),o(),_("ngIf",n.activeTab==="Cash"),o(),_("ngIf",n.activeTab==="Gift"||n.activeTab==="Voucher"),o(5),_("ngIf",!n.skLoading),o(),_("ngIf",n.skLoading),o(),_("ngIf",!n.giftMasterList.length&&!n.skLoading),o(),_("currentPage",n.pagination.cur_page)("totalPage",n.pagination.total_pages)("pageLimit",n.pagination.limit)("listLength",n.giftMasterList.length)("preBtn",!n.pagination.prev)("nextBtn",!n.pagination.next)}},dependencies:[mt,ut,A,H,z,q,Q,Tt,X,ft,dt,Lt,xt,wt,gt,ct,N,_t,it,ot,rt,lt,nt,at,et,tt,O,U,yt,K],encapsulation:2})};export{St as GiftListComponent};
