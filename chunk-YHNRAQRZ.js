import{a as ce}from"./chunk-J4NDCUAB.js";import{a as pe}from"./chunk-ZON5AR26.js";import"./chunk-LGZVJJDX.js";import"./chunk-54KZ5YIV.js";import{a as le}from"./chunk-SQZ3YN6N.js";import{b as oe,c as re}from"./chunk-CIBZCVJQ.js";import"./chunk-OTFCGVEU.js";import{a as ae}from"./chunk-HPLI5COI.js";import"./chunk-DUVWFXSE.js";import{a as G}from"./chunk-CNF4GSI7.js";import{a as Z}from"./chunk-OEHD5D2Y.js";import{a as se}from"./chunk-GLWQGYBC.js";import{a as X}from"./chunk-DC4QM32I.js";import{F as ne,c as z,q as ee,s as te,u as ie}from"./chunk-VHE3PQ3O.js";import{$ as J,Qa as Y,V as K,W as Q,Y as U,Z as W,l as $}from"./chunk-GYDYF5F3.js";import{M as j,f as D,g as B,o as O,t as N}from"./chunk-PD5VTTIY.js";import{Aa as m,Ba as u,Fc as M,Gc as V,Hb as q,Hc as H,Mc as v,Nc as R,Ob as g,Oc as S,Yc as y,Zc as L,_b as r,ac as k,bc as x,bd as w,ed as P,gd as A,kc as p,lc as l,mc as T,nc as b,oc as h,qc as f,rb as o,sb as d,wc as _,yc as c}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";var ue=["reusableTable"],ge=()=>["Enquiry List"],E=()=>[],F=(n,i,e,t,a)=>({name:n,label:i,icon:e,count:t,subTab:a}),I=n=>[n];function de(n,i){n&1&&T(0,"app-skeleton"),n&2&&x("w100 h30 bg-skeleton")}function _e(n,i){n&1&&(b(0),p(1,"div",13),g(2,de,1,2,"app-skeleton",14),l(),h()),n&2&&(o(2),r("ngForOf",y(1,E).constructor(6)))}function be(n,i){if(n&1){let e=f();p(0,"app-listing-tab",17),_("tabChange",function(a){m(e);let s=c(2);return u(s.onTabChange(a.tab,a.subTab))}),l()}if(n&2){let e=i.$implicit,t=c(2);r("tabs",L(8,I,w(2,F,e.name,e.label,e.icon,e.count,e.subTab)))("activeTab",t.activeTab)}}function he(n,i){if(n&1&&(b(0),p(1,"nav",15),g(2,be,1,10,"app-listing-tab",16),l(),h()),n&2){let e=c();o(2),r("ngForOf",e.mainTabs)}}function fe(n,i){if(n&1){let e=f();p(0,"app-listing-tab",17),_("tabChange",function(a){m(e);let s=c(2);return u(s.onSubTabChange(a.subTab))}),l()}if(n&2){let e=i.$implicit,t=c(2);r("tabs",L(8,I,w(2,F,e.name,e.label,e.icon,e.count,e.name)))("activeTab",t.activeSubTab)}}function Ce(n,i){if(n&1&&(p(0,"nav",18),g(1,fe,1,10,"app-listing-tab",16),l()),n&2){let e=c();o(),r("ngForOf",e.inProcessTabs)}}function ve(n,i){if(n&1){let e=f();p(0,"app-listing-tab",17),_("tabChange",function(a){m(e);let s=c(2);return u(s.onSubTabChange(a.subTab))}),l()}if(n&2){let e=i.$implicit,t=c(2);r("tabs",L(8,I,w(2,F,e.name,e.label,e.icon,e.count,e.name)))("activeTab",t.activeSubTab)}}function ye(n,i){if(n&1&&(p(0,"nav",18),g(1,ve,1,10,"app-listing-tab",16),l()),n&2){let e=c();o(),r("ngForOf",e.closeTabs)}}function Te(n,i){if(n&1&&(p(0,"span"),v(1),P(2,"date"),l()),n&2){let e=c().$implicit,t=c().$implicit;o(),S(" ",A(2,1,(t==null?null:t[e.name])||(t==null||t.form_data==null?null:t.form_data[e.name]),"d MMM yyyy, hh:mm a")," ")}}function Se(n,i){if(n&1){let e=f();p(0,"span")(1,"a",25),_("click",function(){m(e);let a=c(2).$implicit,s=c(2);return u(s.goToDetailPage(a._id))}),v(2),l()()}if(n&2){let e=c().$implicit,t=c().$implicit;o(2),S(" ",(t==null?null:t[e.name])||(t==null||t.form_data==null?null:t.form_data[e.name])||"--"," ")}}function Le(n,i){if(n&1&&(p(0,"span"),v(1),l()),n&2){let e=c().$implicit,t=c().$implicit;o(),S(" ",(t==null?null:t[e.name])||(t==null||t.form_data==null?null:t.form_data[e.name])||"--"," ")}}function we(n,i){if(n&1&&(b(0),p(1,"td"),g(2,Te,3,4,"span",24)(3,Se,3,1,"span",3)(4,Le,2,1,"span",3),l(),h()),n&2){let e=i.$implicit;o(2),r("ngIf",e.name.includes("date")||e.name.endsWith("_at")),o(),r("ngIf",e.name==="enquiry_id"),o(),r("ngIf",!(e.name.includes("date")||e.name.endsWith("_at")||e.name==="enquiry_id"))}}function xe(n,i){if(n&1){let e=f();p(0,"tr",20)(1,"td",21),v(2),l(),g(3,we,5,3,"ng-container",22),p(4,"td",21)(5,"app-icon-button",23),_("clickEvent",function(){let a=m(e).$implicit,s=c(2);return u(s.goToDetailPage(a._id))}),l()()()}if(n&2){let e=i.$implicit,t=i.index,a=c(2);k("bg-gray-400",a.isHighlighted(e._id)),o(2),R(t+1),o(),r("ngForOf",a.visibleHeaders),o(2),r("icon","ri-eye-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light")}}function Ee(n,i){if(n&1&&(b(0),g(1,xe,6,6,"tr",19),h()),n&2){let e=c();o(),r("ngForOf",e.listing)}}function Fe(n,i){n&1&&(p(0,"td"),T(1,"app-skeleton"),l()),n&2&&(o(),x("h20 bg-skeleton"))}function Ie(n,i){n&1&&(p(0,"tr",27),g(1,Fe,2,2,"td",22),l()),n&2&&(o(),r("ngForOf",y(1,E).constructor(11)))}function qe(n,i){n&1&&(b(0),g(1,Ie,2,2,"tr",26),h()),n&2&&(o(),r("ngForOf",y(1,E).constructor(8)))}function ke(n,i){n&1&&(b(0),T(1,"app-data-not-found"),h())}var me=class n{constructor(i,e,t,a,s,C,Me,Ve,He,Re){this.moduleService=i;this.CommonApiService=e;this.api=t;this.dialog=a;this.fb=s;this.util=C;this.router=Me;this.alert=Ve;this.comanFuncation=He;this.highlightService=Re}reusableTable;filter={};FORMID=ae;skLoading=!1;tableData={};tableHeader=[];listing=[];listTabs={};pagination={};subModule={};moduleFormId=0;moduleTableId=0;fieldTypes=$;page=1;activeTab="Review Pending";activeSubTab="";mainTabs=[];inProcessTabs=[];closeTabs=[];highlightedId;pageKey="enquiry-list";accessRight={};ngOnInit(){let i=this.highlightService.getHighlight(this.pageKey);i!=null&&(this.activeTab=i.tab,this.highlightedId=i.rowId,this.pagination.cur_page=i.pageIndex,this.filter=i.filters,this.highlightService.clearHighlight(this.pageKey));let e=this.moduleService.getAccessMap("SFA","Enquiry");e&&(this.accessRight=e);let t=this.moduleService.getSubModuleByName("SFA","Enquiry"),a=this.moduleService.getFormById("SFA","Enquiry",this.FORMID.ID.EnquiryForm),s=this.moduleService.getTableById("SFA","Enquiry",this.FORMID.ID.EnquiryTable);t&&(this.subModule=t),a&&(this.moduleFormId=a.form_id),s&&(this.moduleTableId=s.table_id),this.getHeaderConfigListing()}onRefresh(){this.filter={},this.reusableTable.clearSearchInputs(),this.getHeaderConfigListing()}isHighlighted(i){return this.highlightedId===i}setHighLight(i){this.comanFuncation.setHighLight(this.pageKey,i,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}goToAddPage(){this.setHighLight("add"),this.router.navigate(["/apps/sfa/enquiry-list/enquiry-add"])}goToDetailPage(i){this.setHighLight(i),this.router.navigate(["/apps/sfa/enquiry-list/enquiry-detail",i])}onTabChange(i,e){this.activeTab=i,this.activeSubTab=e,this.getList()}onSubTabChange(i){this.activeSubTab=i,this.getList()}tableConfigData={};visibleHeaders=[];getHeaderConfigListing(){this.CommonApiService.getHeaderConfigListing(this.moduleTableId,this.moduleFormId).subscribe(i=>{this.tableConfigData=i.data.table_data;let e=this.tableConfigData.tableHead;this.visibleHeaders=e.filter(t=>t.list_view_checked&&t.key_name_required!==!0&&t.type!=this.fieldTypes.UPLOAD),this.getList()})}getList(){this.skLoading=!0,this.api.post({filters:this.filter,form_id:this.moduleFormId,activeTab:this.activeTab,activeSubTab:this.activeSubTab},"enquiry/read").subscribe(i=>{i.statusCode=="200"&&(this.skLoading=!1,this.listing=i.data.result,this.listTabs=i.data.tabCounts,this.mainTabs=[{name:"Review Pending",label:"Review Pending",icon:"ri-eye-fill",count:this.listTabs?.review_pending||"0",subTab:""},{name:"Inprocess",label:"Inprocess",icon:"ri-hourglass-fill",count:(this.listTabs?.not_assigned||0)+(this.listTabs?.assigned||0),subTab:"Assigned"},{name:"Close",label:"Close",icon:"ri-shake-hands-fill",count:(this.listTabs?.lost||0)+(this.listTabs?.drop||0)+(this.listTabs?.junk_and_close||0),subTab:"Lost"},{name:"Win",label:"Win",icon:"ri-trophy-fill",count:this.listTabs?.win||"0",subTab:""}],this.inProcessTabs=[{name:"Assigned",label:"Assigned",icon:"ri-check-double-fill",count:this.listTabs?.assigned||"0"},{name:"Not Assigned",label:"Not Assigned",icon:"ri-hourglass-2-fill",count:this.listTabs?.not_assigned||"0"}],this.closeTabs=[{name:"Lost",label:"Lost",icon:"ri-hourglass-fill",count:this.listTabs?.lost||"0"},{name:"Drop",label:"Drop",icon:"ri-delete-bin-7-fill",count:this.listTabs?.drop||"0"},{name:"Junk & Close",label:"Junk & Close",icon:"ri-delete-bin-6-fill",count:this.listTabs?.junk_and_close||"0"}],this.pagination=i.pagination)})}getTabCount(i){return this.listTabs&&this.listTabs[i]!==void 0?this.listTabs[i].toString():"0"}changeToPagination(i){i=="Previous"?this.pagination.prev&&this.page>1&&(this.page--,this.getList()):this.pagination.next&&(this.page++,this.getList())}changeToPage(i){this.page=i,this.pagination.cur_page=i,this.getList()}updateSearchFilter(i){this.filter[i.name]=i.searchText,this.getList()}handleSelectChange(i){let{category_name:e,selections:t}=i;this.filter[e]=t,this.getList()}openHeaderSettingModal(){this.getHeaderConfigListing(),this.dialog.open(pe,{width:"450px",panelClass:"mat-right-modal",position:{right:"0px"},data:{lastPage:"header-config",moduleFormId:this.moduleFormId,moduleTableId:this.moduleTableId,moduleName:this.subModule.title,tableConfigData:this.tableConfigData}}).afterClosed().subscribe(e=>{e===!0&&this.getHeaderConfigListing()})}openMainLogModal(i){this.comanFuncation.listLogsModal(this.subModule.module_id,i,this.subModule.module_type).subscribe(e=>{e===!0&&this.getList()})}static \u0275fac=function(e){return new(e||n)(d(X),d(G),d(W),d(Y),d(K),d(U),d(j),d(J),d(re),d(oe))};static \u0275cmp=q({type:n,selectors:[["app-enquiry-list"]],viewQuery:function(e,t){if(e&1&&M(ue,5),e&2){let a;V(a=H())&&(t.reusableTable=a.first)}},decls:18,vars:39,consts:[["reusableTable",""],[3,"buttonClick","title","title1","activeitem","buttonText","icon","btnShow","buttonValue","buttonValue1"],[1,"box","py-3","px-4"],[4,"ngIf"],["class","sm:flex sm:space-x-2 sm:rtl:space-x-reverse gap-1 mt-2","aria-label","Tabs","role","tablist",4,"ngIf"],[1,"row"],[1,"col-xl-12"],[1,"box"],[3,"onRefresh","logBtn","button1","pageTitle","listLength","btnShow","refreshLabel","btnShow1","logsLabel","btnShow2","addBtnLabel"],[1,"box-body"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"textSearchChange","selectionChange","tableHead","showCheckbox","showS_No","showSorting","showFilterRow","showAction","columns","subModule"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[1,"flex","items-center","gap-3"],[3,"class",4,"ngFor","ngForOf"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1","mt-2"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[4,"ngFor","ngForOf"],[3,"clickEvent","icon","buttonClass"],[4,"ngIfElseNonDate","ngIf"],[1,"text-primary","font-semibold","underline",3,"click"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"]],template:function(e,t){if(e&1){let a=f();p(0,"app-page-header",1),_("buttonClick",function(){return m(a),u(t.openHeaderSettingModal())}),l(),p(1,"div",2),g(2,_e,3,2,"ng-container",3)(3,he,3,1,"ng-container",3)(4,Ce,2,1,"nav",4)(5,ye,2,1,"nav",4),l(),p(6,"div",5)(7,"div",6)(8,"div",7)(9,"app-page-sub-header",8),_("onRefresh",function(){return m(a),u(t.onRefresh())})("logBtn",function(){return m(a),u(t.openMainLogModal(""))})("button1",function(){return m(a),u(t.goToAddPage())}),l(),p(10,"div",9)(11,"div",10)(12,"spk-reusable-tables",11,0),_("textSearchChange",function(C){return m(a),u(t.updateSearchFilter(C))})("selectionChange",function(C){return m(a),u(t.handleSelectChange(C))}),g(14,Ee,2,1,"ng-container",3)(15,qe,2,2,"ng-container",3),l(),g(16,ke,2,0,"ng-container",3),l()(),p(17,"app-pagination-footer",12),_("preButtonClick",function(){return m(a),u(t.changeToPagination("Previous"))})("nextButtonClick",function(){return m(a),u(t.changeToPagination("Next"))})("pageChange",function(C){return m(a),u(t.changeToPage(C))}),l()()()()}e&2&&(r("title","SFA")("title1",y(38,ge))("activeitem","Enquiry List")("buttonText","Header Config")("icon","settings")("btnShow",!1)("buttonValue","")("btnShow",t.accessRight==null?null:t.accessRight.modifyRight)("buttonValue1",""),o(2),r("ngIf",t.skLoading),o(),r("ngIf",!t.skLoading),o(),r("ngIf",t.activeTab==="Inprocess"),o(),r("ngIf",t.activeTab==="Close"),o(4),r("pageTitle","Enquiry List")("listLength",t.listing.length)("btnShow",!0)("refreshLabel","Refresh")("btnShow1",!0)("logsLabel","Logs")("btnShow2",t.accessRight==null?null:t.accessRight.addRight)("addBtnLabel","Add Enquiry"),o(3),r("tableHead","border-b")("showCheckbox",!1)("showS_No",!0)("showSorting",!1)("showFilterRow",!0)("showAction",!0)("columns",t.visibleHeaders)("subModule",t.subModule),o(2),r("ngIf",!t.skLoading),o(),r("ngIf",t.skLoading),o(),r("ngIf",!t.listing.length&&!t.skLoading),o(),r("currentPage",t.pagination.cur_page)("totalPage",t.pagination.total_pages)("pageLimit",t.pagination.limit)("listLength",t.listing.length)("preBtn",!t.pagination.prev)("nextBtn",!t.pagination.next))},dependencies:[ne,D,B,se,z,te,ee,ce,le,ie,O,N,Z,Q],encapsulation:2})};export{me as EnquiryListComponent};
