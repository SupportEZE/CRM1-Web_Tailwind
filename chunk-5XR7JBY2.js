import{a as re}from"./chunk-LLHAOKPU.js";import{a as ae}from"./chunk-J4NDCUAB.js";import"./chunk-GXF7AAOQ.js";import{a as y}from"./chunk-ZON5AR26.js";import"./chunk-LGZVJJDX.js";import"./chunk-54KZ5YIV.js";import{a as ne}from"./chunk-SQZ3YN6N.js";import{c as te}from"./chunk-CIBZCVJQ.js";import"./chunk-OTFCGVEU.js";import{a as ee}from"./chunk-HPLI5COI.js";import{b as oe}from"./chunk-DUVWFXSE.js";import{a as Q}from"./chunk-CNF4GSI7.js";import{a as X}from"./chunk-OEHD5D2Y.js";import{a as ie}from"./chunk-GLWQGYBC.js";import{a as J}from"./chunk-DC4QM32I.js";import{F as Z,c as U,s as Y}from"./chunk-VHE3PQ3O.js";import{$ as G,D as P,Qa as q,W as j,Y as W,Z as $,hb as z,jb as K,l as B,w as N}from"./chunk-GYDYF5F3.js";import{Q as O,f as V,g as E,o as H,t as A}from"./chunk-PD5VTTIY.js";import{Aa as d,Ba as c,Fc as I,Gc as T,Hb as F,Hc as k,Mc as C,Nc as x,Ob as g,Oc as w,Yc as L,_b as r,bc as M,ed as R,gd as D,kc as m,lc as l,mc as S,nc as b,oc as h,qc as v,rb as a,sb as _,wc as f,yc as u}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";var de=["reusableTable"],ce=()=>["Leave Policy"],le=()=>[];function me(n,i){if(n&1&&(m(0,"span"),C(1),R(2,"date"),l()),n&2){let t=u().$implicit,e=u().$implicit;a(),w(" ",D(2,1,(e==null?null:e[t.name])||(e==null||e.form_data==null?null:e.form_data[t.name]),"d MMM yyyy")," ")}}function pe(n,i){if(n&1&&(m(0,"span"),C(1),l()),n&2){let t,e=u().$implicit,o=u().$implicit;a(),w(" ",(t=(t=o[(e==null?null:e.actual_name)||(e==null?null:e.name)])!==null&&t!==void 0?t:o.form_data==null?null:o.form_data[e==null?null:e.name])!==null&&t!==void 0?t:"--"," ")}}function ue(n,i){if(n&1&&(b(0),m(1,"td"),g(2,me,3,4,"span",19)(3,pe,2,1,"span",9),l(),h()),n&2){let t=i.$implicit;a(2),r("ngIf",t.name.includes("date")||t.name.endsWith("_at")||t.name.endsWith("_start")||t.name.endsWith("_end")),a(),r("ngIf",!(t.name.includes("date")||t.name.endsWith("_at")||t.name.endsWith("_start")||t.name.endsWith("_end")))}}function _e(n,i){if(n&1){let t=v();m(0,"app-icon-button",16),f("clickEvent",function(){d(t);let o=u().$implicit,s=u(2);return c(s.updateLeaveWiseLeave(o))}),l()}n&2&&r("icon","ri-edit-line")("buttonClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-success waves-effect waves-light")}function ge(n,i){if(n&1){let t=v();m(0,"app-icon-button",20),f("click",function(){d(t);let o=u().$implicit,s=u(2);return c(s.delete(o._id,"leave/delete","Delete"))}),l()}n&2&&r("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave leave-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}function fe(n,i){if(n&1){let t=v();m(0,"tr",11)(1,"td",12),C(2),l(),g(3,ue,4,2,"ng-container",13),m(4,"td",14)(5,"div",15)(6,"app-icon-button",16),f("clickEvent",function(){let o=d(t).$implicit,s=u(2);return c(s.openMainLogModal(o._id))}),l(),g(7,_e,1,2,"app-icon-button",17)(8,ge,1,2,"app-icon-button",18),l()()()}if(n&2){let t=i.index,e=u(2);a(2),x(t+1),a(),r("ngForOf",e.visibleHeaders),a(3),r("icon","ri-file-list-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light"),a(),r("ngIf",e.accessRight==null?null:e.accessRight.modifyRight),a(),r("ngIf",e.accessRight==null?null:e.accessRight.deleteRight)}}function be(n,i){if(n&1&&(b(0),g(1,fe,9,6,"tr",10),h()),n&2){let t=u();a(),r("ngForOf",t.leaveListing)("ngForTrackBy",t.trackByFn)}}function he(n,i){n&1&&(m(0,"td"),S(1,"app-skeleton"),l()),n&2&&(a(),M("h20 bg-skeleton"))}function ve(n,i){n&1&&(m(0,"tr",22),g(1,he,2,2,"td",13),l()),n&2&&(a(),r("ngForOf",L(1,le).constructor(8)))}function Ce(n,i){n&1&&(b(0),g(1,ve,2,2,"tr",21),h()),n&2&&(a(),r("ngForOf",L(1,le).constructor(8)))}function Le(n,i){n&1&&(b(0),S(1,"app-data-not-found"),h())}var se=class n{constructor(i,t,e,o,s,p,Se,we,ye){this.toastr=i;this.dialog=t;this.api=e;this.alert=o;this.dateService=s;this.moduleService=p;this.comanFuncation=Se;this.util=we;this.CommonApiService=ye}reusableTable;filter={};listColumns=[];skLoading=!1;view;fieldTypes=B;onClick1(i){}originalFormFields=[];formGroup=new P({});formFields=[];disabled=!1;page=1;moduleFormId=0;moduleTableId=0;FORMID=ee;sorting={};subModule;accessRight={};ngOnInit(){let i=this.moduleService.getAccessMap("Masters","Leave Policy");i&&(this.accessRight=i);let t=this.moduleService.getSubModuleByName("Masters","Leave Policy"),e=this.moduleService.getFormById("Masters","Leave Policy",this.FORMID.ID.LeaveMasterForm),o=this.moduleService.getTableById("Masters","Leave Policy",this.FORMID.ID.LeaveMasterTable);t&&(this.subModule=t),e&&(this.moduleFormId=e.form_id),o&&(this.moduleTableId=o.table_id),this.getHeaderConfigListing(),this.getFormData()}onRefresh(){this.filter={},this.reusableTable.clearSearchInputs(),this.getHeaderConfigListing()}tableConfigData={};visibleHeaders=[];getHeaderConfigListing(){this.CommonApiService.getHeaderConfigListing(this.moduleTableId,this.moduleFormId).subscribe(i=>{this.tableConfigData=i.data.table_data;let t=this.tableConfigData.tableHead;this.visibleHeaders=t.filter(e=>e.list_view_checked),this.getList()})}leaveListing=[];getList(){this.skLoading=!0,this.api.post({filters:this.filter,sorting:this.sorting,page:this.page},"leave/read").subscribe(i=>{i.statusCode===200&&(this.skLoading=!1,this.leaveListing=i.data)})}trackByFn(i,t){return t.id}onSortChanged(i){this.sorting={},this.sorting[i.field]=i.order,this.getList()}handleSelectionChange(i){let{category_name:t,selections:e}=i;this.filter[t]=e,this.getList()}updateSearchFilter(i){this.filter[i.name]=i.searchText,this.getList()}handleDateRangeChange(i){this.filter=i,this.getList()}handleDateChange(i){this.filter=i,this.getList()}delete(i,t,e){this.comanFuncation.delete(i,this.subModule,e,t,"single_action",i).subscribe(o=>{o===!0&&this.getList()})}updateLeaveWiseLeave(i){this.dialog.open(re,{width:"768px",data:{lastPage:"leave-add",formType:i?"edit":"add",formData:i||{}}}).afterClosed().subscribe(e=>{e===!0&&this.getHeaderConfigListing()})}openMainLogModal(i){this.comanFuncation.listLogsModal(this.subModule.sub_module_id,i,this.subModule.module_type).subscribe(t=>{})}getFormData(){this.skLoading=!0,this.api.post({form_id:this.moduleFormId,platform:"web"},"form-builder/read").subscribe(i=>{i.statusCode==200&&(i?.data?.form_data&&(this.originalFormFields=JSON.parse(JSON.stringify(i.data.form_data))),this.formFields=i.data.form_data,this.skLoading=!1,this.formFields.forEach(t=>{this.util.createValidation(t)}))})}openModal(i){this.dialog.open(y,{data:{lastPage:"leave-master",form_Fields:this.originalFormFields,moduleFormId:this.moduleFormId,moduleId:this.subModule.sub_module_id,moduleName:this.subModule.title,module_type:this.subModule.module_type}}).afterClosed().subscribe(e=>{e===!0&&this.getHeaderConfigListing()})}openHeaderSettingModal(){this.getHeaderConfigListing(),this.dialog.open(y,{width:"450px",panelClass:"mat-right-modal",position:{right:"0px"},data:{lastPage:"header-config",moduleFormId:this.moduleFormId,moduleTableId:this.moduleTableId,moduleName:this.subModule.title,tableConfigData:this.tableConfigData}}).afterClosed().subscribe(t=>{t===!0&&this.getHeaderConfigListing()})}static \u0275fac=function(t){return new(t||n)(_(N),_(q),_($),_(G),_(K),_(J),_(te),_(W),_(Q))};static \u0275cmp=F({type:n,selectors:[["app-leave-list"]],viewQuery:function(t,e){if(t&1&&I(de,5),t&2){let o;T(o=k())&&(e.reusableTable=o.first)}},inputs:{formFields:"formFields"},decls:12,vars:30,consts:[["reusableTable",""],[3,"buttonClick","buttonClick1","title","title1","activeitem","btnShow","icon","buttonText","btnShow1","icon1","buttonText1","dataHsOverlay"],[1,"row"],[1,"col-xl-12"],[1,"box"],[3,"onRefresh","logBtn","button1","pageTitle","listLength","btnShow","refreshLabel","btnShow1","logsLabel","btnShow2","addBtnLabel"],[1,"box-body"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"sortChanged","selectionChange","textSearchChange","dateChange","dateRangeChange","tableHead","showCheckbox","showS_No","showSorting","showFilterRow","showAction","columns","subModule"],[4,"ngIf"],["class","leave-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf","ngForTrackBy"],[1,"leave-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[4,"ngFor","ngForOf"],[1,"!text-center","relative","w135"],[1,"flex","flex-row","items-center","!gap-2","text-[0.9375rem]"],[3,"clickEvent","icon","buttonClass"],[3,"icon","buttonClass","clickEvent",4,"ngIf"],[3,"icon","buttonClass","click",4,"ngIf"],[4,"ngIfElseNonDate","ngIf"],[3,"click","icon","buttonClass"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"]],template:function(t,e){if(t&1){let o=v();m(0,"app-page-header",1),f("buttonClick",function(p){return d(o),c(e.openModal(p))})("buttonClick1",function(){return d(o),c(e.openHeaderSettingModal())}),l(),m(1,"div",2)(2,"div",3)(3,"div",4)(4,"app-page-sub-header",5),f("onRefresh",function(){return d(o),c(e.onRefresh())})("logBtn",function(){return d(o),c(e.openMainLogModal(""))})("button1",function(){return d(o),c(e.updateLeaveWiseLeave(""))}),l(),m(5,"div",6)(6,"div",7)(7,"spk-reusable-tables",8,0),f("sortChanged",function(p){return d(o),c(e.onSortChanged(p))})("selectionChange",function(p){return d(o),c(e.handleSelectionChange(p))})("textSearchChange",function(p){return d(o),c(e.updateSearchFilter(p))})("dateChange",function(p){return d(o),c(e.handleDateChange(p))})("dateRangeChange",function(p){return d(o),c(e.handleDateRangeChange(p))}),g(9,be,2,2,"ng-container",9)(10,Ce,2,2,"ng-container",9),l(),g(11,Le,2,0,"ng-container",9),l()()()()()}t&2&&(r("title","Master Modules")("title1",L(29,ce))("activeitem","Leave Policy List")("btnShow",e.accessRight==null?null:e.accessRight.modifyRight)("icon","settings")("buttonText","Form Config")("btnShow1",e.accessRight==null?null:e.accessRight.modifyRight)("icon1","settings")("buttonText1","Header Config")("dataHsOverlay","#leave-header-config"),a(4),r("pageTitle","Leave Policy List")("listLength",e.leaveListing.length)("btnShow",!0)("refreshLabel","Refresh")("btnShow1",!0)("logsLabel","Logs")("btnShow2",e.accessRight==null?null:e.accessRight.addRight)("addBtnLabel","Add Leave"),a(3),r("tableHead","border-b")("showCheckbox",!1)("showS_No",!0)("showSorting",!1)("showFilterRow",!0)("showAction",!0)("columns",e.visibleHeaders)("subModule",e.subModule),a(2),r("ngIf",!e.skLoading),a(),r("ngIf",e.skLoading),a(),r("ngIf",!e.leaveListing.length&&!e.skLoading))},dependencies:[Z,V,E,ie,U,Y,ae,ne,H,z,A,O,X,j,oe],encapsulation:2})};export{se as LeaveListComponent};
