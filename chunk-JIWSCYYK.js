import{c as Te}from"./chunk-7FUDRD4B.js";import{a as Je}from"./chunk-2N4MLWQT.js";import{a as Qe}from"./chunk-54KZ5YIV.js";import{a as $e}from"./chunk-PJTW4QXW.js";import{c as Q}from"./chunk-CIBZCVJQ.js";import"./chunk-OTFCGVEU.js";import{a as we}from"./chunk-CNF4GSI7.js";import{a as We}from"./chunk-OEHD5D2Y.js";import{a as Ke}from"./chunk-GLWQGYBC.js";import{B as J,C as Ue,D as it,F,c as Se,g as je,h as Ye,q as qe,r as Ge,s as K,u as ze,v as He}from"./chunk-VHE3PQ3O.js";import{Aa as Ve,B as H,C as fe,Ea as Fe,G as ge,Ga as Ae,H as xe,Ha as Be,Ia as Ne,Ja as Oe,M as Ce,P as ve,V as ye,W as be,X as ke,Z as U,Za as Re,hb as $,ib as tt,jb as Pe,o as M,va as Ee,w as _e,wa as Le,xa as Ie,y as ue,ya as Me,z as he,za as De}from"./chunk-GYDYF5F3.js";import{M as z,e as Y,f as N,g as O,o as q,r as de,t as G}from"./chunk-PD5VTTIY.js";import{$c as me,Aa as d,Ba as _,Bc as te,Hb as D,Ka as re,Lc as ie,Mc as c,Nc as h,Ob as u,Oc as C,Pc as j,Uc as k,Vc as w,Wc as S,Yc as B,Zb as le,Zc as ce,_b as s,_c as se,bc as A,ed as I,fc as L,fd as pe,gd as V,kc as a,lc as i,mc as g,nc as v,oc as y,qc as x,rb as n,sb as b,wc as f,yc as m}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{g as oe}from"./chunk-66YHNWRR.js";var Ze=oe(tt());function at(r,t){if(r&1&&(v(0),c(1),y()),r&2){let e=m().$implicit;n(),j(" - (",e.contact_person_Info[0]==null?null:e.contact_person_Info[0].contact_person_name," - ",e.contact_person_Info[0]==null?null:e.contact_person_Info[0].contact_person_mobile,") ")}}function ot(r,t){if(r&1&&(a(0,"div",32),g(1,"spk-product-card",33),i()),r&2){let e=t.$implicit;n(),s("imageData",e)("editBtn",!1)("heading",!0)("subHeading",!0)("delBtn",!1)}}function rt(r,t){if(r&1&&(a(0,"div",30),u(1,ot,2,5,"div",31),i()),r&2){let e=m().$implicit;n(),s("ngForOf",e==null?null:e.files)}}function lt(r,t){if(r&1&&(a(0,"div",12)(1,"div",13)(2,"p",14),c(3),a(4,"span",15),c(5),I(6,"date"),i()(),a(7,"div",16)(8,"p",17)(9,"b"),c(10),u(11,at,2,2,"ng-container",7),i(),c(12),i(),a(13,"div",18)(14,"div",19)(15,"span"),c(16,"Checkin Time"),i(),a(17,"p",20),c(18),I(19,"date"),i()(),a(20,"div",19)(21,"span"),c(22,"Checkout Time"),i(),a(23,"p",21),c(24),I(25,"date"),i()(),a(26,"div",19)(27,"span"),c(28,"Total Meeting Time"),i(),a(29,"p",22),c(30),i()()(),a(31,"div",23)(32,"p")(33,"b"),c(34,"Start Location:"),i(),c(35),i(),a(36,"p")(37,"b"),c(38,"End Location:"),i(),c(39),i()(),a(40,"div",24)(41,"div",25)(42,"i",26),c(43),i(),a(44,"label",27),c(45," Order "),i()(),a(46,"div",25)(47,"i",26),c(48),i(),a(49,"label",27),c(50," Enquiry "),i()(),a(51,"div",25)(52,"i",26),c(53),i(),a(54,"label",27),c(55," Stock Audit "),i()(),a(56,"div",25)(57,"i",26),c(58),i(),a(59,"label",27),c(60," Photo Gallery "),i()(),a(61,"div",25)(62,"i",26),c(63),i(),a(64,"label",27),c(65," Follow Up "),i()(),a(66,"div",25)(67,"i",26),c(68),i(),a(69,"label",27),c(70," Payment Collection "),i()(),a(71,"div",25)(72,"i",26),c(73),i(),a(74,"label",27),c(75," Branding Audit "),i()(),a(76,"div",25)(77,"i",26),c(78),i(),a(79,"label",27),c(80," Pop Distribution "),i()(),a(81,"div",25)(82,"i",26),c(83),i(),a(84,"label",27),c(85," Support Ticket "),i()()(),a(86,"p",28)(87,"b"),c(88,"Topic Of DIscussion:"),i(),c(89),i(),a(90,"p",28)(91,"b"),c(92,"Remark:"),i(),c(93),i(),u(94,rt,2,1,"div",29),i()()()),r&2){let e=t.$implicit,l=t.index,o=m(2);n(),le("data-label",l+1),n(2),C(" ",e.user_info?e.user_info.name+e.user_info.user_code:""," "),n(2),h(V(6,32,e.activity_date,"hh:mm a")),n(5),C("",e.customer_details==null?null:e.customer_details.customer_name," - "),n(),s("ngIf",e.contact_person_Info==null?null:e.contact_person_Info.length),n(),C(" (",o.remove.formatText(e.customer_details==null?null:e.customer_details.customer_type_name),") "),n(6),h(e.visit_start?V(19,35,e.visit_start,"hh:mm a"):"Not Available"),n(6),h(e.visit_end?V(25,38,e.visit_end,"hh:mm a"):"Not Available"),n(6),h(e.avarage_meeting_time||"Not Available"),n(5),C(" ",e.start_location||"Not Available"," "),n(4),C(" ",e.end_location||"Not Available"," "),n(3),s("ngClass",e.order?"text-success":"text-danger"),n(),h(e.order?"check_circel":"cancel"),n(4),s("ngClass",e.enquiry?"text-success":"text-danger"),n(),h(e.enquiry?"check_circel":"cancel"),n(4),s("ngClass",e.stock_audit?"text-success":"text-danger"),n(),h(e.stock_audit?"check_circel":"cancel"),n(4),s("ngClass",e.photo_gallery?"text-success":"text-danger"),n(),h(e.photo_gallery?"check_circel":"cancel"),n(4),s("ngClass",e.follow_up?"text-success":"text-danger"),n(),h(e.follow_up?"check_circel":"cancel"),n(4),s("ngClass",e.payment_collection?"text-success":"text-danger"),n(),h(e.payment_collection?"check_circel":"cancel"),n(4),s("ngClass",e.branding_audit?"text-success":"text-danger"),n(),h(e.branding_audit?"check_circel":"cancel"),n(4),s("ngClass",e.pop_distribution?"text-success":"text-danger"),n(),h(e.pop_distribution?"check_circel":"cancel"),n(4),s("ngClass",e.support_ticket?"text-success":"text-danger"),n(),h(e.support_ticket?"check_circel":"cancel"),n(6),C(" ",e.checklist||"N/A"," "),n(4),C(" ",e.remark||"N/A"," "),n(),s("ngIf",e==null||e.files==null?null:e.files.length)}}function ct(r,t){if(r&1&&(a(0,"div")(1,"div",8)(2,"span",9),c(3),i()(),a(4,"div",10),u(5,lt,95,41,"div",11),i()()),r&2){let e=t.$implicit,l=m();n(3),C(" ",e," "),n(2),s("ngForOf",l.groupedData[e])}}function st(r,t){r&1&&(v(0),g(1,"app-data-not-found"),y())}var X=class r{constructor(t){this.remove=t}listingData;groupedData={};Object=Object;ngOnInit(){this.groupDataByDate()}groupDataByDate(){this.groupedData=this.listingData.reduce((t,e)=>{let l=new Date(e.activity_date),o=(0,Ze.default)(l).format("D MMM y");return t[o]||(t[o]=[]),t[o].push(e),t},{})}objectKeys(t){return Object.keys(t)}static \u0275fac=function(e){return new(e||r)(b(Qe))};static \u0275cmp=D({type:r,selectors:[["app-timeline"]],inputs:{listingData:"listingData"},decls:9,vars:2,consts:[[1,"timeline-1"],[1,"max-w-[100%]"],[1,"box","border","border-defaultborder","dark:border-defaultborder/10","overflow-hidden"],[1,"box-body"],[1,"timeline","scroll-y-600"],[1,"max-w-[95%]","mx-auto"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"timeline-end"],[1,"p-1","text-[11px]","bg-primarytint2color","text-white","backdrop-blur","text-center","border","border-primarytint2color","border-opacity-10","rounded-sm","leading-none","font-medium"],[1,"timeline-continue"],["class","timeline-right",4,"ngFor","ngForOf"],[1,"timeline-right"],[1,"timeline-content","mie-0"],[1,"timeline-date","text-textmuted","dark:text-textmuted/50","mb-2"],[1,"text-success"],[1,"timeline-box"],[1,"mb-2"],[1,"flex","mt-4","mid-border","flex-wrap","gap-2","justify-between","flex-auto"],[1,"py-2","px-4","h60","rounded-sm","border","border-defaultborder","dark:border-defaultborder/10","border-dashed","bg-light"],[1,"text-success","font-medium","text-[14px]","mb-0"],[1,"text-danger","font-medium","text-[14px]","mb-0"],[1,"text-primary","font-medium","text-[14px]","mb-0"],[1,"flex","gap-3","mb-2","mt-2"],[1,"flex","mt-4","gap-3"],[1,"form-check","flex","items-center","gap-2"],[1,"material-icons","inline-block",3,"ngClass"],["for","checkebox-sm",1,"font-medium","text-[.6875rem]"],[1,"mb-2","mt-2"],["class","grid grid-cols-12 gap-x-4",4,"ngIf"],[1,"grid","grid-cols-12","gap-x-4"],["class","xxl:col-span-3 lg:col-span-3 xl:col-span-4 sm:col-span-6 col-span-12",4,"ngFor","ngForOf"],[1,"xxl:col-span-3","lg:col-span-3","xl:col-span-4","sm:col-span-6","col-span-12"],["apiPath]","'timeline/get-doc'",3,"imageData","editBtn","heading","subHeading","delBtn"]],template:function(e,l){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div"),u(7,ct,6,2,"div",6),i()()(),u(8,st,2,0,"ng-container",7),i()()()()),e&2&&(n(7),s("ngForOf",l.objectKeys(l.groupedData)),n(),s("ngIf",l.groupedData&&l.Object.keys(l.groupedData).length===0))},dependencies:[F,Y,N,O,K,q,$e],encapsulation:2})};function mt(r,t){if(r&1&&(a(0,"div",3),g(1,"spk-listview-card",4),i()),r&2){let e=t.$implicit;n(),s("card",e)}}function pt(r,t){if(r&1&&(a(0,"div",5)(1,"app-showcode-card",6),g(2,"spk-apexcharts",7),i()()),r&2){let e=m();n(),A("box-title font-medium text-[15px] block"),s("title","Last 30 days graph visit count")("titleView",!0)("actionIcons",!1)("classbody","pt-0")("iconName","ri-pencil-line"),n(),s("chartOptions",e.chartOptions1)}}var Z=class r{chartOptions1;analyticsData;chartData;cardData=[];constructor(){setTimeout(()=>{this.setCardData(),this.setChartData()},100)}setChartData(){let t=this.chartData.map(l=>`${l.dayOfMonth} ${l.startMonthName}`),e=this.chartData.map(l=>l.count);this.chartOptions1={series:[{name:"Check In",data:e}],chart:{height:320,type:"line",zoom:{enabled:!1},events:{mounted:l=>{l.windowResizeHandler()}}},colors:["#5c67f7"],dataLabels:{enabled:!1},stroke:{curve:"smooth",width:6},grid:{borderColor:"#f2f5f7"},fill:{type:"gradient",gradient:{shade:"dark",gradientToColors:["#FDD835"],shadeIntensity:1,type:"horizontal",opacityFrom:1,opacityTo:1,stops:[0,100,100,100]}},markers:{size:4,colors:["#FFA41B"],strokeColors:"#fff",strokeWidth:2,hover:{size:7}},xaxis:{categories:t,labels:{show:!0,style:{colors:"#8c9097",fontSize:"11px",fontWeight:600,cssClass:"apexcharts-xaxis-label"}}},yaxis:{labels:{show:!0,style:{colors:"#8c9097",fontSize:"11px",fontWeight:600,cssClass:"apexcharts-yaxis-label"}}}}}setCardData(){this.cardData=[{id:1,customClass:"flex items-start justify-between mb-2",titleClass:"dark:text-textmuted/50 block mb-1",valueClass:"fw-medium mb-0",cardClass:"overflow-hidden main-content-card",title:"Total Visit",value:this.analyticsData?.total_visit,graph:"Increased",color:"success",percentage:"2.56%",percentageIcon:"ti ti-arrow-narrow-up text-[1rem]",bg:"primary",icon:"ri-user-location-line text-xl"},{id:2,customClass:"flex items-start justify-between mb-2",titleClass:"dark:text-textmuted/50 block mb-1",valueClass:"fw-medium mb-0",cardClass:"overflow-hidden main-content-card",title:"Planned Visit",value:this.analyticsData?.planned_visit,graph:"Decreased",color:"danger",percentage:"3.05%",percentageIcon:"ti ti-arrow-narrow-down text-[1rem]",bg:"primarytint1color",icon:"ri-map-pin-line text-xl"},{id:3,customClass:"flex items-start justify-between mb-2",titleClass:"dark:text-textmuted/50 block mb-1",valueClass:"fw-medium mb-0",cardClass:"overflow-hidden main-content-card",title:"Unplanned Visit",value:this.analyticsData?.unplanned_visit,graph:"Increased",color:"success",percentage:"2.16%",percentageIcon:"ti ti-arrow-narrow-up text-[1rem]",bg:"primarytint2color",icon:"ri-map-pin-line text-xl"},{id:4,customClass:"flex items-start justify-between mb-2",titleClass:"dark:text-textmuted/50 block mb-1",valueClass:"fw-medium mb-0",cardClass:"overflow-hidden main-content-card",title:"Avg. Meeting Time",value:this.analyticsData?.average_meeting_time,graph:"Increased",color:"success",percentage:"2.1%",percentageIcon:"ti ti-arrow-narrow-up text-[1rem]",bg:"primarytint3color",icon:"ri-time-line text-xl"},{id:4,customClass:"flex items-start justify-between mb-2",titleClass:"dark:text-textmuted/50 block mb-1",valueClass:"fw-medium mb-0",cardClass:"overflow-hidden main-content-card",title:"Productive Visit",value:this.analyticsData?.productive_visit,graph:"Increased",color:"success",percentage:"2.1%",percentageIcon:"ti ti-arrow-narrow-up text-[1rem]",bg:"success",icon:"ri-shopping-cart-line text-xl"},{id:4,customClass:"flex items-start justify-between mb-2",titleClass:"dark:text-textmuted/50 block mb-1",valueClass:"fw-medium mb-0",cardClass:"overflow-hidden main-content-card",title:"New Counter Visit",value:this.analyticsData?.new_counter_visit,graph:"Increased",color:"success",percentage:"2.1%",percentageIcon:"ti ti-arrow-narrow-up text-[1rem]",bg:"warning",icon:"ri-store-line text-xl"}]}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=D({type:r,selectors:[["app-analytics"]],inputs:{analyticsData:"analyticsData",chartData:"chartData"},decls:4,vars:2,consts:[[1,"grid","grid-cols-12","gap-x-6"],["class","xxl:col-span-4 xl:col-span-4 col-span-6",4,"ngFor","ngForOf"],["class","xxl:col-span-12 xl:col-span-12 col-span-12",4,"ngIf"],[1,"xxl:col-span-4","xl:col-span-4","col-span-6"],[3,"card"],[1,"xxl:col-span-12","xl:col-span-12","col-span-12"],[3,"title","titleView","actionIcons","classbody","iconName"],[3,"chartOptions"]],template:function(e,l){e&1&&(a(0,"div",0),u(1,mt,2,1,"div",1),i(),a(2,"div",0),u(3,pt,3,8,"div",2),i()),e&2&&(n(),s("ngForOf",l.cardData),n(2),s("ngIf",l.chartOptions1))},dependencies:[F,N,O,Je,J,Te],encapsulation:2})};var T=oe(it());var ee=class r{constructor(t,e,l,o,p,E,W,R,gi){this.commonFunction=t;this.bottomSheetRef=e;this.data=l;this.CommonApiService=o;this.api=p;this.toastr=E;this.router=W;this.formValidation=R;this.fb=gi;this.CommonApiService.getUserData([M.FIELD_USER])}today=new Date;filterForm;valueChange=new re;ngOnInit(){this.filterForm=this.fb.group({user_ids:[""],user_array:[""],start_date:[""],end_date:[""]})}onDateChange(){this.filterForm.get("end_date")?.reset()}lastSearchTerm="";onSearch(t,e){let l=t?.trim()||"";l!==this.lastSearchTerm&&(this.lastSearchTerm=l,e==="user"&&this.CommonApiService.getUserData([M.FIELD_USER],t))}onSingleSelectChange(t){this.valueChange.emit(t)}findName(t,e){let l=t;if(Array.isArray(l)&&l.length>0&&e==="user"){let o=this.CommonApiService.userData.filter(p=>l.includes(p.value));return this.filterForm.patchValue({user_array:o}),o}return[]}applyFilter(){let t=this.filterForm.value,e=this.commonFunction.removeBlankKeys(t),l=Object.keys(e).length>0;this.bottomSheetRef.dismiss({data:e,dismiss:l})}static \u0275fac=function(e){return new(e||r)(b(Q),b(Me),b(Ie),b(we),b(U),b(_e),b(z),b(He),b(ye))};static \u0275cmp=D({type:r,selectors:[["app-bottom-sheet"]],outputs:{valueChange:"valueChange"},decls:10,vars:17,consts:[[3,"title","headerClass"],[3,"ngSubmit","formGroup"],[1,"col-span-12","mb-4","xl:col-span-4","xxl:col-span-3"],["formControlName","user_ids","label","Sales User",3,"searchChanged","selectedChange","options","multiple","search"],["placeholder","Start Date","label","Start Date","formControlName","start_date",1,"form-control","custom-datepickr",3,"dateChange","fieldReq","max"],["placeholder","End Date","label","End Date","formControlName","end_date",1,"form-control","custom-datepickr",3,"min","max","fieldReq"],[1,"flex","items-center","justify-end","mt-4"],[3,"buttonType","buttonClass","label","iconClass","disabled","loadingIconClass"]],template:function(e,l){e&1&&(g(0,"app-modal-header",0),a(1,"form",1),f("ngSubmit",function(){return l.applyFilter()}),a(2,"div",2)(3,"spk-ng-select",3),f("searchChanged",function(p){return l.onSearch(p,"user")})("selectedChange",function(p){return l.onSingleSelectChange(p),l.findName(p,"user")}),i()(),a(4,"div",2)(5,"spk-flatpickr",4),f("dateChange",function(){return l.onDateChange()}),i()(),a(6,"div",2),g(7,"spk-flatpickr",5),i(),a(8,"div",6),g(9,"app-button",7),i()()),e&2&&(s("title","Filter")("headerClass","px-0 py-3"),n(),s("formGroup",l.filterForm),n(2),s("options",l.CommonApiService.userData)("multiple",!0)("search",!0),n(2),s("fieldReq",!1)("max",l.today),n(2),s("min",l.filterForm.value.start_date)("max",l.today)("fieldReq",!1),n(2),s("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("label","Apply Filter")("iconClass",l.api.disabled?"ri-loader-2-fill animate-spin":"ri-save-line")("disabled",l.api.disabled)("loadingIconClass","ri-loader-2-fill"))},dependencies:[F,xe,H,fe,Ce,ve,je,Ue,G,be,Ge,$,ke,Ye],encapsulation:2})};var gt=()=>["Check In"],xt=(r,t)=>({"xxl:col-span-9 lg:col-span-8":r,"xxl:col-span-12 lg:col-span-12":t}),Ct=(r,t,e)=>({name:r,label:t,icon:e}),vt=r=>[r],P=()=>[];function yt(r,t){if(r&1){let e=x();a(0,"div",30)(1,"input",31),S("ngModelChange",function(o){let p=d(e).$implicit;return w(p.checked,o)||(p.checked=o),_(o)}),f("ngModelChange",function(){d(e);let o=m(2);return _(o.setFilters("locations"))}),i(),a(2,"label",32),c(3),i(),a(4,"span",33),c(5),I(6,"number"),i()()}if(r&2){let e=t.$implicit;n(),s("id","Location-"+e._id),k("ngModel",e.checked),n(),s("for","Location-"+e._id),n(),C(" ",e.state||"--"," "),n(2),h(pe(6,5,e.count))}}function bt(r,t){r&1&&(a(0,"div")(1,"label",34),c(2," No data available! "),i()())}function kt(r,t){if(r&1){let e=x();a(0,"div",30)(1,"input",31),S("ngModelChange",function(o){let p=d(e).$implicit;return w(p.checked,o)||(p.checked=o),_(o)}),f("ngModelChange",function(){d(e);let o=m(2);return _(o.setFilters("customers"))}),i(),a(2,"label",32),c(3),i(),a(4,"span",33),c(5),i()()}if(r&2){let e=t.$implicit;n(),s("id","Customer-"+e._id),k("ngModel",e.checked),n(),s("for","Customer-"+e._id),n(),C(" ",e.customer_type_name||"--"," "),n(2),h(e.count)}}function wt(r,t){r&1&&(a(0,"div")(1,"label",34),c(2," No data available! "),i()())}function St(r,t){if(r&1){let e=x();a(0,"div",30)(1,"input",31),S("ngModelChange",function(o){let p=d(e).$implicit;return w(p.checked,o)||(p.checked=o),_(o)}),f("ngModelChange",function(){d(e);let o=m(2);return _(o.setFilters("beats"))}),i(),a(2,"label",32),c(3),i(),a(4,"span",33),c(5),i()()}if(r&2){let e=t.$implicit;n(),s("id","Beat-"+e._id),k("ngModel",e.checked),n(),s("for","Beat-"+e._id),n(),j(" ",e.beat_code||"--"," ",e.beat_code_desc||"--"," "),n(2),h(e.count)}}function Tt(r,t){r&1&&(a(0,"div")(1,"label",34),c(2," No data available! "),i()())}function Et(r,t){if(r&1){let e=x();a(0,"div",13)(1,"div",14)(2,"div",15)(3,"span",16),g(4,"i",17),i(),a(5,"div",18),c(6," Check In List "),a(7,"span",19),c(8),I(9,"date"),i()(),a(10,"button",20),f("click",function(){d(e);let o=ie(17);return _(o.open())}),c(11," Select "),g(12,"i",21),i(),a(13,"mat-form-field",22)(14,"input",23),S("ngModelChange",function(o){d(e);let p=m();return w(p.filter.activity_date,o)||(p.filter.activity_date=o),_(o)}),f("ngModelChange",function(){d(e);let o=m();return _(o.dateFilter())}),i(),g(15,"mat-datepicker-toggle",24)(16,"mat-datepicker",null,0),i()(),a(18,"div",25)(19,"div",26)(20,"h6",27),c(21,"State"),i(),a(22,"div",28),u(23,yt,7,7,"div",29),i(),u(24,bt,3,0,"div",12),i(),a(25,"div",26)(26,"h6",27),c(27,"Category"),i(),a(28,"div",28),u(29,kt,6,5,"div",29),i(),u(30,wt,3,0,"div",12),i(),a(31,"div",26)(32,"h6",27),c(33,"Beat"),i(),a(34,"div",28),u(35,St,6,6,"div",29),i(),u(36,Tt,3,0,"div",12),i()()()()}if(r&2){let e=ie(17),l=m();n(8),h(l.filter.activity_date?V(9,11,l.filter.activity_date,"dd MMM yyyy"):"Today"),n(6),s("matDatepicker",e)("max",l.today),k("ngModel",l.filter.activity_date),n(),s("for",e),n(8),s("ngForOf",l.locations),n(),s("ngIf",!(l.locations!=null&&l.locations.length)),n(5),s("ngForOf",l.customers),n(),s("ngIf",!(l.customers!=null&&l.customers.length)),n(5),s("ngForOf",l.beats),n(),s("ngIf",!(l.beats!=null&&l.beats.length))}}function Lt(r,t){if(r&1){let e=x();a(0,"app-listing-tab",35),f("tabChange",function(o){d(e);let p=m();return _(p.onTabChange(o.tab))}),i()}if(r&2){let e=t.$implicit,l=m();s("countShow",!1)("tabs",ce(7,vt,me(3,Ct,e.name,e.label,e.icon)))("activeTab",l.activeTab)}}function It(r,t){if(r&1){let e=x();a(0,"button",36),f("click",function(){d(e);let o=m();return _(o.openBottomSheet())}),g(1,"i",37),i()}}function Mt(r,t){if(r&1&&(a(0,"button",42),c(1),a(2,"span",43),c(3),i()()),r&2){let e=m().$implicit,l=m(2);s("ngClass",e.login_type_id===l.LOGIN_TYPES.PRIMARY?"bg-primary":e.login_type_id===l.LOGIN_TYPES.SUB_PRIMARY?"bg-primarytint1color":e.login_type_id===l.LOGIN_TYPES.SECONDARY?"bg-primarytint2color":e.login_type_id===l.LOGIN_TYPES.INFLUENCER?"bg-primarytint3color":"bg-secondary"),n(),C(" ",e.label," "),n(2),h(e.count)}}function Dt(r,t){if(r&1&&(v(0),u(1,Mt,4,3,"button",41),y()),r&2){let e=m(2);n(),s("ngIf",e.locationCount.length>0)}}function Vt(r,t){if(r&1&&(a(0,"app-showcode-card",38),u(1,Dt,2,1,"ng-container",39),g(2,"div",40),i()),r&2){let e=m();s("title","Map View")("titleView",!1)("view",!1)("refresBtnShow",!1)("logBtnShow",!1)("overallCountShow",!1),n(),s("ngForOf",e.locationCount)}}function Ft(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.name="",_(o.getDayList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function At(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.user_code="",_(o.getDayList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Bt(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.reporting_manager_name="",_(o.getDayList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Nt(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.customer_type_name="",_(o.getDayList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Ot(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.customer_name="",_(o.getDayList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Rt(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.remark="",_(o.getDayList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Pt(r,t){if(r&1){let e=x();a(0,"button",72),f("click",function(){d(e);let o=m().$implicit,p=m(3);return _(p.commonFunction.copy(o==null?null:o.start_location))}),a(1,"i",73),c(2,"content_copy"),i()()}}function Wt(r,t){if(r&1){let e=x();a(0,"button",72),f("click",function(){d(e);let o=m().$implicit,p=m(3);return _(p.commonFunction.copy(o==null?null:o.end_location))}),a(1,"i",73),c(2,"content_copy"),i()()}}function jt(r,t){if(r&1){let e=x();a(0,"button",72),f("click",function(){d(e);let o=m().$implicit,p=m(3);return _(p.commonFunction.copy(o==null?null:o.remark))}),a(1,"i",73),c(2,"content_copy"),i()()}}function Yt(r,t){if(r&1){let e=x();a(0,"tr",56)(1,"td",57),c(2),i(),a(3,"td",49)(4,"div",58)(5,"span",59),g(6,"img",60),i(),a(7,"div",61)(8,"span",62),c(9),i()()()(),a(10,"td"),c(11),i(),a(12,"td"),c(13),i(),a(14,"td"),c(15),i(),a(16,"td")(17,"div",61)(18,"span",62),c(19),i(),a(20,"span",63)(21,"span",64),c(22,"Mobile: "),i(),c(23),i()()(),a(24,"td"),c(25),I(26,"date"),i(),a(27,"td")(28,"span",65),c(29),i(),u(30,Pt,3,0,"button",66),i(),a(31,"td"),c(32),I(33,"date"),i(),a(34,"td")(35,"span",65),c(36),i(),u(37,Wt,3,0,"button",66),i(),a(38,"td"),c(39),i(),a(40,"td"),c(41),u(42,jt,3,0,"button",66),i(),a(43,"td"),c(44),i(),a(45,"td",67)(46,"i",68),f("click",function(){let o=d(e).$implicit,p=m(3);return _(!(o==null||o.checkinActivities==null)&&o.checkinActivities.order_id?p.goToDetailPage(o==null||o.checkinActivities==null?null:o.checkinActivities.order_id):"")}),c(47),i()(),a(48,"td",67)(49,"i",68),f("click",function(){let o=d(e).$implicit;return _(!(o==null||o.checkinActivities==null)&&o.checkinActivities.enquiry_id?"cursor-pointer":"")}),c(50),i()(),a(51,"td",67)(52,"i",69),c(53),i()(),a(54,"td",67)(55,"i",69),c(56),i()(),a(57,"td",67)(58,"i",70),c(59),i()(),a(60,"td",67)(61,"i",69),c(62),i()(),a(63,"td",67)(64,"i",71),c(65),i()(),a(66,"td",67)(67,"i",70),c(68),i()(),a(69,"td",67)(70,"i",71),c(71),i()()()}if(r&2){let e=t.$implicit,l=t.index;n(2),h(l+1),n(7),C(" ",(e.user_info==null?null:e.user_info.name)||"--",""),n(2),C(" ",(e.user_info==null?null:e.user_info.user_code)||"--",""),n(2),h((e.user_info==null?null:e.user_info.reporting_manager_name)||"--"),n(2),h((e.customer_details==null?null:e.customer_details.customer_type_name)||"--"),n(4),C(" ",(e.customer_details==null?null:e.customer_details.customer_name)||"--",""),n(4),C(" ",(e.customer_details==null?null:e.customer_details.mobile)||"--",""),n(2),h(e.visit_start?V(26,38,e.visit_start,"hh:mm a"):"---"),n(3),te("matTooltip",e.start_location),n(),h(e.start_location||"--"),n(),s("ngIf",e==null?null:e.start_location),n(2),h(e.visit_end?V(33,41,e.visit_end,"hh:mm a"):"---"),n(3),te("matTooltip",e.end_location),n(),h(e.end_location||"--"),n(),s("ngIf",e==null?null:e.end_location),n(2),h(e.avarage_meeting_time||"--"),n(2),C("",e.remark||"--"," "),n(),s("ngIf",e==null?null:e.remark),n(2),h(e.check_list||"--"),n(2),s("matTooltip",!(e==null||e.checkinActivities==null)&&e.checkinActivities.order_id?"View Detail":"")("ngClass",!(e==null||e.checkinActivities==null)&&e.checkinActivities.order_id?"text-success cursor-pointer":"text-danger"),n(),h(!(e==null||e.checkinActivities==null)&&e.checkinActivities.order_id?"visibility":"cancel"),n(2),s("matTooltip",!(e==null||e.checkinActivities==null)&&e.checkinActivities.enquiry_id?"View Detail":"")("ngClass",e.checkinActivities!=null&&e.checkinActivities.enquiry_id?"text-success":"text-danger"),n(),h(e.checkinActivities!=null&&e.checkinActivities.enquiry_id?"visibility":"cancel"),n(3),h(e.stock_audit?"visibility":"cancel"),n(3),h(e.photo_gallery?"visibility":"cancel"),n(2),s("matTooltip",!(e==null||e.checkinActivities==null)&&e.checkinActivities.followup_id?"View Detail":"")("ngClass",e.checkinActivities!=null&&e.checkinActivities.followup_id?"text-success":"text-danger"),n(),h(e.checkinActivities!=null&&e.checkinActivities.followup_id?"visibility":"cancel"),n(3),h(e.payment_collection?"visibility":"cancel"),n(2),s("ngClass",e.branding_audit?"text-success":"text-danger"),n(),h(e.branding_audit?"visibility":"cancel"),n(2),s("matTooltip",!(e==null||e.checkinActivities==null)&&e.checkinActivities.popgift_id?"View Detail":"")("ngClass",e.checkinActivities!=null&&e.checkinActivities.popgift_id?"text-success":"text-danger"),n(),h(e.checkinActivities!=null&&e.checkinActivities.popgift_id?"visibility":"cancel"),n(2),s("ngClass",e.support_ticket?"text-success":"text-danger"),n(),h(e.support_ticket?"visibility":"cancel")}}function qt(r,t){if(r&1){let e=x();v(0),a(1,"tr",48)(2,"td"),c(3,"\xA0"),i(),a(4,"td",49)(5,"div",50)(6,"mat-form-field",51)(7,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.name,o)||(p.filter.name=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getDayList())}),i(),u(8,Ft,3,0,"button",53),i()()(),a(9,"td")(10,"div",50)(11,"mat-form-field",51)(12,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.user_code,o)||(p.filter.user_code=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getDayList())}),i(),u(13,At,3,0,"button",53),i()()(),a(14,"td")(15,"div",50)(16,"mat-form-field",51)(17,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.reporting_manager_name,o)||(p.filter.reporting_manager_name=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getDayList())}),i(),u(18,Bt,3,0,"button",53),i()()(),a(19,"td")(20,"div",50)(21,"mat-form-field",51)(22,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.customer_type_name,o)||(p.filter.customer_type_name=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getDayList())}),i(),u(23,Nt,3,0,"button",53),i()()(),a(24,"td")(25,"div",50)(26,"mat-form-field",51)(27,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.customer_name,o)||(p.filter.customer_name=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getDayList())}),i(),u(28,Ot,3,0,"button",53),i()()(),a(29,"td"),c(30,"\xA0"),i(),a(31,"td"),c(32,"\xA0"),i(),a(33,"td"),c(34,"\xA0"),i(),a(35,"td"),c(36,"\xA0"),i(),a(37,"td"),c(38,"\xA0"),i(),a(39,"td")(40,"div",50)(41,"mat-form-field",51)(42,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.remark,o)||(p.filter.remark=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getDayList())}),i(),u(43,Rt,3,0,"button",53),i()()(),a(44,"td"),c(45,"\xA0"),i(),a(46,"td"),c(47,"\xA0"),i(),a(48,"td"),c(49,"\xA0"),i(),a(50,"td"),c(51,"\xA0"),i(),a(52,"td"),c(53,"\xA0"),i(),a(54,"td"),c(55,"\xA0"),i(),a(56,"td"),c(57,"\xA0"),i(),a(58,"td"),c(59,"\xA0"),i(),a(60,"td"),c(61,"\xA0"),i(),a(62,"td"),c(63,"\xA0"),i()(),u(64,Yt,72,44,"tr",54),y()}if(r&2){let e=m(2);n(7),k("ngModel",e.filter.name),n(),L(e.filter.name?8:-1),n(4),k("ngModel",e.filter.user_code),n(),L(e.filter.user_code?13:-1),n(4),k("ngModel",e.filter.reporting_manager_name),n(),L(e.filter.reporting_manager_name?18:-1),n(4),k("ngModel",e.filter.customer_type_name),n(),L(e.filter.customer_type_name?23:-1),n(4),k("ngModel",e.filter.customer_name),n(),L(e.filter.customer_name?28:-1),n(14),k("ngModel",e.filter.remark),n(),L(e.filter.remark?43:-1),n(21),s("ngForOf",e.listingData)}}function Gt(r,t){r&1&&(a(0,"td"),g(1,"app-skeleton"),i()),r&2&&(n(),A("h20 bg-skeleton"))}function zt(r,t){r&1&&(a(0,"tr",48),u(1,Gt,2,2,"td",39),i()),r&2&&(n(),s("ngForOf",B(1,P).constructor(22)))}function Ht(r,t){r&1&&(v(0),u(1,zt,2,2,"tr",74),y()),r&2&&(n(),s("ngForOf",B(1,P).constructor(8)))}function Ut(r,t){r&1&&(v(0),g(1,"app-data-not-found"),y())}function $t(r,t){if(r&1){let e=x();a(0,"app-showcode-card",44),f("filterClick",function(){d(e);let o=m();return _(o.openBottomSheet())})("refresh",function(){d(e);let o=m();return _(o.onRefresh("Today"))}),a(1,"div",45)(2,"spk-reusable-tables",46),u(3,qt,65,13,"ng-container",12)(4,Ht,2,2,"ng-container",12),i(),u(5,Ut,2,0,"ng-container",12),i(),a(6,"app-pagination-footer",47),f("preButtonClick",function(){d(e);let o=m();return _(o.changeToPagination("Previous"))})("nextButtonClick",function(){d(e);let o=m();return _(o.changeToPagination("Next"))})("pageChange",function(o){d(e);let p=m();return _(p.changeToPage(o))}),i()()}if(r&2){let e=m();s("title","Today")("titleView",!0)("boxHeader","pt-1 pb-0")("classbody","pt-1")("overallCountShow",e.pagination.total>0)("overallCount",e.pagination.total)("filterBtnShow",!1)("refresBtnShow",!0),n(2),s("tableHead","border-b")("showCheckbox",!1)("showS_No",!0)("showSorting",!1)("showFilterRow",!1)("showAction",!1)("columns",e.PageHeaders),n(),s("ngIf",!e.skLoading),n(),s("ngIf",e.skLoading),n(),s("ngIf",!(e.listingData!=null&&e.listingData.length)&&!e.skLoading),n(),s("currentPage",e.pagination.cur_page)("totalPage",e.pagination.total_pages)("pageLimit",e.pagination.limit)("listLength",e.listingData.length)("preBtn",!e.pagination.prev)("nextBtn",!e.pagination.next)}}function Kt(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.name="",_(o.getMonthList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Jt(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.user_code="",_(o.getMonthList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Qt(r,t){if(r&1){let e=x();a(0,"button",55),f("click",function(){d(e);let o=m(3);return o.filter.reporting_manager_name="",_(o.getMonthList())}),a(1,"mat-icon"),c(2,"close"),i()()}}function Xt(r,t){if(r&1&&(a(0,"td",81)(1,"span",78),c(2),i()()),r&2){let e=t.$implicit;n(2),h(e)}}function Zt(r,t){if(r&1&&(v(0),u(1,Xt,3,1,"td",80),y()),r&2){let e=m(3);n(),s("ngForOf",e.monthColumnTotals)}}function ei(r,t){if(r&1){let e=x();v(0),a(1,"td",67)(2,"span",87),f("click",function(){let o=d(e).$implicit,p=m().$implicit,E=m(3);return _(o!=null&&o.count?E.monthViewFilter(o.startDate,p._id):"")}),c(3),i()(),y()}if(r&2){let e=t.$implicit;n(2),s("ngClass",e!=null&&e.count?"font-semibold text-primary underline cursor-pointer":""),n(),h(e==null?null:e.count)}}function ti(r,t){if(r&1&&(a(0,"tr",82)(1,"td",57),c(2),i(),a(3,"td",49),c(4),i(),a(5,"td",83),c(6),i(),a(7,"td",61),c(8),i(),a(9,"td",84),c(10),i(),a(11,"td",85),c(12),i(),a(13,"td",86),c(14),i(),u(15,ei,4,2,"ng-container",39),i()),r&2){let e=t.$implicit,l=t.index;n(2),h(l+1),n(2),h((e==null?null:e.name)||"--"),n(2),h((e==null?null:e.user_code)||"--"),n(2),C("",(e==null?null:e.reporting_manager_name)||"--"," "),n(2),C("",(e==null?null:e.total_checkin)||"0"," "),n(2),C("",(e==null?null:e.productive)||"0"," "),n(2),C("",(e==null?null:e.new_counter)||"0"," "),n(),s("ngForOf",e.month)}}function ii(r,t){if(r&1){let e=x();v(0),a(1,"tr")(2,"td"),c(3,"\xA0"),i(),a(4,"td",77)(5,"div",50)(6,"mat-form-field",51)(7,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.name,o)||(p.filter.name=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getMonthList())}),i(),u(8,Kt,3,0,"button",53),i()()(),a(9,"td",57)(10,"div",50)(11,"mat-form-field",51)(12,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.user_code,o)||(p.filter.user_code=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getMonthList())}),i(),u(13,Jt,3,0,"button",53),i()()(),a(14,"td",57)(15,"div",50)(16,"mat-form-field",51)(17,"input",52),S("ngModelChange",function(o){d(e);let p=m(2);return w(p.filter.reporting_manager_name,o)||(p.filter.reporting_manager_name=o),_(o)}),f("keyup.enter",function(){d(e);let o=m(2);return _(o.getMonthList())}),i(),u(18,Qt,3,0,"button",53),i()()(),a(19,"td",67)(20,"span",78),c(21),i()(),a(22,"td",67)(23,"span",78),c(24),i()(),a(25,"td",67)(26,"span",78),c(27),i()(),u(28,Zt,2,1,"ng-container",12),i(),u(29,ti,16,8,"tr",79),y()}if(r&2){let e=m(2);n(7),k("ngModel",e.filter.name),n(),L(e.filter.name?8:-1),n(4),k("ngModel",e.filter.user_code),n(),L(e.filter.user_code?13:-1),n(4),k("ngModel",e.filter.reporting_manager_name),n(),L(e.filter.reporting_manager_name?18:-1),n(3),h(e.monthTotals.total_checkin||0),n(3),h(e.monthTotals.productive||0),n(3),h(e.monthTotals.new_counter||0),n(),s("ngIf",e.monthReadData==null?null:e.monthReadData.length),n(),s("ngForOf",e.monthReadData)}}function ni(r,t){r&1&&(a(0,"td"),g(1,"app-skeleton"),i()),r&2&&(n(),A("h20 bg-skeleton"))}function ai(r,t){if(r&1&&(a(0,"tr",48),u(1,ni,2,2,"td",39),i()),r&2){let e=m(3);n(),s("ngForOf",e.monthListColumn)}}function oi(r,t){r&1&&(v(0),u(1,ai,2,1,"tr",74),y()),r&2&&(n(),s("ngForOf",B(1,P).constructor(8)))}function ri(r,t){r&1&&(v(0),g(1,"app-data-not-found"),y())}function li(r,t){if(r&1){let e=x();a(0,"app-showcode-card",75),f("monthChanged",function(o){d(e);let p=m();return _(p.getMonthList(o))})("filterClick",function(){d(e);let o=m();return _(o.openBottomSheet())})("refresh",function(){d(e);let o=m();return _(o.onRefresh("Month"))}),a(1,"div",45)(2,"spk-reusable-tables",76),u(3,ii,30,11,"ng-container",12)(4,oi,2,2,"ng-container",12),i(),u(5,ri,2,0,"ng-container",12),i()()}if(r&2){let e=m();s("title","Month")("classbody","pt-0")("titleView",!0)("refresBtnShow",!0)("overallCountShow",e.pagination.total>0)("filterMonth",!0)("max",e.maxMonth)("selectedMonth",e.selectedMonth)("overallCount",e.pagination.total)("filterBtnShow",!1)("refresBtnShow",!0),n(2),s("showCheckbox",!1)("showS_No",!0)("showAction",!1)("showFooter",!1)("columns",e.monthListColumn),n(),s("ngIf",!e.monthSkLoading),n(),s("ngIf",e.monthSkLoading),n(),s("ngIf",!e.monthSkLoading&&(e.monthReadData==null?null:e.monthReadData.length)===0)}}function ci(r,t){r&1&&(a(0,"div",89),g(1,"app-skeleton"),i()),r&2&&(n(),A("wp100 h40 mb-3"))}function si(r,t){r&1&&(v(0),u(1,ci,2,2,"div",88),y()),r&2&&(n(),s("ngForOf",B(1,P).constructor(8)))}function mi(r,t){if(r&1&&(v(0),g(1,"app-timeline",90),y()),r&2){let e=m(2);n(),s("listingData",e.listingData)}}function pi(r,t){if(r&1&&(v(0),u(1,si,2,2,"ng-container",12)(2,mi,2,1,"ng-container",12),y()),r&2){let e=m();n(),s("ngIf",e.skLoading),n(),s("ngIf",!e.skLoading)}}function di(r,t){r&1&&(a(0,"div",89),g(1,"app-skeleton"),i()),r&2&&(n(),A("wp100 h40 mb-3"))}function _i(r,t){r&1&&(v(0),u(1,di,2,2,"div",88),y()),r&2&&(n(),s("ngForOf",B(1,P).constructor(8)))}function ui(r,t){if(r&1&&(v(0),g(1,"app-analytics",91),y()),r&2){let e=m(3);n(),s("analyticsData",e.analyticsData)("chartData",e.chartData)}}function hi(r,t){if(r&1&&(v(0),u(1,ui,2,2,"ng-container",12),y()),r&2){let e=m(2);n(),s("ngIf",e.analyticsReqSent&&e.chartReqSent)}}function fi(r,t){if(r&1&&(v(0),u(1,_i,2,2,"ng-container",12)(2,hi,2,1,"ng-container",12),y()),r&2){let e=m();n(),s("ngIf",e.skLoading),n(),s("ngIf",!e.skLoading)}}var et=class r{constructor(t,e,l,o,p){this.api=t;this.router=e;this.commonFunction=l;this.dateService=o;this.bottomSheet=p}activeTab="Today";monthDaysData=[];monthListColumn=[];viewDatepicker=!1;pagination={};markerLayer=T.layerGroup();LOGIN_TYPES;selectedMonth;ngOnInit(){this.LOGIN_TYPES=M,this.getActivityFilters(),this.getDayList();let t=new Date,e=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0");this.selectedMonth=`${e}-${l}`,this.maxMonth=`${e}-${l}`}dateFilter(){this.activeTab==="Analytics"?(this.getAnalytics(),this.getChartData()):this.getDayList()}onDateChange(t,e){if(e){let l=this.dateService.formatToYYYYMMDD(e);this.filter[t]=l}else this.filter[t]=null;this.filter.created_at&&this.getDayList()}onTabChange(t){this.activeTab=t,this.filter={},this.activeTab==="Month"?this.getMonthList():this.activeTab==="Analytics"?(this.getAnalytics(),this.getChartData()):this.getDayList()}onRefresh(t){this.filter={},t==="Today"&&this.getDayList(),t==="Month"&&(this.generateMonthDates(),this.selectedMonth=this.selectedMonth,this.getMonthList(this.selectedMonth))}today=new Date;monthDate=[];generateMonthDates(){let t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=this.monthDate||[];this.monthListColumn=[{label:"Employee Name",value:"Employee Name",table_class:"sticky-col"},{label:"Employee Code",value:"Employee Code"},{label:"Reporting Manager",value:"Reporting Manager"},{label:"Total CheckIn",value:"Total CheckIn",table_class:"text-center"},{label:"Productive",value:"Productive",table_class:"text-center"},{label:"New Counter",value:"New Counter",table_class:"text-center"},...e.map(l=>{let o=new Date(l.startDate),p=o.getDate(),E=t[o.getMonth()],W=o.getFullYear(),R=`${p} ${E} ${W}`;return{label:R,value:R}})]}checkinStatuses=[{icon:"ri-map-pin-fill",color:"text-info",label:"Enquiry"},{icon:"ri-map-pin-fill",color:"text-success",label:"Primary"},{icon:"ri-map-pin-fill",color:"text-secondary",label:"Secondary"},{icon:"ri-map-pin-fill",color:"text-warning",label:"Site"}];PageHeaders=[{label:"Employee Name",name:"employee_name",table_class:"sticky-col"},{label:"Employee Code",name:"employee_code"},{label:"Reporting Manager",name:"reporting_manager_name"},{label:"Customer Type",name:"type"},{label:"Company Name",name:"company_name"},{label:"Check In",name:"check_in"},{label:"Start Location",name:"start_location"},{label:"Check Out",name:"check_out"},{label:"End Location",name:"end_location"},{label:"Total Time Spend",name:"total_time_spend"},{label:"Remark",name:"remark"},{label:"Topic Of Discussion",name:"check_list"},{label:"Order",name:"order"},{label:"Enquiry",name:"enquiry"},{label:"Stock Audit",name:"stock_audit"},{label:"Photo Gallery",name:"photo_gallery"},{label:"Follow Up",name:"follow_up"},{label:"Payment Collection",name:"payment_collection"},{label:"Branding Audit",name:"branding_audit"},{label:"Pop Distribution",name:"pop_distribution"},{label:"Support Ticket",name:"support_ticket"}];locations=[];customers=[];beats=[];teamMembers=[];mainTabs=[{name:"Today",label:"Today",icon:"ri-layout-vertical-line"},{name:"Month",label:"Month",icon:"ri-calendar-line"},{name:"Map View",label:"Map View",icon:"ri-map-pin-line"},{name:"Timeline",label:"Timeline",icon:"ri-timeline-view"},{name:"Analytics",label:"Analytics",icon:"ri-bar-chart-line"}];skLoading=!1;filter={};listingData=[];locationCount=[];page=1;getDayList(){this.skLoading=!0;let t={};t.activeTab=this.activeTab,this.filter.activity_date&&(this.filter.activity_date=this.dateService.formatToYYYYMMDD(this.filter.activity_date)),t.filters=this.filter,t.page=this.page,t=this.commonFunction.removeBlankKeys(t),this.api.post(t,"activity/read").subscribe(e=>{e.statusCode===200&&(this.skLoading=!1,this.listingData=e?.data?.result??[],this.locationCount=e?.data?.count_summary??[],this.pagination=e.pagination,this.activeTab=="Map View"&&this.initializeMap())},e=>{this.skLoading=!1})}changeToPage(t){this.pagination.cur_page=t,this.getDayList()}changeToPagination(t){t==="Next"&&this.pagination.cur_page<this.pagination.total_pages?this.pagination.cur_page++:t==="Previous"&&this.pagination.cur_page>1&&this.pagination.cur_page--,this.getDayList()}map;initializeMap(){this.map=T.map("map").setView([28.6139,77.209],12),T.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.addMarkersToMap()}addMarkersToMap(){this.map&&(this.markerLayer&&this.map.removeLayer(this.markerLayer),this.markerLayer=T.layerGroup(),this.listingData.forEach(t=>{let e=parseFloat(t.start_lat),l=parseFloat(t.start_lng);if(!isNaN(e)&&!isNaN(l)){let o="location_on",p="text-secondary";t?.customer_details?.login_type_id===M.PRIMARY?p="text-primary":t?.customer_details?.login_type_id===M.SUB_PRIMARY?p="text-primarytint1color":t?.customer_details?.login_type_id===M.SECONDARY?p="text-primarytint2color":t?.customer_details?.login_type_id===M.INFLUENCER&&(p="text-primarytint3color");let E=t.zoomLevel>=15?6:3,W=T.divIcon({html:`<i class="material-icons ${p}" style="font-size: ${E}rem !important;">${o}</i>`,iconSize:[E,E],iconAnchor:[E/2,E],className:""}),R=T.marker([e,l],{icon:W}).bindPopup(`
                        <b>Customer Name:</b> ${t.customer_details?.customer_name||"N/A"}<br>
                        <b>Location:</b> ${t?.start_location||"N/A"}
                        `);this.markerLayer.addLayer(R)}}),this.markerLayer.addTo(this.map))}maxMonth;monthViewFilter(t,e){this.filter.activity_date=t,this.activeTab="Timeline",this.teamMembers.map(l=>{e==l._id?l.checked=!0:l.checked=!1}),this.setFilters("teamMembers")}monthReadData=[];monthSkLoading=!1;monthTotals={new_counter:0,productive:0,total_checkin:0};getMonthList(t){this.monthSkLoading=!0;let e={};delete this.filter.activity_date,delete this.filter.activeTab,delete this.filter.page,e.filters=this.filter,e.activeTab=this.activeTab,e.page=this.page,t&&(e.month=t.split("-")[1],e.year=t.split("-")[0]),e.activity_date=null,e=this.commonFunction.removeBlankKeys(e),this.api.post(e,"activity/month-read").subscribe(l=>{l.statusCode===200&&(this.monthSkLoading=!1,this.monthReadData=l.data,this.monthDate=this.monthReadData[0].month,this.generateMonthDates(),this.pagination=l.pagination,this.calculateMonthTotals(),this.calculateMonthColumnTotals())},l=>{this.monthSkLoading=!1})}monthColumnTotals=[];calculateMonthColumnTotals(){if(!this.monthReadData?.length)return;let t=this.monthReadData[0].month.length;this.monthColumnTotals=Array(t).fill(0),this.monthReadData.forEach(e=>{e.month.forEach((l,o)=>{this.monthColumnTotals[o]+=l?.count||0})})}calculateMonthTotals(){this.monthTotals=this.monthReadData?.reduce((t,e)=>(t.new_counter+=e?.new_counter||0,t.productive+=e?.productive||0,t.total_checkin+=e?.total_checkin||0,t),{new_counter:0,productive:0,total_checkin:0})}getActivityFilters(){this.api.post({},"activity/today-visit-data").subscribe(t=>{t.statusCode===200&&(this.customers=t.data?.today_visit_customer_types,this.beats=t.data?.today_visit_beats,this.teamMembers=t.data?.today_visitors,this.locations=t.data?.todays_visit_states)},t=>{})}analyticsData={};analyticsReqSent=!1;getAnalytics(){this.skLoading=!0,this.analyticsReqSent=!1;let t={};t=this.filter,t.activeTab=this.activeTab,t.page=this.page,t=this.commonFunction.removeBlankKeys(t),this.api.post(t,"activity/anyalytics").subscribe(e=>{e.statusCode===200&&(this.skLoading=!1,this.analyticsReqSent=!0,this.analyticsData=e.data)},e=>{this.analyticsReqSent=!0})}chartData=[];chartReqSent=!1;getChartData(){this.chartReqSent=!1;let t={};t=this.filter,t.activeTab=this.activeTab,t.page=this.page,t=this.commonFunction.removeBlankKeys(t),this.api.post(t,"activity/n-days-data").subscribe(e=>{e.statusCode===200&&(this.chartReqSent=!0,this.chartData=e.data)},e=>{this.chartReqSent=!0})}setFilters(t){this.filter.customer_type_name=[],this.filter.user_id=[],this.filter.state=[],this.filter.beat_code=[],t=="customers"&&(this.teamMembers.map(e=>{e.checked=!1}),this.locations.map(e=>{e.checked=!1}),this.beats.map(e=>{e.checked=!1}),this.customers.map(e=>{e.checked&&this.filter.customer_type_name.push(e.customer_type_name)})),t=="teamMembers"&&(this.locations.map(e=>{e.checked=!1}),this.customers.map(e=>{e.checked=!1}),this.beats.map(e=>{e.checked=!1}),this.teamMembers.map(e=>{e.checked&&this.filter.user_id.push(e._id)})),t=="locations"&&(this.teamMembers.map(e=>{e.checked=!1}),this.customers.map(e=>{e.checked=!1}),this.beats.map(e=>{e.checked=!1}),this.locations.map(e=>{e.checked&&this.filter.state.push(e.state)})),t=="beats"&&(this.teamMembers.map(e=>{e.checked=!1}),this.locations.map(e=>{e.checked=!1}),this.customers.map(e=>{e.checked=!1}),this.beats.map(e=>{e.checked&&this.filter.beat_code.push(e.beat_code)})),this.onTabChange(this.activeTab)}resetFilters(){this.teamMembers.map(t=>{t.checked=!1}),this.locations.map(t=>{t.checked=!1}),this.beats.map(t=>{t.checked=!1}),this.customers.map(t=>{t.checked=!1}),this.filter.activity_date=null}openBottomSheet(){this.bottomSheet.open(ee,{data:{message:"Hello from parent",id:123}}).afterDismissed().subscribe(t=>{t.dismiss&&this.activeTab==="Timeline"&&(this.filter.start_date=this.dateService.formatToYYYYMMDD(t?.data?.start_date),this.filter.end_date=this.dateService.formatToYYYYMMDD(t?.data?.end_date),this.filter.user_ids=t?.data?.user_ids,this.getDayList()),console.log("Data returned from bottom sheet:",t)})}goToDetailPage(t){this.router.navigate(["/apps/order/primary-order/primary-order-detail/",t])}static \u0275fac=function(e){return new(e||r)(b(U),b(z),b(Q),b(Pe),b(De))};static \u0275cmp=D({type:r,selectors:[["app-checkin-list"]],decls:13,vars:16,consts:[["picker",""],[3,"title","title1","activeitem"],[1,"grid","grid-cols-12","gap-x-3"],["class","xxl:col-span-3 lg:col-span-4 col-span-12",4,"ngIf"],[1,"col-span-12",3,"ngClass"],[1,"box","py-3","mb-2","px-4"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[3,"countShow","tabs","activeTab","tabChange",4,"ngFor","ngForOf"],["type","button","class","ti-btn-sm !py-1 btn ti-btn ti-btn-soft-primary left-auto",3,"click",4,"ngIf"],[3,"title","titleView","view","refresBtnShow","logBtnShow","overallCountShow",4,"ngIf"],[3,"title","titleView","boxHeader","classbody","overallCountShow","overallCount","filterBtnShow","refresBtnShow","filterClick","refresh",4,"ngIf"],[3,"title","classbody","titleView","refresBtnShow","overallCountShow","filterMonth","max","selectedMonth","overallCount","filterBtnShow","monthChanged","filterClick","refresh",4,"ngIf"],[4,"ngIf"],[1,"xxl:col-span-3","lg:col-span-4","col-span-12"],[1,"box","products-navigation-card"],[1,"box-header","gap-2","items-center","pb-3","border-b","border-dashed","border-defaultborder","dark:border-defaultborder/10"],[1,"avatar","avatar-md","bg-primary","avatar-rounded"],[1,"ri-map-pin-user-line","text-[1.25rem]"],[1,"box-title"],[1,"text-textmuted","dark:text-textmuted/50","block","text-xs"],["matTooltip","Select Date",1,"ti-btn","ti-btn-sm","ti-btn-soft-primary","ms-auto","!rounded-full",3,"click"],[1,"ri-calendar-line"],[2,"visibility","hidden","height","0px"],["matInput","","name","activity_date","placeholder","Select Date",3,"ngModelChange","matDatepicker","max","ngModel"],["matIconSuffix","",3,"for"],[1,"box-body","p-0"],[1,"p-4","border-b","dark:border-defaultborder/10"],[1,"font-medium","mb-0"],[1,"px-0","py-3","pb-0","scroll-y-200"],["class","form-check mb-2 !flex items-center",4,"ngFor","ngForOf"],[1,"form-check","mb-2","!flex","items-center"],["type","checkbox","name","",1,"form-check-input","me-2",3,"ngModelChange","id","ngModel"],[1,"form-check-label","!ps-0","text11px","font-normal",3,"for"],[1,"badge","bg-light","text-defaulttextcolor","float-end","ms-auto"],[1,"form-check-label","!ps-0","text11px","font-normal"],[3,"tabChange","countShow","tabs","activeTab"],["type","button",1,"ti-btn-sm","!py-1","btn","ti-btn","ti-btn-soft-primary","left-auto",3,"click"],[1,"ri-filter-line","font-medium","align-middle"],[3,"title","titleView","view","refresBtnShow","logBtnShow","overallCountShow"],[4,"ngFor","ngForOf"],["id","map",2,"height","400px","width","100%"],["type","button","class","ti-btn text-white my-1 me-2 cursor-text",3,"ngClass",4,"ngIf"],["type","button",1,"ti-btn","text-white","my-1","me-2","cursor-text",3,"ngClass"],[1,"badge","ms-2","bg-dark/10"],[3,"filterClick","refresh","title","titleView","boxHeader","classbody","overallCountShow","overallCount","filterBtnShow","refresBtnShow"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"tableHead","showCheckbox","showS_No","showSorting","showFilterRow","showAction","columns"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"sticky-col"],[1,"table-search-filters"],[1,"table-input"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"flex","items-center","gap-2"],[1,"avatar","avatar-sm","avatar-rounded"],["src","./assets/images/faces/12.jpg","alt",""],[1,""],[1,"block","font-medium"],[1,"block"],[1,"text-textmuted","dark:text-textmuted/50","text-[11px]"],[1,"ellipsis",3,"matTooltip"],["class","copy-btn","matTooltip","Copy To Clipboard",3,"click",4,"ngIf"],[1,"text-center"],[1,"material-icons","inline-block",3,"click","matTooltip","ngClass"],[1,"material-icons","inline-block"],[1,"material-icons","inline-block",3,"matTooltip","ngClass"],[1,"material-icons","inline-block",3,"ngClass"],["matTooltip","Copy To Clipboard",1,"copy-btn",3,"click"],[1,"material-icons"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[3,"monthChanged","filterClick","refresh","title","classbody","titleView","refresBtnShow","overallCountShow","filterMonth","max","selectedMonth","overallCount","filterBtnShow"],["tableClass","ti-custom-table text-nowrap ti-custom-table-hover",3,"showCheckbox","showS_No","showAction","showFooter","columns"],[1,"!text-center","sticky-col"],[1,"font-bold","text-[.9375rem]"],["class","todo-box border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],["class","text-center font-semibold",4,"ngFor","ngForOf"],[1,"text-center","font-semibold"],[1,"todo-box","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"w150"],[1,"w100","text-center","bg-secondary","text-white"],[1,"w100","text-center","bg-success","text-white"],[1,"w100","text-center","bg-warning","text-white"],[3,"click","ngClass"],["class","xl:col-span-12 col-span-12",4,"ngFor","ngForOf"],[1,"xl:col-span-12","col-span-12"],[3,"listingData"],[3,"analyticsData","chartData"]],template:function(e,l){e&1&&(g(0,"app-page-header",1),a(1,"div",2),u(2,Et,37,14,"div",3),a(3,"div",4)(4,"div",5)(5,"nav",6),u(6,Lt,1,9,"app-listing-tab",7)(7,It,2,0,"button",8),i()(),u(8,Vt,3,7,"app-showcode-card",9)(9,$t,7,24,"app-showcode-card",10)(10,li,6,19,"app-showcode-card",11)(11,pi,3,2,"ng-container",12)(12,fi,3,2,"ng-container",12),i()()),e&2&&(s("title","SFA")("title1",B(12,gt))("activeitem","Check In List"),n(2),s("ngIf",l.activeTab==="Today"),n(),s("ngClass",se(13,xt,l.activeTab==="Today",l.activeTab!=="Today")),n(3),s("ngForOf",l.mainTabs),n(),s("ngIf",l.activeTab==="Timeline"),n(),s("ngIf",l.activeTab==="Map View"),n(),s("ngIf",l.activeTab==="Today"),n(),s("ngIf",l.activeTab==="Month"),n(),s("ngIf",l.activeTab==="Timeline"),n(),s("ngIf",l.activeTab==="Analytics"))},dependencies:[$,Ve,Be,Ne,Oe,Fe,Ae,Le,Ee,F,Y,N,O,he,ue,H,ge,Ke,Se,K,qe,ze,Re,de,q,G,J,X,Z,We],encapsulation:2})};export{et as CheckinListComponent};
