import{a as Se}from"./chunk-J4NDCUAB.js";import{a as ve}from"./chunk-REKAXM5L.js";import{a as be}from"./chunk-SQZ3YN6N.js";import{c as he}from"./chunk-CIBZCVJQ.js";import{a as fe}from"./chunk-OTFCGVEU.js";import{a as ue}from"./chunk-HPLI5COI.js";import{a as me}from"./chunk-OEHD5D2Y.js";import{a as Ce}from"./chunk-GLWQGYBC.js";import{a as X}from"./chunk-DC4QM32I.js";import{F as ge,c as U,q as pe,s as _e,u as de}from"./chunk-VHE3PQ3O.js";import{$ as Q,Aa as ee,B as q,Ea as te,G as z,Ga as ie,Ha as ne,Ia as oe,Ja as ae,Qa as re,W as J,Z as K,Za as ce,_ as we,hb as le,jb as se,va as Z,w as Y,wa as $,z as G}from"./chunk-GYDYF5F3.js";import{M as H,f as W,g as R,o as N,t as j}from"./chunk-PD5VTTIY.js";import{Aa as p,Ba as _,Bc as B,Hb as P,Lc as k,Mc as d,Nc as S,Ob as u,Oc as I,Uc as x,Vc as y,Wc as L,Yc as w,Zc as A,_b as s,ad as O,bc as T,ed as E,fc as M,gd as D,kc as l,lc as c,mc as b,nc as h,oc as C,qc as v,rb as r,sb as f,wc as g,yc as m}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{g as Le}from"./chunk-66YHNWRR.js";var ye=Le(we());var Te=()=>["Scheme"],V=()=>[],Me=(n,o,e,i)=>({name:n,label:o,icon:e,count:i}),ke=n=>[n];function Ee(n,o){n&1&&b(0,"app-skeleton"),n&2&&T("w100 h25")}function De(n,o){n&1&&(h(0),u(1,Ee,1,2,"app-skeleton",13),C()),n&2&&(r(),s("ngForOf",w(1,V).constructor(2)))}function Ie(n,o){if(n&1){let e=v();l(0,"app-listing-tab",15),g("tabChange",function(t){p(e);let a=m(2);return _(a.onTabChange(t.tab))}),c()}if(n&2){let e=o.$implicit,i=m(2);s("tabs",A(7,ke,O(2,Me,e.name,e.label,e.icon,e.count)))("activeTab",i.activeTab)}}function Ve(n,o){if(n&1&&(h(0),u(1,Ie,1,9,"app-listing-tab",14),C()),n&2){let e=m();r(),s("ngForOf",e.mainTabs)}}function Fe(n,o){if(n&1){let e=v();l(0,"button",26),g("click",function(){p(e);let t=m(2);return t.filter.created_name="",_(t.getList())}),l(1,"mat-icon"),d(2,"close"),c()()}}function Pe(n,o){if(n&1){let e=v();l(0,"button",26),g("click",function(){p(e);let t=m(2);return t.filter.scheme_id="",_(t.getList())}),l(1,"mat-icon"),d(2,"close"),c()()}}function Be(n,o){if(n&1){let e=v();l(0,"button",26),g("click",function(){p(e);let t=m(2);return t.filter.product_details="",_(t.getList())}),l(1,"mat-icon"),d(2,"close"),c()()}}function Ae(n,o){if(n&1&&(h(0),l(1,"a",35),d(2),c(),C()),n&2){let e=m(2).$implicit;r(2),I(" +",e.product_data.length-1," ")}}function Oe(n,o){if(n&1&&(h(0),l(1,"span",34),d(2),u(3,Ae,3,1,"ng-container",6),c(),C()),n&2){let e=m().$implicit;r(2),I(" ",(e.product_data[0]==null?null:e.product_data[0].product_name)||"--"," "),r(),s("ngIf",e.product_data.length>1)}}function We(n,o){n&1&&(h(0),d(1," -- "),C())}function Re(n,o){if(n&1){let e=v();l(0,"tr",27)(1,"td",28),d(2),c(),l(3,"td"),d(4),E(5,"date"),c(),l(6,"td"),d(7),c(),l(8,"td")(9,"a",29),g("click",function(){let t=p(e).$implicit,a=m(2);return _(a.goToDetailPage(t._id))}),d(10),c()(),l(11,"td"),d(12),E(13,"date"),c(),l(14,"td"),d(15),E(16,"date"),c(),l(17,"td"),u(18,Oe,4,2,"ng-container",6)(19,We,2,0,"ng-container",6),c(),l(20,"td")(21,"span",30),d(22),c()(),l(23,"td")(24,"span",31)(25,"app-toggle",32),g("checkedChange",function(t){let a=p(e).$implicit,F=m(2);return _(F.onToggleChange(t,a._id,a.status))}),c()()(),l(26,"td",28)(27,"app-icon-button",33),g("clickEvent",function(){let t=p(e).$implicit,a=m(2);return _(a.onDeleteRow(t._id))}),c()()()}if(n&2){let e=o.$implicit,i=o.index,t=m(2);r(2),S((t.pagination.cur_page-1)*t.pagination.limit+i+1),r(2),S(e.created_at?D(5,13,e.created_at,"d MMM yyyy, hh:mm a"):"--"),r(3),S(e.created_name||"--"),r(3),S(e.scheme_id),r(2),S(e.date_from?D(13,16,e.date_from,"d MMM yyyy, hh:mm a"):"--"),r(3),S(e.date_to?D(16,19,e.date_to,"d MMM yyyy, hh:mm a"):"--"),r(3),s("ngIf",e.product_data==null?null:e.product_data.length),r(),s("ngIf",!(e.product_data!=null&&e.product_data.length)),r(2),B("matTooltip",e.description),r(),S(e.description||"--"),r(3),s("checked",e.isChecked),r(2),s("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}}function Ne(n,o){if(n&1){let e=v();h(0),l(1,"tr",16)(2,"td"),d(3,"\xA0"),c(),l(4,"td")(5,"div",17)(6,"mat-form-field",18)(7,"input",19),L("ngModelChange",function(t){p(e);let a=m();return y(a.filter.created_at,t)||(a.filter.created_at=t),_(t)}),g("ngModelChange",function(t){p(e);let a=m();return _(a.onDateChange("created_at",t))}),c(),b(8,"mat-datepicker-toggle",20)(9,"mat-datepicker",null,0),c()()(),l(11,"td")(12,"div",17)(13,"mat-form-field",18)(14,"input",21),L("ngModelChange",function(t){p(e);let a=m();return y(a.filter.created_name,t)||(a.filter.created_name=t),_(t)}),g("keyup.enter",function(){p(e);let t=m();return _(t.getList())}),c(),u(15,Fe,3,0,"button",22),c()()(),l(16,"td")(17,"div",17)(18,"mat-form-field",18)(19,"input",21),L("ngModelChange",function(t){p(e);let a=m();return y(a.filter.scheme_id,t)||(a.filter.scheme_id=t),_(t)}),g("keyup.enter",function(){p(e);let t=m();return _(t.getList())}),c(),u(20,Pe,3,0,"button",22),c()()(),l(21,"td")(22,"div",17)(23,"mat-form-field",18)(24,"input",23),L("ngModelChange",function(t){p(e);let a=m();return y(a.filter.date_from,t)||(a.filter.date_from=t),_(t)}),g("ngModelChange",function(t){p(e);let a=m();return _(a.onDateChange("date_from",t))}),c(),b(25,"mat-datepicker-toggle",20)(26,"mat-datepicker",null,1),c()()(),l(28,"td")(29,"div",17)(30,"mat-form-field",18)(31,"input",24),L("ngModelChange",function(t){p(e);let a=m();return y(a.filter.date_to,t)||(a.filter.date_to=t),_(t)}),g("ngModelChange",function(t){p(e);let a=m();return _(a.onDateChange("date_to",t))}),c(),b(32,"mat-datepicker-toggle",20)(33,"mat-datepicker",null,2),c()()(),l(35,"td")(36,"div",17)(37,"mat-form-field",18)(38,"input",21),L("ngModelChange",function(t){p(e);let a=m();return y(a.filter.product_details,t)||(a.filter.product_details=t),_(t)}),g("keyup.enter",function(){p(e);let t=m();return _(t.getList())}),c(),u(39,Be,3,0,"button",22),c()()(),l(40,"td"),d(41,"\xA0"),c(),l(42,"td"),d(43,"\xA0"),c()(),u(44,Re,28,22,"tr",25),C()}if(n&2){let e=k(10),i=k(27),t=k(34),a=m();r(7),s("matDatepicker",e),x("ngModel",a.filter.created_at),r(),s("for",e),r(6),x("ngModel",a.filter.created_name),r(),M(a.filter.created_name?15:-1),r(4),x("ngModel",a.filter.scheme_id),r(),M(a.filter.scheme_id?20:-1),r(4),s("matDatepicker",i),x("ngModel",a.filter.date_from),r(),s("for",i),r(6),s("matDatepicker",t),x("ngModel",a.filter.date_to),r(),s("for",t),r(6),x("ngModel",a.filter.product_details),r(),M(a.filter.product_details?39:-1),r(5),s("ngForOf",a.listing)}}function je(n,o){n&1&&(l(0,"td"),b(1,"app-skeleton"),c()),n&2&&(r(),T("h20 bg-skeleton"))}function He(n,o){n&1&&(l(0,"tr",16),u(1,je,2,2,"td",37),c()),n&2&&(r(),s("ngForOf",w(1,V).constructor(10)))}function Ye(n,o){n&1&&(h(0),u(1,He,2,2,"tr",36),C()),n&2&&(r(),s("ngForOf",w(1,V).constructor(8)))}function Ge(n,o){n&1&&(h(0),b(1,"app-data-not-found"),C())}var xe=class n{constructor(o,e,i,t,a,F,qe,ze,Je){this.dialog=o;this.api=e;this.comanFuncation=i;this.moduleService=t;this.alert=a;this.router=F;this.logService=qe;this.toastr=ze;this.dateService=Je}page=1;FORMID=ue;skLoading=!1;activeTab="Active";pagination={};filter={};mainTabs=[];modules={};listingCount={};listing=[];submodule={};accessRight={};listData=[];ngOnInit(){let o=this.moduleService.getAccessMap("SFA","Order","Scheme");o&&(this.accessRight=o);let e=this.moduleService.getSubSubModuleByName("SFA","Order","Scheme");e&&(this.submodule=e),this.getList()}onRefresh(){this.filter={},this.getList()}onTabChange(o){this.activeTab=o,this.getList()}onDateChange(o,e){if(e){let i=this.dateService.formatToYYYYMMDD(e);this.filter[o]=i}else this.filter[o]="";(this.filter.date_from||this.filter.date_to||this.filter.created_at)&&this.getList()}goToAddPage(){this.router.navigate(["/apps/sfa/scheme/scheme-add"])}goToDetailPage(o){this.router.navigate(["/apps/sfa/scheme/scheme-detail",o])}changeToPage(o){this.pagination.cur_page=o,this.getList()}changeToPagination(o){o=="Previous"?this.pagination.prev&&this.pagination.cur_page>1&&(this.pagination.cur_page--,this.getList()):this.pagination.next&&(this.pagination.cur_page++,this.getList())}getList(){this.skLoading=!0,this.api.post({filters:this.filter,activeTab:this.activeTab,page:this.pagination.cur_page??1},"order/read-scheme").subscribe(o=>{o.statusCode==200&&(this.skLoading=!1,this.listing=o.data.result,this.listingCount=o.data.activeTab,this.listData.forEach(e=>{e.status==="Active"?e.isChecked=!0:e.isChecked=!1}),this.pagination=o.pagination,this.mainTabs=[{name:"Active",label:"Active",icon:"ri-check-double-line",count:this.listingCount.active_count},{name:"Inactive",label:"Inactive",icon:"ri-file-forbid-line",count:this.listingCount.inactive_count}])})}onDeleteRow(o){this.alert.confirm("Are you sure?").then(e=>{e.isConfirmed&&this.api.patch({_id:o,is_delete:1},"order/delete-scheme").subscribe(i=>{i.statusCode===200&&(this.logService.logActivityOnDelete(this.submodule.module_id,this.submodule.title,"delete",o,"Scheme"),ye.default.fire("Deleted!",i.message,"success"),this.getList())})})}onToggleChange(o,e,i){this.comanFuncation.statusChange(o,e,i,this.submodule,"toggle","order/update-scheme-status").subscribe(t=>{t&&this.getList()})}openMainLogModal(o){this.comanFuncation.listLogsModal(this.submodule.module_id,o,this.submodule.module_type).subscribe(e=>{e===!0&&this.getList()})}PageHeaders=[{label:"Created At"},{label:"Created By"},{label:"Scheme ID"},{label:"Start Date"},{label:"End Date"},{label:"Product"},{label:"Scheme Description"},{label:"Status"}];static \u0275fac=function(e){return new(e||n)(f(re),f(K),f(he),f(X),f(Q),f(H),f(fe),f(Y),f(se))};static \u0275cmp=P({type:n,selectors:[["app-scheme-list"]],decls:14,vars:28,consts:[["picker",""],["picker1",""],["picker2",""],[3,"title","title1","activeitem"],[1,"box","py-3","px-4"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[4,"ngIf"],[1,"row"],[1,"col-xl-12"],[3,"onRefresh","logBtn","button1","pageTitle","btnShow","refreshLabel","btnShow1","logsLabel","btnShow2","addBtnLabel"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"tableHead","showS_No","showAction","columns"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"class",4,"ngFor","ngForOf"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","createdAt","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],["matInput","","name","date_from","placeholder","Date From",3,"ngModelChange","matDatepicker","ngModel"],["matInput","","name","date_to","placeholder","Date To",3,"ngModelChange","matDatepicker","ngModel"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"text-primary","font-semibold","underline",3,"click"],[1,"ellipsis",3,"matTooltip"],[1,"badge"],[3,"checkedChange","checked"],["matTooltip","Delete",3,"clickEvent","icon","buttonClass"],[1,"block","font-medium"],[1,"avatar","avatar-xs","bg-primary","text-white","avatar-rounded"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"]],template:function(e,i){e&1&&(b(0,"app-page-header",3),l(1,"div",4)(2,"nav",5),u(3,De,2,2,"ng-container",6)(4,Ve,2,1,"ng-container",6),c(),l(5,"div",7)(6,"div",8)(7,"app-page-sub-header",9),g("onRefresh",function(){return i.onRefresh()})("logBtn",function(){return i.openMainLogModal("")})("button1",function(){return i.goToAddPage()}),c(),l(8,"div",10)(9,"spk-reusable-tables",11),u(10,Ne,45,16,"ng-container",6)(11,Ye,2,2,"ng-container",6),c(),u(12,Ge,2,0,"ng-container",6),c(),l(13,"app-pagination-footer",12),g("preButtonClick",function(){return i.changeToPagination("Previous")})("nextButtonClick",function(){return i.changeToPagination("Next")})("pageChange",function(a){return i.changeToPage(a)}),c()()()()),e&2&&(s("title","Scheme")("title1",w(27,Te))("activeitem","Scheme List"),r(3),s("ngIf",i.skLoading),r(),s("ngIf",!i.skLoading),r(3),T("p-0 pt-3"),s("pageTitle","Scheme List")("btnShow",!0)("refreshLabel","Refresh")("btnShow1",!0)("logsLabel","Logs")("btnShow2",!0)("addBtnLabel","Add Scheme"),r(2),s("tableHead","border-b")("showS_No",!0)("showAction",!0)("columns",i.PageHeaders),r(),s("ngIf",!i.skLoading),r(),s("ngIf",i.skLoading),r(),s("ngIf",!i.listing.length&&!i.skLoading),r(),s("currentPage",i.pagination.cur_page)("totalPage",i.pagination.total_pages)("pageLimit",i.pagination.limit)("listLength",i.listing.length)("preBtn",!i.pagination.prev)("nextBtn",!i.pagination.next))},dependencies:[ge,W,R,G,q,z,Ce,U,_e,pe,Se,be,ve,de,ce,N,j,me,le,ee,ne,oe,ae,te,ie,$,Z,J],encapsulation:2})};export{xe as SchemeListComponent};
