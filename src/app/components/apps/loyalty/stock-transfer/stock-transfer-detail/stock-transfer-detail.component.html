<app-page-header [title]="'IRP'" [title1]="['Stock Transfer']" [activeitem]="'Stock Transfer Detail'"></app-page-header>


<div class="grid grid-cols-12 sm:gap-x-6">
    <div class="xl:col-span-12 col-span-12">
        <div class="grid grid-cols-12 sm:gap-x-6">
            <div class="xl:col-span-6 col-span-12">
                <app-showcode-card [title]="'Stock Transfer Detail'" [class]="'text-primarytint1color'" [boxHeader]="'pt-3'" [classbody]="'pt-0'"  [titleView]="true">
                    <ul class="ti-list-group list-group-flush border-0">
                        <li>
                            <div class="flex items-center gap-5 flex-wrap text-[12px]">
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium "> {{invoiceDetail.created_at ? (invoiceDetail.created_at | date : 'dd MMM yyyy') : '---'}}</span>
                                        <span class="text-textmuted dark:text-textmuted/50">Date Created</span>
                                    </div>
                                </div>
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium ">{{invoiceDetail.created_name ? (invoiceDetail.created_name | titlecase) : '---'}}</span>
                                        <span class="text-textmuted dark:text-textmuted/50">Created By</span>
                                    </div>
                                </div>
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium">
                                            {{invoiceDetail.invoice_number ? invoiceDetail.invoice_number : '---'}}
                                        </span>
                                        <span class="text-textmuted dark:text-textmuted/50">Invoice Number</span>
                                    </div>
                                </div>
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium">{{invoiceDetail.billing_date ? (invoiceDetail.billing_date | date : 'dd MMM yyyy') : '---'}}</span>
                                        <span class="text-textmuted dark:text-textmuted/50">Invoice Date</span>
                                    </div>
                                </div>
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium">â‚¹  
                                            {{invoiceDetail.net_amount_with_tax ? invoiceDetail.net_amount_with_tax : '---'}}
                                        </span>
                                        <span class="text-textmuted dark:text-textmuted/50">Invoice Amount</span>
                                    </div>
                                </div>
                                
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium ">{{invoiceDetail.total_item_count ? invoiceDetail.total_item_count : '---'}}</span>
                                        <span class="text-textmuted dark:text-textmuted/50">Total Items</span>
                                    </div>
                                </div>
                                <div class="flex items-center me-2 flex-wrap">
                                    <div>
                                        <span class="block font-medium ">
                                            {{invoiceDetail.total_item_quantity ? invoiceDetail.total_item_quantity : '---'}}
                                        </span>
                                        <span class="text-textmuted dark:text-textmuted/50">Total Qty</span>
                                    </div>
                                </div>
                                
                                <div class="flex items-center me-2 gap-3 flex-wrap">
                                    <div>
                                        <span class="font-medium" [ngClass]="{ 'text-success': invoiceDetail.grn_status === 'Received', 'text-warning': invoiceDetail.grn_status === 'Pending','text-danger': invoiceDetail.grn_status === 'Reject'}">
                                            {{invoiceDetail.grn_status ? invoiceDetail.grn_status : '---'}}</span>
                                            <span class="block text-textmuted dark:text-textmuted/50">GRN Status</span>
                                        </div>
                                        
                                        <app-icon-button [icon]="'ri-pencil-line'" [buttonClass]="'btn-wave ti-btn ti-btn-sm ti-btn-soft-primary waves-effect waves-light'" matTooltip="Change Status" (click)="openModal()" *ngIf="invoiceDetail.grn_status === 'Pending'"></app-icon-button>
                                        
                                    </div>
                                    
                                    <div class="flex items-center me-2 flex-wrap" *ngIf="invoiceDetail.remarks">
                                        <div>
                                            <span class="block font-medium">{{invoiceDetail.remarks ? invoiceDetail.remarks : '---'}}</span>
                                            <span class="block text-textmuted dark:text-textmuted/50">Reject Reason</span>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center me-2 flex-wrap">
                                        <div>
                                            <span class="text-success text-[0.9375rem] font-bold">200PT</span>
                                            <span class="block text-textmuted dark:text-textmuted/50">Point Transfered</span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </app-showcode-card>
                </div>
                <div class="xl:col-span-6 col-span-12">
                    <app-showcode-card [title]="'Customer Detail'" [class]="'text-primarytint1color'" [boxHeader]="'pt-3'" [classbody]="'pt-0'"  [titleView]="true">
                        <ul class="ti-list-group list-group-flush border-0">
                            <li>
                                <div class="flex items-center gap-5 flex-wrap text-[12px]">
                                    
                                    <div class="flex items-center me-2 flex-wrap">
                                        <div>
                                            <span class="block font-medium ">{{invoiceDetail.customer_name ? invoiceDetail.customer_name : '---'}} </span>
                                            <span class="text-textmuted dark:text-textmuted/50">Customer Details</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center me-2 flex-wrap">
                                        <div>
                                            <span class="block font-medium ">{{invoiceDetail.customer_type_name ? ( '(' + invoiceDetail.customer_type_name + ")") : '---'}}</span>
                                            <span class="text-textmuted dark:text-textmuted/50">Customer Type</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center me-2 flex-wrap">
                                        <div>
                                            <span class="block font-medium ">{{invoiceDetail.contact_person_name ? invoiceDetail.contact_person_name : '---'}}</span>
                                            <span class="text-textmuted dark:text-textmuted/50">Contact Person</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center me-2 flex-wrap">
                                        <div>
                                            <span class="block font-medium">{{invoiceDetail.customer_mobile ? invoiceDetail.customer_mobile : '---'}}</span>
                                            <span class="text-textmuted dark:text-textmuted/50">Mobile No.</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center me-2 flex-wrap">
                                        <div>
                                            <span class="block font-medium ">
                                                {{invoiceDetail.full_address ? invoiceDetail.full_address : '---'}}
                                            </span>
                                            <span class="text-textmuted dark:text-textmuted/50">Address</span>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </app-showcode-card>
                </div>
            </div>
            
            
            <div class="grid grid-cols-12 sm:gap-x-6">
                <div class="xl:col-span-8 col-span-12">
                    <app-showcode-card [title]="'Product Details'" [class]="'text-primarytint1color'" [boxHeader]="'pt-3'"
                        [classbody]="'pt-0'" [titleView]="true">
                        <div class="table-responsive overflow-auto table-bordered-default">
                            <spk-reusable-tables tableClass="ti-custom-table ti-custom-table-head" [columns]="invoiceColumns"
                                [showCheckbox]="false">
                                <tr *ngFor="let row of invoiceDetail.item_info; let i = index"
                                    class="border-b !border-defaultborder dark:!border-defaultborder/10">
                    
                                    <td class="w50">
                                        <div class="font-medium">
                                            {{i+1}}
                                        </div>
                                    </td>
                    
                                    <td>
                                        <div class="font-medium">
                                            {{ row.product_name ? row.product_name : '---' }}
                                        </div>
                                    </td>
                                    <td class="w130">
                                        <div class="text-textmuted dark:text-textmuted/50 ">
                                            {{ row.product_code ? row.product_code : '---' }}
                                        </div>
                                    </td>
                                    <td class="product-quantity-container text-center w80">
                                        {{row.total_quantity ? row.total_quantity : '---' }}
                                    </td>
                                </tr>
                            </spk-reusable-tables>
                        </div>
                        </app-showcode-card>
                </div>
                <div class="xl:col-span-4 col-span-12">
                    <app-showcode-card [title]="'GRN Received Document'" [class]="'box-title font-medium text-[15px] block text-primarytint1color'"
                        [titleView]="true" [iconClass]="'ti-btn btn-wave ti-btn-sm ti-btn-soft-primary waves-effect waves-light'"
                        [classbody]="'pt-0'" [iconName]="'ri-add-line'">
                        <div class="grid grid-cols-12 gap-x-4" *ngIf="invoiceDetail.files.length > 0">
                            <ng-container>
                                <div class="xxl:col-span-2 lg:col-span-4 xl:col-span-4 sm:col-span-6 col-span-12"
                                    *ngFor="let image of invoiceDetail.files">
                                    <spk-product-card [apiPath]="'invoice/get-doc'" [imageData]="image" [editBtn]="false"
                                        [delBtn]="false" [heading]="false" [subHeading]="false">
                                    </spk-product-card>
                                </div>
                            </ng-container>
                        </div>
                    
                        <ng-container *ngIf="invoiceDetail.files.length === 0">
                            <app-data-not-found></app-data-not-found>
                        </ng-container>
                        </app-showcode-card>
                </div>
            </div>
           
</div>
</div>
