import{a as et}from"./chunk-G64KJ3QF.js";import{a as Ze}from"./chunk-PU6S26UW.js";import{a as $e}from"./chunk-LGZVJJDX.js";import{a as Xe}from"./chunk-SQZ3YN6N.js";import{b as Je,c as Y}from"./chunk-CIBZCVJQ.js";import{a as q}from"./chunk-OTFCGVEU.js";import{a as j}from"./chunk-CNF4GSI7.js";import{a as Be}from"./chunk-OEHD5D2Y.js";import{a as Qe}from"./chunk-GLWQGYBC.js";import{a as G}from"./chunk-DC4QM32I.js";import{B as Ye,C as ze,F as U,c as be,g as Oe,j as We,k as je,q as Ge,r as He,s as Ue,v as qe,w as Ke}from"./chunk-VHE3PQ3O.js";import{$ as ve,A as I,Aa as we,B as R,C as ue,Ea as xe,G as ge,Ga as Le,H as fe,Ha as Ve,Ia as Ie,Ja as Me,M as Ce,Oa as De,P as he,Pa as Ee,Qa as Ae,Ta as Fe,Ua as Pe,V as ye,W as B,X as ke,Z as O,Za as Ne,aa as W,hb as H,jb as Re,o as x,va as Te,w as de,wa as Se,z as _e}from"./chunk-GYDYF5F3.js";import{M as ce,N as pe,Q as me,e as re,f as ae,g as P,n as le,o as se,t as N}from"./chunk-PD5VTTIY.js";import{$c as ie,Aa as c,Ba as p,Bc as ee,Hb as D,Lc as te,Mc as _,Nc as k,Ob as f,Oc as w,Uc as v,Vc as b,Wc as T,Yc as A,Zc as M,_b as m,ac as X,bc as E,dc as $,ed as F,fc as S,fd as ne,gd as oe,kc as a,lc as r,mc as y,nc as L,oc as V,qc as h,rb as l,sb as C,wc as g,yc as u}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{a as Z,b as J,i as Q}from"./chunk-66YHNWRR.js";function ht(o,i){if(o&1){let e=h();L(0),a(1,"div",5)(2,"spk-ng-select",16),g("selectedChange",function(n){c(e);let s=u();return p(s.CommonApiService.getCustomerData(n))})("selectedChange",function(n){c(e);let s=u();return p(s.findName(n,"customer_category"))}),r()(),a(3,"div",5)(4,"spk-ng-select",17),g("searchChanged",function(n){c(e);let s=u();return p(s.onSearch(n,"customer"))})("selectedChange",function(n){c(e);let s=u();return p(s.CommonApiService.getAssignUserData(n))}),r()(),V()}if(o&2){let e=u();l(2),m("fieldReq",!0)("options",e.CommonApiService.customerTypeData),l(2),m("fieldReq",!0)("search",!0)("options",e.CommonApiService.customerData)}}function yt(o,i){if(o&1){let e=h();a(0,"div",5)(1,"spk-ng-select",19),g("searchChanged",function(n){c(e);let s=u(2);return p(s.onSearch(n,"user"))}),r()()}if(o&2){let e=u(2);l(),m("options",e.CommonApiService.assignUserData)("search",!0)}}function kt(o,i){if(o&1&&(L(0),f(1,yt,2,2,"div",18),V()),o&2){let e=u();l(),m("ngIf",e.orgData==null||e.orgData.org==null?null:e.orgData.org.sfa)}}var K=class o{constructor(i,e,t,n,s,d,nt,ot,rt,at,lt){this.uploadService=i;this.logService=e;this.moduleService=t;this.CommonApiService=n;this.fb=s;this.modalData=d;this.dialogRef=nt;this.api=ot;this.toastr=rt;this.formValidation=at;this.authService=lt;this.orgData=this.authService.getUser()}data={};filter={};userList=[];categoryTypeValue=[];today=new Date;pageType="add";form;submodule={};orgData={};LOGIN_TYPES=x;ngOnInit(){let i=this.moduleService.getModuleByName("Ticket");i&&(this.submodule=i),this.data=this.modalData.formData,this.pageType=this.modalData.formType,this.pageType==="edit"?this.formsInit(this.modalData.formData):this.formsInit({}),this.CommonApiService.getDropDownData(16,"ticket_category"),this.CommonApiService.getDropDownData(16,"priority"),this.CommonApiService.getCustomerTypeData()}formsInit(i){if(this.pageType==="edit"){let e=[];i.attachment.forEach(t=>{e.push({source:t.url,options:{type:"local"}})})}this.form=this.fb.group({ticket_category:[i.ticket_category?i.ticket_category:"",I.required],customer_id:[i.customer_id?i.customer_id:"",I.required],customer_type_id:[i.customer_type_id?i.customer_type_id:"",I.required],ticket_priority:[i.ticket_priority?i.ticket_priority:"",I.required],ticket_description:[i.ticket_description?i.ticket_description:"",I.required]}),(this.orgData.login_type_id===x.ORGANIZATION_ADMIN||this.orgData.login_type_id===x.SYSTEM_USER)&&this.form.addControl("assign_to_user_id",this.fb.control(i.assign_to_user_id?._id||"")),i.customer_type_id&&this.CommonApiService.getCustomerData(this.form.value.customer_type_id)}lastSearchTerm="";onSearch(i,e){let t=i?.trim()||"";t!==this.lastSearchTerm&&(this.lastSearchTerm=t,e==="customer"&&this.CommonApiService.getCustomerData(this.form.value.customer_type_id,"",i))}findName(i,e){if(e==="customer_category"){let t=this.CommonApiService.customerCategorySubType.find(n=>n.value===i);t&&(this.form.patchValue({customer_type_name:t.label}),this.form.patchValue({collected_from_login_type_id:t.login_type_id})),this.CommonApiService.getCustomerData(this.form.value.customer_type_id)}}close(){this.dialogRef.close()}priorityList=[{label:"High",value:"High"},{label:"Medium",value:"Medium"},{label:"Low",value:"Low"}];pondOptions=this.getPondOptions("image");pondFiles=[];getPondOptions(i){let e={allowFileTypeValidation:!0,labelIdle:"Click or drag files here to upload...",maxFiles:5,server:{process:(t,n,s,d)=>{setTimeout(()=>{d(Date.now().toString())},1e3)},revert:(t,n)=>{n()}}};if(i==="image")return J(Z({},e),{allowMultiple:!1,acceptedFileTypes:["image/jpeg","image/png","image/jpg"],maxFileSize:"2MB",allowImageValidateSize:!0,labelFileTypeNotAllowed:"Only PNG and JPEG files are allowed",fileValidateTypeLabelExpectedTypes:"Allowed: PNG, JPEG",labelImageValidateSizeTooSmall:"Image is too small. Min: {minWidth}\xD7{minHeight}",labelImageValidateSizeTooBig:"Image is too large. Max: {maxWidth}\xD7{maxHeight}"})}onFileProcessed(i,e){let t=i.file.file;Object.assign(t,{image_type:e}),e==="image"&&(this.pondFiles=[...this.pondFiles||[],t])}onFileRemove(i,e){let t=i.file.file;if(e==="image"){let n=this.pondFiles.findIndex(s=>s.name===t.name&&s.size===t.size);n>-1&&this.pondFiles.splice(n,1)}}uploadresults=[];submiTicket(){if(this.orgData.org.sfa===!1){let i=this.form.get("assign_to_user_id");i?.clearValidators(),i?.updateValueAndValidity(),this.form.removeControl("assign_to_user_id")}if(this.form.valid){this.api.disabled=!0;let i;this.orgData.login_type_id===x.ORGANIZATION_ADMIN?i=this.pageType==="edit"?"ticket/admin/update":"ticket/admin/create":this.orgData.login_type_id===x.FIELD_USER?i=this.pageType==="edit"?"ticket/user/update":"ticket/user/create":this.orgData.login_type_id===x.PRIMARY||this.orgData.login_type_id===x.SUB_PRIMARY?i=this.pageType==="edit"?"ticket/customer/update":"ticket/customer/create":i=this.pageType==="edit"?"ticket/update":"ticket/create",this.formValidation.removeEmptyFields(this.form.value);let e=this.pageType==="edit"?"patch":"post";this.api[e](this.form.value,i).subscribe(t=>Q(this,null,function*(){t.statusCode===200?this.pondFiles.length>0?this.uploadService.uploadFile(t.data.inserted_id,"ticket",this.pondFiles,"Ticket Images",this.submodule,void 0,()=>this.dialogRef.close(!0)):(this.api.disabled=!1,this.pageType==="edit"&&this.logService.logActivityOnUpdate(this.pageType=="edit",this.modalData.formData,this.form.value,this.submodule.module_id,this.submodule.title,"update",this.data._id||null,()=>{},this.submodule.module_type),this.dialogRef.close(!0),this.toastr.success(t.message,"","toast-top-right")):this.api.disabled=!1}))}else this.formValidation.markFormGroupTouched(this.form)}static \u0275fac=function(e){return new(e||o)(C(Ze),C(q),C(G),C(j),C(ye),C(Ee),C(De),C(O),C(de),C(qe),C(W))};static \u0275cmp=D({type:o,selectors:[["app-ticket-add"]],decls:22,vars:19,consts:[[1,"mat-dialoge"],[3,"close","title","closeBtn"],[3,"ngSubmit","formGroup"],[1,"mat-typography","py-1"],[1,"grid","grid-cols-12","sm:gap-x-6"],[1,"xl:col-span-4","col-span-12","mb-3"],["formControlName","ticket_category","label","Category",3,"fieldReq","options"],[4,"ngIf"],["formControlName","ticket_priority","label","Priority",3,"fieldReq","options"],[1,"xxl:col-span-6","md:col-span-6","col-span-6"],["label","Remark","formControlName","ticket_description","type","textarea",1,"remove-default-class",3,"fieldReq"],[1,"form-label"],[1,"filepond","basic-filepond",3,"onremovefile","onprocessfile","options","files"],["align","end"],[1,"flex","items-center","gap-2"],[3,"buttonType","buttonClass","iconClass","loadingIconClass","disabled"],["formControlName","customer_type_id","label","Customer Type",3,"selectedChange","fieldReq","options"],["formControlName","customer_id","label","Customer",3,"searchChanged","selectedChange","fieldReq","search","options"],["class","xl:col-span-4 col-span-12 mb-3",4,"ngIf"],["formControlName","assign_to_user_id","label","Assign To",3,"searchChanged","options","search"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"app-modal-header",1),F(2,"titlecase"),g("close",function(){return t.close()}),r(),a(3,"form",2),g("ngSubmit",function(){return t.submiTicket()}),a(4,"mat-dialog-content",3)(5,"div",4)(6,"div",5),y(7,"spk-ng-select",6),r(),f(8,ht,5,5,"ng-container",7)(9,kt,2,1,"ng-container",7),a(10,"div",5),y(11,"spk-ng-select",8),r()(),a(12,"div",4)(13,"div",9),y(14,"spk-input",10),r(),a(15,"div",9)(16,"label",11),_(17,"Upload Image"),r(),a(18,"file-pond",12),g("onremovefile",function(s){return t.onFileRemove(s,"image")})("onprocessfile",function(s){return t.onFileProcessed(s,"image")}),r()()()(),a(19,"mat-dialog-actions",13)(20,"div",14),y(21,"app-button",15),r()()()()),e&2&&(l(),m("title",ne(2,17,t.pageType)+"  Ticket")("closeBtn",!0),l(2),m("formGroup",t.form),l(4),m("fieldReq",!0)("options",t.CommonApiService.dropDownData.ticket_category),l(),m("ngIf",(t.orgData==null?null:t.orgData.login_type_id)===t.LOGIN_TYPES.ORGANIZATION_ADMIN||(t.orgData==null?null:t.orgData.login_type_id)===t.LOGIN_TYPES.SYSTEM_USER||(t.orgData==null?null:t.orgData.login_type_id)===t.LOGIN_TYPES.FIELD_USER),l(),m("ngIf",(t.orgData==null?null:t.orgData.login_type_id)===t.LOGIN_TYPES.ORGANIZATION_ADMIN||(t.orgData==null?null:t.orgData.login_type_id)===t.LOGIN_TYPES.SYSTEM_USER),l(2),m("fieldReq",!0)("options",t.priorityList),l(3),m("fieldReq",!0),l(4),m("options",t.pondOptions)("files",t.pondFiles),l(3),m("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("iconClass","ri-save-line")("loadingIconClass","ri-loader-2-fill")("disabled",t.api.disabled))},dependencies:[B,fe,R,ue,N,P,le,U,Ce,he,Ke,Oe,ze,H,Pe,Fe,je,We,ke,He],encapsulation:2})};var vt=()=>["Ticket"],z=o=>({active:o}),bt=o=>["/apps/independent/ticket-list/ticket-detail",o],Tt=(o,i,e)=>({"bg-success/10 text-success":o,"bg-warning/10 text-warning":i,"bg-danger/10 text-danger":e}),it=()=>[];function St(o,i){if(o&1){let e=h();a(0,"button",35),g("click",function(){c(e);let n=u();return p(n.openModal(""))}),y(1,"i",36),_(2,"Add New "),r()}}function wt(o,i){if(o&1&&(a(0,"span"),_(1),r()),o&2){let e=u().$implicit;$("badge bg-",e.countClass,"/10 text-",e.countClass," rounded-full"),l(),w(" ",e.count," ")}}function xt(o,i){if(o&1){let e=h();a(0,"li",37),g("click",function(){let n=c(e).$implicit,s=u();return s.filter.status="",s.filter.ticket_category=null,s.filter.ticket_priority=null,s.setActiveTab(n.label),p(s.getList())}),a(1,"a")(2,"div",38)(3,"span",39),y(4,"i"),r(),a(5,"span",40),_(6),r(),f(7,wt,2,5,"span",41),r()()()}if(o&2){let e=i.$implicit,t=u();m("ngClass",M(5,z,t.activeTab===e.value)),l(4),E(e.icon+" align-middle text-[14px] text-primary"),l(2),w(" ",e.label," "),l(),m("ngIf",e.count!==null)}}function Lt(o,i){if(o&1){let e=h();a(0,"li",37),g("click",function(){let n=c(e).$implicit,s=u();return s.filter.status="",s.filter.ticket_category=n,s.activeTab="All",s.filter.ticket_priority=null,p(s.getList())}),a(1,"div",42)(2,"a",43)(3,"div",40)(4,"span",44),_(5),r()()(),a(6,"span",45),_(7),r()()()}if(o&2){let e=i.$implicit,t=u();m("ngClass",M(3,z,t.filter.ticket_category===e)),l(5),k(e),l(2),w(" ",t.tabCount[e]," ")}}function Vt(o,i){o&1&&(a(0,"div",46)(1,"label",47),_(2," No data available! "),r()())}function It(o,i){if(o&1){let e=h();a(0,"li",37),g("click",function(){let n=c(e).$implicit,s=u();return s.filter.status="",s.activeTab="All",s.filter.ticket_category=null,s.filter.ticket_priority=n,p(s.getList())}),a(1,"div",42)(2,"a",43)(3,"div",40)(4,"span",44),_(5),r()()(),a(6,"span",48),_(7),r()()()}if(o&2){let e=i.$implicit,t=u();m("ngClass",M(3,z,t.filter.ticket_priority===e)),l(5),k(e),l(2),k(t.priorityCount[e])}}function Mt(o,i){o&1&&(a(0,"div",46)(1,"label",47),_(2," No data available! "),r()())}function Dt(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.created_name="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Et(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.ticket_no="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function At(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.customer_type_name="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Ft(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.customer_detail="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Pt(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.ticket_category="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Nt(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u(2);return n.filter.login_type_name="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Rt(o,i){if(o&1){let e=h();a(0,"td")(1,"div",26)(2,"mat-form-field",27)(3,"input",30),T("ngModelChange",function(n){c(e);let s=u();return b(s.filter.login_type_name,n)||(s.filter.login_type_name=n),p(n)}),g("keyup.enter",function(){c(e);let n=u();return p(n.getList())}),r(),f(4,Nt,3,0,"button",31),r()()()}if(o&2){let e=u();l(3),v("ngModel",e.filter.login_type_name),l(),S(e.filter.login_type_name?4:-1)}}function Bt(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.ticket_priority="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Ot(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.ticket_description="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function Wt(o,i){if(o&1){let e=h();a(0,"button",49),g("click",function(){c(e);let n=u();return n.filter.status="",p(n.getList())}),a(1,"mat-icon"),_(2,"close"),r()()}}function jt(o,i){if(o&1&&(a(0,"td"),_(1),r()),o&2){let e=u().$implicit;l(),w(" ",(e.assign_to_user_detail!=null&&e.assign_to_user_detail.name?e.assign_to_user_detail==null?null:e.assign_to_user_detail.name:"-")+" ("+(e.assign_to_user_detail!=null&&e.assign_to_user_detail.user_code?e.assign_to_user_detail==null?null:e.assign_to_user_detail.user_code:"-")+")"," ")}}function Gt(o,i){if(o&1){let e=h();a(0,"app-icon-button",56),g("clickEvent",function(){c(e);let n=u().$implicit,s=u(2);return p(s.updateStatus(n))}),r()}o&2&&m("icon","ri-pencil-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-success waves-effect waves-light")}function Ht(o,i){if(o&1){let e=h();a(0,"tr",24)(1,"td",25),_(2),r(),a(3,"td"),_(4),F(5,"date"),r(),a(6,"td"),_(7),r(),a(8,"td")(9,"a",51),g("click",function(){let n=c(e).$implicit,s=u(2);return p(s.setHighLight(n._id))}),_(10),r()(),a(11,"td"),_(12),r(),a(13,"td"),_(14),r(),a(15,"td")(16,"span",52),_(17),r()(),f(18,jt,2,1,"td",32),a(19,"td")(20,"span",52),_(21),r()(),a(22,"td",53)(23,"span",54),_(24),r()(),a(25,"td")(26,"span",52),_(27),r()(),a(28,"td",33),f(29,Gt,1,2,"app-icon-button",55),r()()}if(o&2){let e=i.$implicit,t=i.index,n=u(2);X("bg-gray-400",n.isHighlighted(e._id)),l(2),k((n.pagination.cur_page-1)*n.pagination.limit+t+1),l(2),k(oe(5,19,e.created_at,"dd MMM yyyy hh:mm a")),l(3),k(e.created_name),l(2),m("routerLink",M(22,bt,e._id)),l(),w(" ",e.ticket_no,""),l(2),k((e.customer_detail==null?null:e.customer_detail.customer_type_name)||"--"),l(2),k((e==null||e.customer_detail==null?null:e.customer_detail.customer_name)+" "+(e==null||e.customer_detail==null?null:e.customer_detail.mobile)),l(2),m("ngClass",e.ticket_category==="Marketing"?"bg-warning/10 text-warning":e.ticket_category==="Billing"?"bg-danger/10 text-danger":e.ticket_category==="Quality"?"bg-success/10 text-success":"bg-primary/10 text-primary"),l(),w(" ",e.ticket_category," "),l(),m("ngIf",n.orgData==null||n.orgData.org==null?null:n.orgData.org.sfa),l(2),m("ngClass",e.ticket_priority==="High"?"bg-primarytint1color/10  text-primarytint1color":e.ticket_priority==="low"?"bg-danger/10 text-danger":e.ticket_priority==="Medium"?"bg-warning/10 text-warning":"bg-primary/10 text-primary"),l(),w(" ",e.ticket_priority," "),l(2),ee("matTooltip",e.ticket_description),l(),k(e.ticket_description||"--"),l(2),m("ngClass",ie(24,Tt,e.status==="Complete",e.status==="Pending",e.status==="Cancel")),l(),k(e.status),l(2),m("ngIf",e.status==="Pending"||e.status==="")}}function Ut(o,i){if(o&1&&(L(0),f(1,Ht,30,28,"tr",50),V()),o&2){let e=u();l(),m("ngForOf",e.listing)}}function qt(o,i){o&1&&(a(0,"td"),y(1,"app-skeleton"),r()),o&2&&(l(),E("h20 bg-skeleton"))}function Kt(o,i){if(o&1&&(a(0,"tr",58),f(1,qt,2,2,"td",59),r()),o&2){let e=u(2);l(),m("ngForOf",A(1,it).constructor(!(e.orgData==null||e.orgData.org==null)&&e.orgData.org.sfa?12:11))}}function Yt(o,i){o&1&&(L(0),f(1,Kt,2,2,"tr",57),V()),o&2&&(l(),m("ngForOf",A(1,it).constructor(6)))}function zt(o,i){o&1&&(L(0),y(1,"app-data-not-found"),V())}var tt=class o{constructor(i,e,t,n,s,d,nt,ot,rt,at,lt,Zt){this.dialog=i;this.api=e;this.commonFunction=t;this.moduleService=n;this.logService=s;this.alert=d;this.dateService=nt;this.router=ot;this.highlightService=rt;this.authService=at;this.comanFuncation=lt;this.commonApiService=Zt;this.commonApiService.getDropDownData(16,"ticket_category"),this.orgData=this.authService.getUser(),this.getColumn()}filter={};skLoading=!1;activeTab="All";mainModule={};pagination={};listing={};orgData={};todolistColumn=[];highlightedId;pageKey="ticket-list";tabCount={};priorityKeys=[];priorityCount={};categoryKeys=[];accessRight={};tabs=[{label:"All",value:"",icon:"ri-inbox-line",countClass:"warning",count:0},{label:"Pending",value:"Pending",icon:"ri-time-line",countClass:"warning",count:0},{label:"Complete",value:"Complete",icon:"ri-checkbox-line",countClass:"success",count:0},{label:"Cancel",value:"Cancel",icon:"ri-close-circle-line",countClass:"danger",count:0}];ngOnInit(){let i=this.moduleService.getAccessMap("Ticket");i&&(this.accessRight=i);let e=this.highlightService.getHighlight(this.pageKey);e!=null&&(this.activeTab=e.tab,this.highlightedId=e.rowId,this.pagination.cur_page=e.pageIndex,this.filter=e.filters,this.highlightService.clearHighlight(this.pageKey));let t=this.moduleService.getModuleByName("Ticket");t&&(this.mainModule=t),this.getList()}setActiveTab(i){this.activeTab=i,this.filter={}}isHighlighted(i){return this.highlightedId===i}setHighLight(i){this.comanFuncation.setHighLight(this.pageKey,i,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}onRefresh(){this.filter={},this.activeTab="All",this.filter.customer_name=null,this.getList()}onSearch(i){this.filter.customer_name=i,this.getList()}goToDetailPage(i){this.activeTab==="Present"&&this.router.navigate(["/apps/independent/ticket-list/ticket-detail",i])}getTicketCategory(){this.api.disabled=!0,this.api.post({},"dropdown/read-dropdown").subscribe(i=>{i.statusCode})}getList(){let i=this.moduleService.getModuleByName("Ticket");this.skLoading=!0,this.activeTab!="All"&&(this.filter.status=this.activeTab),this.filter=this.commonFunction.removeBlankKeys(this.filter),this.api.post({filters:this.filter,page:this.pagination.cur_page??1,activeTab:this.activeTab,module_id:i.module_id},"ticket/read").subscribe(e=>{e.statusCode==200&&(this.skLoading=!1,this.listing=e.data.result,this.tabCount=e.data.category_counts?e.data.category_counts:{},this.priorityCount=e.data.priority_counts?e.data.priority_counts:{},this.pagination=e.pagination,this.categoryKeys=Object.keys(e.data.category_counts?e.data.category_counts:""),this.priorityKeys=Object.keys(e.data.priority_counts?e.data.priority_counts:""),this.tabs=[{label:"All",value:"All",icon:"ri-inbox-line",countClass:"primary",count:e.data.status_counts.All||0},{label:"Pending",value:"Pending",icon:"ri-time-line",countClass:"warning",count:e.data.status_counts?.Pending||0},{label:"Complete",value:"Complete",icon:"ri-checkbox-circle-line",countClass:"success",count:e.data.status_counts?.Complete||0},{label:"Cancel",value:"Cancel",icon:"ri-close-circle-line",countClass:"danger",count:e.data.status_counts?.Cancel||0}])})}openModal(i){this.dialog.open(K,{width:"800px",data:{lastPage:"ticket-list",formType:i?"edit":"create",formData:i||{}}}).afterClosed().subscribe(t=>{t&&this.getList()})}changeToPagination(i){i=="Previous"?this.pagination.prev&&this.pagination.cur_page>1&&(this.pagination.cur_page--,this.getList()):this.pagination.next&&(this.pagination.cur_page++,this.getList())}changeToPage(i){this.pagination.cur_page=i,this.getList()}getColumn(){this.todolistColumn=[{label:"Created At",field:"Created At"},{label:"Created By",field:"Created By"},{label:"Ticket No.",field:"Ticket No."},{label:"Customer Type",field:"Customer Type"},{label:"Customer Details",field:"Customer Details"},{label:"Category",field:"Category"},...this.orgData?.org?.sfa?[{label:"User Details",field:"User Details"}]:[],{label:"Priority",field:"Priority"},{label:"Remark",field:"Remark"},{label:"Status",field:"Status"}]}updateStatus(i){this.dialog.open(et,{width:"450px",data:i}).afterClosed().subscribe(t=>{t===!0&&this.getList()})}goToDetail(i){alert("test"),this.commonFunction.router.navigateByUrl("apps/ticket/ticket-detail"+i._id)}openDropdownModal(){this.dialog.open($e,{width:"450px",data:{call_as:"modal",moduleData:this.mainModule}}).afterClosed().subscribe(e=>{e===!0&&this.getList()})}static \u0275fac=function(e){return new(e||o)(C(Ae),C(O),C(Y),C(G),C(q),C(ve),C(Re),C(ce),C(Je),C(W),C(Y),C(j))};static \u0275cmp=D({type:o,selectors:[["app-ticket-list"]],decls:93,vars:60,consts:[["picker",""],[3,"buttonClick","title","title1","activeitem","btnShow","buttonText","icon"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xl:col-span-3","col-span-12"],[1,"box"],[1,"box-header","gap-2","items-center","pb-3","border-b","border-dashed","border-defaultborder","dark:border-defaultborder/10"],[1,"avatar","avatar-md","bg-primary","avatar-rounded"],[1,"ri-file-list-3-line","text-[1rem]"],[1,"box-title"],[1,"text-textmuted","dark:text-textmuted/50","block","text-xs"],["class","ti-btn ti-btn-sm ti-btn-soft-primary1 ms-auto !rounded-full",3,"click",4,"ngIf"],[1,"box-body","p-0"],[1,"p-4","task-navigation","border-b","border-dashed","border-defaultborder","dark:border-defaultborder/10"],[1,"list-none","task-main-nav","mb-0"],[1,"px-0","pt-0"],[1,"text-[11px]","text-textmuted","dark:text-textmuted/50","opacity-70","font-medium"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"px-0","pt-2","flex","justify-between","gap-2","items-center"],["class","px-3",4,"ngIf"],[1,"xl:col-span-9","col-span-12"],[3,"search","refresh","title","titleView","boxHeader","classbody","view","refresBtnShow","logBtnShow","overallCountShow","overallCount","showSearch","searchPlaceholder"],[1,"relative"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table text-nowrap",3,"tableHeight","showCheckbox","showS_No","showAction","columns"],[1,"todo-box","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","createdAt","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],[4,"ngIf"],[1,"text-end"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[1,"ti-btn","ti-btn-sm","ti-btn-soft-primary1","ms-auto","!rounded-full",3,"click"],[1,"ri-add-line"],[3,"click","ngClass"],[1,"flex","items-center"],[1,"me-2","leading-none"],[1,"flex-auto","text-nowrap"],[3,"class",4,"ngIf"],[1,"flex","items-center","justify-between","flex-wrap","gap-2"],[1,"flex"],[1,"font-medium"],[1,"badge","bg-primarytint1color/10","text-primarytint1color","rounded-full"],[1,"px-3"],[1,"form-check-label","!ps-0","text11px","font-normal"],[1,"badge","bg-primary/10","rounded-full","text-primary"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","todo-box border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],[1,"text-primary","font-semibold","underline",3,"click","routerLink"],[1,"badge",3,"ngClass"],[1,"w-200"],[1,"ellipsis",3,"matTooltip"],["matTooltip","Change Status",3,"icon","buttonClass","clickEvent",4,"ngIf"],["matTooltip","Change Status",3,"clickEvent","icon","buttonClass"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[4,"ngFor","ngForOf"]],template:function(e,t){if(e&1){let n=h();a(0,"app-page-header",1),g("buttonClick",function(){return c(n),p(t.openDropdownModal())}),r(),a(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"span",6),y(6,"i",7),r(),a(7,"div",8),_(8," Ticket "),a(9,"span",9),_(10,"Create Ticket"),r()(),f(11,St,3,0,"button",10),r(),a(12,"div",11)(13,"div",12)(14,"ul",13)(15,"li",14)(16,"span",15),_(17,"General"),r()(),f(18,xt,8,7,"li",16),r(),a(19,"ul",13)(20,"li",17)(21,"span",15),_(22,"Category"),r()(),f(23,Lt,8,5,"li",16)(24,Vt,3,0,"div",18),r(),a(25,"ul",13)(26,"li",17)(27,"span",15),_(28,"Priority"),r()(),f(29,It,8,5,"li",16)(30,Mt,3,0,"div",18),r()()()()(),a(31,"div",19)(32,"app-showcode-card",20),g("search",function(d){return c(n),p(t.onSearch(d))})("refresh",function(){return c(n),p(t.onRefresh())}),a(33,"div",21)(34,"div",22)(35,"spk-reusable-tables",23)(36,"tr",24)(37,"td",25),_(38,"\xA0"),r(),a(39,"td")(40,"div",26)(41,"mat-form-field",27)(42,"input",28),T("ngModelChange",function(d){return c(n),b(t.filter.created_at,d)||(t.filter.created_at=d),p(d)}),g("ngModelChange",function(){return c(n),p(t.getList())}),r(),y(43,"mat-datepicker-toggle",29)(44,"mat-datepicker",null,0),r()()(),a(46,"td")(47,"div",26)(48,"mat-form-field",27)(49,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.created_name,d)||(t.filter.created_name=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(50,Dt,3,0,"button",31),r()()(),a(51,"td")(52,"div",26)(53,"mat-form-field",27)(54,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.ticket_no,d)||(t.filter.ticket_no=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(55,Et,3,0,"button",31),r()()(),a(56,"td")(57,"div",26)(58,"mat-form-field",27)(59,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.customer_type_name,d)||(t.filter.customer_type_name=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(60,At,3,0,"button",31),r()()(),a(61,"td")(62,"div",26)(63,"mat-form-field",27)(64,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.customer_detail,d)||(t.filter.customer_detail=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(65,Ft,3,0,"button",31),r()()(),a(66,"td")(67,"div",26)(68,"mat-form-field",27)(69,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.ticket_category,d)||(t.filter.ticket_category=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(70,Pt,3,0,"button",31),r()()(),f(71,Rt,5,2,"td",32),a(72,"td")(73,"div",26)(74,"mat-form-field",27)(75,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.ticket_priority,d)||(t.filter.ticket_priority=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(76,Bt,3,0,"button",31),r()()(),a(77,"td")(78,"div",26)(79,"mat-form-field",27)(80,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.ticket_description,d)||(t.filter.ticket_description=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(81,Ot,3,0,"button",31),r()()(),a(82,"td")(83,"div",26)(84,"mat-form-field",27)(85,"input",30),T("ngModelChange",function(d){return c(n),b(t.filter.status,d)||(t.filter.status=d),p(d)}),g("keyup.enter",function(){return c(n),p(t.getList())}),r(),f(86,Wt,3,0,"button",31),r()()(),a(87,"td",33),_(88,"\xA0"),r()(),f(89,Ut,2,1,"ng-container",32)(90,Yt,2,2,"ng-container",32),r(),f(91,zt,2,0,"ng-container",32),r()(),a(92,"app-pagination-footer",34),g("preButtonClick",function(){return c(n),p(t.changeToPagination("Previous"))})("nextButtonClick",function(){return c(n),p(t.changeToPagination("Next"))})("pageChange",function(d){return c(n),p(t.changeToPage(d))}),r()()()()}if(e&2){let n=te(45);m("title","Ticket")("title1",A(59,vt))("activeitem","Ticket List")("btnShow",!0)("buttonText","Dropdown Config")("icon","settings"),l(11),m("ngIf",t.accessRight==null?null:t.accessRight.addRight),l(7),m("ngForOf",t.tabs),l(5),m("ngForOf",t.categoryKeys),l(),m("ngIf",!(t.categoryKeys!=null&&t.categoryKeys.length)),l(5),m("ngForOf",t.priorityKeys),l(),m("ngIf",!(t.priorityKeys!=null&&t.priorityKeys.length)),l(2),m("title","Ticket List")("titleView",!0)("boxHeader","pb-0 pt-0")("classbody","pt-0")("view",!1)("refresBtnShow",!0)("logBtnShow",!1)("overallCountShow",!0)("overallCount",t.listing==null?null:t.listing.length)("showSearch",!1)("searchPlaceholder","Search by Company Name"),l(3),m("tableHeight","630px")("showCheckbox",!1)("showS_No",!0)("showAction",!0)("columns",t.todolistColumn),l(7),m("matDatepicker",n),v("ngModel",t.filter.created_at),l(),m("for",n),l(6),v("ngModel",t.filter.created_name),l(),S(t.filter.created_name?50:-1),l(4),v("ngModel",t.filter.ticket_no),l(),S(t.filter.ticket_no?55:-1),l(4),v("ngModel",t.filter.customer_type_name),l(),S(t.filter.customer_type_name?60:-1),l(4),v("ngModel",t.filter.customer_detail),l(),S(t.filter.customer_detail?65:-1),l(4),v("ngModel",t.filter.ticket_category),l(),S(t.filter.ticket_category?70:-1),l(),m("ngIf",t.orgData==null||t.orgData.org==null?null:t.orgData.org.sfa),l(4),v("ngModel",t.filter.ticket_priority),l(),S(t.filter.ticket_priority?76:-1),l(4),v("ngModel",t.filter.ticket_description),l(),S(t.filter.ticket_description?81:-1),l(4),v("ngModel",t.filter.status),l(),S(t.filter.status?86:-1),l(3),m("ngIf",!t.skLoading),l(),m("ngIf",t.skLoading),l(),m("ngIf",!t.listing.length&&!t.skLoading),l(),E("p-0"),m("currentPage",t.pagination.cur_page)("totalPage",t.pagination.total_pages)("pageLimit",t.pagination.limit)("listLength",t.listing.length)("preBtn",!t.pagination.prev)("nextBtn",!t.pagination.next)}},dependencies:[Be,U,re,ae,P,_e,R,ge,Qe,be,Ue,Ge,Xe,Ne,se,H,we,Ve,Ie,Me,xe,Le,Se,Te,N,Ye,B,me,pe],encapsulation:2})};export{tt as TicketListComponent};
