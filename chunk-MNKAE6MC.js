import{a as fe}from"./chunk-J4NDCUAB.js";import{a as be}from"./chunk-REKAXM5L.js";import{a as he}from"./chunk-ZON5AR26.js";import"./chunk-LGZVJJDX.js";import"./chunk-54KZ5YIV.js";import{a as de}from"./chunk-SQZ3YN6N.js";import{b as ge,c as me}from"./chunk-CIBZCVJQ.js";import{a as ce}from"./chunk-OTFCGVEU.js";import{a as pe}from"./chunk-HPLI5COI.js";import{b as ue}from"./chunk-DUVWFXSE.js";import{a as X}from"./chunk-CNF4GSI7.js";import{a as ae}from"./chunk-OEHD5D2Y.js";import{a as _e}from"./chunk-GLWQGYBC.js";import{a as ee}from"./chunk-DC4QM32I.js";import{F as le,c as Z,q as oe,s as re,u as se}from"./chunk-VHE3PQ3O.js";import{$ as J,F as y,Qa as te,V as Y,W as G,Z as z,Za as ie,jb as ne,l as K,q as Q,v as W,w as q}from"./chunk-GYDYF5F3.js";import{M as N,Q as j,f as B,g as O,o as P,t as $}from"./chunk-PD5VTTIY.js";import{$c as E,Aa as m,Ba as _,Bc as F,Fc as M,Gc as U,Hb as I,Hc as R,Mc as C,Nc as V,Ob as d,Oc as T,Yc as x,Zc as D,_b as s,ac as k,bc as L,ed as H,gd as A,kc as c,lc as p,mc as S,nc as h,oc as f,qc as v,rb as r,sb as u,wc as b,yc as l}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";var ve=["reusableTable"],Te=()=>["User"],w=()=>[],Se=(a,i,e)=>({name:a,label:i,count:e}),xe=a=>[a];function Le(a,i){a&1&&S(0,"app-skeleton"),a&2&&L("w100 h30 bg-skeleton")}function ye(a,i){a&1&&(h(0),c(1,"div",11),d(2,Le,1,2,"app-skeleton",12),p(),f()),a&2&&(r(2),s("ngForOf",x(1,w).constructor(6)))}function we(a,i){if(a&1){let e=v();c(0,"app-listing-tab",15),b("tabChange",function(n){m(e);let o=l(2);return _(o.onTabChange(n.tab))}),p()}if(a&2){let e=i.$implicit,t=l(2);s("tabs",D(7,xe,E(3,Se,e.value,e.label,e.count)))("activeTab",t.activeTab)("iconShow",!1)}}function Ie(a,i){if(a&1&&(h(0),c(1,"nav",13),d(2,we,1,9,"app-listing-tab",14),p(),f()),a&2){let e=l();r(2),s("ngForOf",e.mainTabs)}}function ke(a,i){if(a&1&&(c(0,"span"),C(1),H(2,"date"),p()),a&2){let e,t=l(2).$implicit,n=l().$implicit;r(),T(" ",A(2,1,(e=n==null?null:n[t==null?null:t.name])!==null&&e!==void 0?e:n==null||n.form_data==null?null:n.form_data[t==null?null:t.name],"d MMM yyyy, hh:mm a")," ")}}function Fe(a,i){if(a&1&&(c(0,"span"),C(1),p()),a&2){let e,t=l(2).$implicit,n=l().$implicit;r(),T(" ",(e=(e=n==null?null:n[t==null?null:t.name])!==null&&e!==void 0?e:n==null||n.form_data==null?null:n.form_data[t==null?null:t.name])!==null&&e!==void 0?e:"--"," ")}}function Me(a,i){if(a&1&&(h(0),d(1,ke,3,4,"span",5)(2,Fe,2,1,"span",5),f()),a&2){let e,t,n=l().$implicit,o=l().$implicit,g=l(2);r(),s("ngIf",!g.isNaN(g.Date.parse((e=o==null?null:o[n==null?null:n.name])!==null&&e!==void 0?e:o==null||o.form_data==null?null:o.form_data[n==null?null:n.name]))),r(),s("ngIf",g.isNaN(g.Date.parse((t=o==null?null:o[n==null?null:n.name])!==null&&t!==void 0?t:o==null||o.form_data==null?null:o.form_data[n==null?null:n.name])))}}function Ue(a,i){if(a&1){let e=v();c(0,"span",26)(1,"a",27),b("click",function(){m(e);let n=l(2).$implicit,o=l(2);return _(o.goToDetail(n._id))}),C(2),p()()}if(a&2){let e=l().$implicit,t=l().$implicit;r(2),T(" ",t[e==null?null:e.name]||"--"," ")}}function Re(a,i){if(a&1&&(h(0),c(1,"span",28),C(2),p(),f()),a&2){let e,t,n=l().$implicit,o=l().$implicit;r(),F("matTooltip",(e=(e=o[n.name])!==null&&e!==void 0?e:o.form_data==null?null:o.form_data[n.name])!==null&&e!==void 0?e:"--"),r(),T(" ",(t=(t=o[n.name])!==null&&t!==void 0?t:o.form_data==null?null:o.form_data[n.name])!==null&&t!==void 0?t:"--"," ")}}function Ve(a,i){if(a&1){let e=v();h(0),c(1,"app-toggle",30),b("checkedChange",function(n){m(e);let o=l(3).$implicit,g=l(2);return _(g.onToggleChange(n,o._id,o.status))}),p(),f()}if(a&2){let e=l(3).$implicit;r(),s("checked",e.isChecked)}}function De(a,i){if(a&1&&(c(0,"span",29),d(1,Ve,2,1,"ng-container",5),p()),a&2){let e=l(4);r(),s("ngIf",e.accessRight==null?null:e.accessRight.modifyRight)}}function Ee(a,i){if(a&1&&(c(0,"span"),C(1),p()),a&2){let e,t=l().$implicit,n=l().$implicit;r(),T(" ",(e=(e=n[(t==null?null:t.actual_name)||(t==null?null:t.name)])!==null&&e!==void 0?e:n.form_data==null?null:n.form_data[t==null?null:t.name])!==null&&e!==void 0?e:"--"," ")}}function He(a,i){if(a&1&&(h(0),c(1,"td"),d(2,Me,3,2,"ng-container",5)(3,Ue,3,1,"span",24)(4,Re,3,2,"ng-container",5)(5,De,2,1,"span",25)(6,Ee,2,1,"span",5),p(),f()),a&2){let e=i.$implicit;r(2),s("ngIf",(e==null?null:e.name.includes("date"))||(e==null?null:e.name.endsWith("_at"))||(e==null?null:e.name.endsWith("_app_login"))),r(),s("ngIf",(e==null?null:e.name)==="name"),r(),s("ngIf",e.name==="assigned_beat"),r(),s("ngIf",(e==null?null:e.name)==="status"),r(),s("ngIf",!(e!=null&&e.name.includes("date")||e!=null&&e.name.endsWith("_at")||e!=null&&e.name.endsWith("_app_login")||(e==null?null:e.name)==="status"||(e==null?null:e.name)==="name"||e.name==="assigned_beat"))}}function Ae(a,i){if(a&1){let e=v();c(0,"app-icon-button",31),b("clickEvent",function(){m(e);let n=l().$implicit,o=l(2);return _(o.delete(n._id,"user/delete","User Delete"))}),p()}a&2&&s("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")("tooltipText","Delete User")}function Be(a,i){if(a&1){let e=v();c(0,"tr",17)(1,"td",18),C(2),p(),d(3,He,7,5,"ng-container",19),c(4,"td")(5,"div",20)(6,"button",21),b("click",function(){let n=m(e).$implicit,o=l(2);return _(o.resetDevice(n._id))}),S(7,"i",22),C(8," Reset Device "),p(),d(9,Ae,1,3,"app-icon-button",23),p()()()}if(a&2){let e=i.$implicit,t=i.index,n=l(2);k("bg-gray-400",n.isHighlighted(e._id)),r(2),V((n.pagination.cur_page-1)*n.pagination.limit+t+1),r(),s("ngForOf",n.visibleHeaders),r(3),s("disabled",!(n.accessRight!=null&&n.accessRight.modifyRight&&(e!=null&&e.device_info)&&n.activeTab===4)),r(3),s("ngIf",n.accessRight.modifyRight)}}function Oe(a,i){if(a&1&&(h(0),d(1,Be,10,6,"tr",16),f()),a&2){let e=l();r(),s("ngForOf",e.listing)}}function Pe(a,i){a&1&&(c(0,"td",35),S(1,"app-skeleton"),p()),a&2&&(r(),L("h20 bg-skeleton"))}function $e(a,i){a&1&&(c(0,"tr",33),d(1,Pe,2,2,"td",34),p()),a&2&&(r(),s("ngForOf",x(1,w).constructor(11)))}function Ne(a,i){a&1&&(h(0),d(1,$e,2,2,"tr",32),f()),a&2&&(r(),s("ngForOf",x(1,w).constructor(16)))}function je(a,i){a&1&&(h(0),S(1,"app-data-not-found"),f())}var Ce=class a{constructor(i,e,t,n,o,g,Ke,Qe,We,qe,Ye,Ge){this.toastr=i;this.api=e;this.logService=t;this.alert=n;this.router=o;this.dialog=g;this.fb=Ke;this.moduleService=Qe;this.comanFuncation=We;this.dateService=qe;this.highlightService=Ye;this.CommonApiService=Ge;this.range=this.fb.group({start:new y(null),end:new y(null)})}reusableTable;Date=Date;isNaN=isNaN;disabled=!1;filter={};sorting={};range;skLoading=!0;FORMID=pe;fieldTypes=K;moduleFormId;subModule;moduleTableId;isChecked=!1;isApiLoaded=!1;listing=[];pagination={};page=1;mainTabs=[];activeTab;highlightedId;pageKey="user-list";accessRight={};ngOnInit(){let i=this.highlightService.getHighlight(this.pageKey);i!=null&&(this.activeTab=i.tab,this.highlightedId=i.rowId,this.pagination.cur_page=i.pageIndex,this.filter=i.filters,this.highlightService.clearHighlight(this.pageKey));let e=this.moduleService.getAccessMap("Masters","Users");e&&(this.accessRight=e);let t=this.moduleService.getSubModuleByName("Masters","Users"),n=this.moduleService.getFormById("Masters","Users",this.FORMID.ID.UserForm),o=this.moduleService.getTableById("Masters","Users",this.FORMID.ID.UserTable);t&&(this.subModule=t),n&&(this.moduleFormId=n.form_id),o&&(this.moduleTableId=o.table_id),this.getMainTabs()}onTabChange(i){this.isApiLoaded=!1,this.highlightedId||(this.pagination.cur_page=1),this.activeTab=i,this.getHeaderConfigListing()}isHighlighted(i){return this.highlightedId===i}setHighLight(i){this.comanFuncation.setHighLight(this.pageKey,i,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}onRefresh(){this.filter={},this.reusableTable.clearSearchInputs(),this.getHeaderConfigListing()}goToPage(){this.setHighLight("add"),this.router.navigate(["/apps/master/user/user-list/user-add",this.activeTab])}goToDetail(i){this.setHighLight(i),this.router.navigate(["/apps/master/user/user-list/user-detail/"+i])}tableConfigData={};visibleHeaders=[];getHeaderConfigListing(){this.CommonApiService.getHeaderConfigListing(this.moduleTableId,this.moduleFormId).subscribe(i=>{this.tableConfigData=i.data.table_data;let e=this.tableConfigData.tableHead;this.visibleHeaders=e.filter(t=>t.list_view_checked&&t.key_name_required!==!0&&t.type!=this.fieldTypes.UPLOAD),this.getList()})}getMainTabs(){this.skLoading=!0,this.api.post({},"rbac/user-list-tabs").subscribe(i=>{i.statusCode===200&&(this.mainTabs=i.data,this.mainTabs.length&&(this.highlightedId?this.activeTab=this.activeTab:this.activeTab=this.mainTabs[0].value),this.getHeaderConfigListing())})}getList(){this.skLoading=!0,this.api.post({filters:this.filter,login_type_id:this.activeTab,sorting:this.sorting,page:this.pagination.cur_page??1},"user/read").subscribe(i=>{this.isApiLoaded=!0,i.statusCode===200&&(this.skLoading=!1,this.listing=i.data,this.listing.forEach(e=>{e.status==="Active"?e.isChecked=!0:e.isChecked=!1}),this.pagination=i.pagination)})}onSortChanged(i){this.sorting={},this.sorting[i.field]=i.order,this.getList()}changeToPagination(i){i=="Previous"?this.pagination.prev&&this.page>1&&(this.page--,this.getList()):this.pagination.next&&(this.page++,this.getList())}changeToPage(i){this.page=i,this.pagination.cur_page=i,this.getList()}handleSelectionChange(i){let{category_name:e,selections:t}=i;this.filter[e]=t,this.getList()}updateSearchFilter(i){this.filter[i.name]=i.searchText,this.getList()}handleDateRangeChange(i){this.filter=i,this.getList()}delete(i,e,t){this.comanFuncation.delete(i,this.subModule,t,e,"single_action",i).subscribe(n=>{n===!0&&this.getList()})}onToggleChange(i,e,t){this.comanFuncation.statusChange(i,e,t,this.subModule,"toggle","user/update-status").subscribe(n=>{n?this.getHeaderConfigListing():this.getHeaderConfigListing()})}openMainLogModal(i){this.comanFuncation.listLogsModal(this.subModule.sub_module_id,i,this.subModule.module_type).subscribe(e=>{})}openHeaderSettingModal(){this.getHeaderConfigListing(),this.dialog.open(he,{width:"450px",panelClass:"mat-right-modal",position:{right:"0px"},data:{lastPage:"header-config",moduleFormId:this.moduleFormId,moduleTableId:this.moduleTableId,moduleName:this.subModule.title,tableConfigData:this.tableConfigData}}).afterClosed().subscribe(e=>{e===!0&&this.getHeaderConfigListing()})}resetDevice(i){this.alert.confirm("Confirm","Are you sure you want reset device","Yes, Reset!").then(e=>{e.isConfirmed&&(this.skLoading=!0,this.api.post({login_type_id:this.activeTab,_id:i},"reset-device",Q.AUTH).subscribe(t=>{t.statusCode===200&&(this.skLoading=!1,this.toastr.success(t.message,"","toast-top-right"),this.getHeaderConfigListing())}))})}static \u0275fac=function(e){return new(e||a)(u(q),u(z),u(ce),u(J),u(N),u(te),u(Y),u(ee),u(me),u(ne),u(ge),u(X))};static \u0275cmp=I({type:a,selectors:[["app-user-list"]],viewQuery:function(e,t){if(e&1&&M(ve,5),e&2){let n;U(n=R())&&(t.reusableTable=n.first)}},decls:15,vars:37,consts:[["reusableTable",""],[3,"buttonClick1","title","title1","activeitem","btnShow1","buttonText1","icon1","dataHsOverlay"],[1,"row"],[1,"col-xl-12"],[1,"box"],[4,"ngIf"],[3,"onRefresh","logBtn","button1","pageTitle","listLength","btnShow","refreshLabel","btnShow1","logsLabel","btnShow2","addBtnLabel"],[1,"box-body","pt-1"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"sortChanged","selectionChange","textSearchChange","dateRangeChange","tableHead","showCheckbox","showS_No","showSorting","showFilterRow","showAction","columns","subModule"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[1,"flex","items-center","gap-3","px-4","pt-3"],[3,"class",4,"ngFor","ngForOf"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1","px-4","pt-3"],[3,"tabs","activeTab","iconShow","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab","iconShow"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[4,"ngFor","ngForOf"],[1,"text-right"],["type","button",1,"ti-btn-sm","!py-1","btn","ti-btn","ti-btn-soft-primary",3,"click","disabled"],[1,"ri-smartphone-line","font-medium","align-middle"],[3,"icon","buttonClass","tooltipText","clickEvent",4,"ngIf"],["class","font-semibold",4,"ngIf"],["class","badge",4,"ngIf"],[1,"font-semibold"],[1,"text-primary","underline",3,"click"],[1,"ellipsis",3,"matTooltip"],[1,"badge"],[3,"checkedChange","checked"],[3,"clickEvent","icon","buttonClass","tooltipText"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],["class","w120",4,"ngFor","ngForOf"],[1,"w120"]],template:function(e,t){if(e&1){let n=v();c(0,"app-page-header",1),b("buttonClick1",function(){return m(n),_(t.openHeaderSettingModal())}),p(),c(1,"div",2)(2,"div",3)(3,"div",4),d(4,ye,3,2,"ng-container",5)(5,Ie,3,1,"ng-container",5),c(6,"app-page-sub-header",6),b("onRefresh",function(){return m(n),_(t.onRefresh())})("logBtn",function(){return m(n),_(t.openMainLogModal())})("button1",function(){return m(n),_(t.goToPage())}),p(),c(7,"div",7)(8,"div",8)(9,"spk-reusable-tables",9,0),b("sortChanged",function(g){return m(n),_(t.onSortChanged(g))})("selectionChange",function(g){return m(n),_(t.handleSelectionChange(g))})("textSearchChange",function(g){return m(n),_(t.updateSearchFilter(g))})("dateRangeChange",function(g){return m(n),_(t.handleDateRangeChange(g))}),d(11,Oe,2,1,"ng-container",5),p(),d(12,Ne,2,2,"ng-container",5)(13,je,2,0,"ng-container",5),p()(),c(14,"app-pagination-footer",10),b("preButtonClick",function(){return m(n),_(t.changeToPagination("Previous"))})("nextButtonClick",function(){return m(n),_(t.changeToPagination("Next"))})("pageChange",function(g){return m(n),_(t.changeToPage(g))}),p()()()()}e&2&&(s("title","Master Modules")("title1",x(36,Te))("activeitem","User List")("btnShow1",t.accessRight==null?null:t.accessRight.modifyRight)("buttonText1","Header Config")("icon1","settings")("dataHsOverlay","#user-header-config"),r(4),s("ngIf",t.skLoading),r(),s("ngIf",!t.skLoading),r(),L("pt-2"),s("pageTitle","User List")("listLength",t.listing.total)("btnShow",!0)("refreshLabel","Refresh")("btnShow1",!0)("logsLabel","Logs")("btnShow2",t.accessRight==null?null:t.accessRight.addRight)("addBtnLabel","Add User"),r(3),s("tableHead","border-b")("showCheckbox",!1)("showS_No",!0)("showSorting",!0)("showFilterRow",!0)("showAction",!0)("columns",t.visibleHeaders)("subModule",t.subModule),r(2),s("ngIf",!t.skLoading),r(),s("ngIf",t.skLoading),r(),s("ngIf",!t.listing.length&&t.isApiLoaded),r(),s("currentPage",t.pagination.cur_page)("totalPage",t.pagination.total_pages)("pageLimit",t.pagination.limit)("listLength",t.listing.length)("preBtn",!t.pagination.prev)("nextBtn",!t.pagination.next))},dependencies:[le,B,O,_e,Z,re,oe,fe,de,be,se,ie,P,$,j,ae,G,ue,W],encapsulation:2})};export{Ce as UserListComponent};
