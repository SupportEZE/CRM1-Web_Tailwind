import{a as Oe}from"./chunk-7X2DQYED.js";import{a as Ae,b as Pe}from"./chunk-MDYR4YIM.js";import"./chunk-PU6S26UW.js";import{a as Be}from"./chunk-54KZ5YIV.js";import{a as Qe}from"./chunk-JUPJFX3F.js";import{a as Ne}from"./chunk-SQZ3YN6N.js";import{c as Fe}from"./chunk-CIBZCVJQ.js";import"./chunk-OTFCGVEU.js";import{a as Ve}from"./chunk-HPLI5COI.js";import"./chunk-CNF4GSI7.js";import{a as we}from"./chunk-OEHD5D2Y.js";import{a as Le}from"./chunk-GLWQGYBC.js";import{a as he}from"./chunk-DC4QM32I.js";import{B as ke,F as qe,c as ge,g as Ee,q as Ie,s as Te,w as Me}from"./chunk-VHE3PQ3O.js";import{$ as ue,A as k,Aa as be,B as te,C as ie,D as ne,Ea as ve,F as ae,G as oe,Ga as ye,H as re,I as le,M as pe,P as se,Qa as Ce,S as ce,T as de,V as me,Z as _e,Za as De,hb as Se,va as xe,w as X,wa as fe,z as ee}from"./chunk-GYDYF5F3.js";import{K,M as U,e as W,f as j,g as G,n as Y,o as J,t as Z}from"./chunk-PD5VTTIY.js";import{$c as H,Aa as u,Ba as g,Fc as q,G as P,Gc as V,Hb as R,Hc as F,K as O,Mc as r,Nc as h,Ob as _,Oc as m,Pc as z,Uc as L,Vc as N,Wc as B,Yc as I,_b as s,bc as b,ed as f,fc as $,fd as M,gd as D,kc as a,lc as t,mc as w,nc as v,oc as y,qc as E,rb as i,sb as C,wc as x,yc as d}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{a as Q,b as A}from"./chunk-66YHNWRR.js";var $e=["couponInput"],ze=["dispatchLabel"],He=()=>["Dispatch"],T=()=>[],We=(o,n,e)=>({"bg-green-500":o,"bg-yellow-400":n,"bg-red-500":e});function je(o,n){o&1&&(a(0,"div",13),w(1,"app-skeleton"),t()),o&2&&(i(),b("w180"))}function Ge(o,n){o&1&&(a(0,"div",13),w(1,"app-skeleton"),t()),o&2&&(i(),b("w180"))}function Ye(o,n){o&1&&(v(0),a(1,"div",9)(2,"app-showcode-card",10)(3,"div")(4,"div",11),_(5,je,2,2,"div",12),t()()()(),a(6,"div",9)(7,"app-showcode-card",10)(8,"div")(9,"div",11),_(10,Ge,2,2,"div",12),t()()()(),y()),o&2&&(i(2),s("titleView",!1)("view",!1),i(3),s("ngForOf",I(6,T).constructor(9)),i(2),s("titleView",!1)("view",!1),i(3),s("ngForOf",I(7,T).constructor(9)))}function Je(o,n){o&1&&(a(0,"div",44),w(1,"spk-input",45,1),t()),o&2&&(i(),b("focus-input"),s("fieldReq",!0)("maxlength",16)("minlength",16))}function Ze(o,n){if(o&1&&(a(0,"tr",47)(1,"td",48),r(2),t(),a(3,"td",49),r(4),t(),a(5,"td",50),r(6),t()()),o&2){let e=n.$implicit,p=n.index;s("ngClass",e.status==="Pending"?"bg-yellow-500":e.status==="Item Dispatched."?"bg-green-500":"bg-red-500"),i(2),h(p+1),i(2),h(e.qr_code?e.qr_code:"---"),i(2),h(e.status)}}function Ke(o,n){if(o&1&&(a(0,"div",22)(1,"spk-reusable-tables",23),_(2,Ze,7,4,"tr",46),t()()),o&2){let e=d(3);i(),s("columns",e.getColumns("que-item"))("showAction",!1),i(),s("ngForOf",e.queScanList)}}function Ue(o,n){if(o&1){let e=E();v(0),a(1,"app-showcode-card",32)(2,"ul",16)(3,"li")(4,"form",33)(5,"div",34)(6,"div",35)(7,"spk-ng-select",36),x("searchChanged",function(l){u(e);let c=d(2);return g(c.onSearch(l))}),t()(),_(8,Je,3,5,"div",37),t()()()()(),a(9,"app-showcode-card",15)(10,"ul",16)(11,"li")(12,"div",38)(13,"div",39)(14,"div")(15,"span",40)(16,"span",41),r(17),t(),r(18," / "),a(19,"span",42),r(20),t()()()()()()(),_(21,Ke,3,3,"div",43),t(),y()}if(o&2){let e,p=d(2);i(),b("text-primarytint1color"),s("boxHeader","pt-3")("classbody","pt-0")("titleView",!1),i(3),s("formGroup",p.dispatchForm),i(3),s("fieldReq",!0)("search",!0)("options",p.dropDownList)("multiple",!1),i(),s("ngIf",(e=p.dispatchForm.get("master_box_code"))==null?null:e.value),i(),b("text-primarytint1color"),s("title","Scanning V/S Pending Product")("boxHeader","pt-3")("classbody","pt-0")("titleView",!0),i(8),m(" ",p.count.scanned_quantity?p.count.scanned_quantity:0," "),i(2),s("ngClass",p.count.scanned_quantity===p.count.planned_qty?"text-green":"text-danger"),i(),m(" ",p.count.planned_qty?p.count.planned_qty:0," "),i(),s("ngIf",p.queScanList.length>0)}}function Xe(o,n){if(o&1){let e=E();a(0,"button",51),x("click",function(){u(e);let l=d(2);return l.filter.label="",g(l.getMasterCodes())}),a(1,"mat-icon"),r(2,"close"),t()()}}function et(o,n){if(o&1){let e=E();a(0,"app-icon-button",61),x("clickEvent",function(){u(e);let l=d().$implicit,c=d(3);return g(c.openDialog("manual",l,l.label))}),t()}o&2&&s("icon","ri-add-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-success waves-effect waves-light")}function tt(o,n){if(o&1){let e=E();a(0,"app-icon-button",62),x("clickEvent",function(){u(e);let l=d().$implicit,c=d(3);return g(c.delete(l._id,"qr-code/delete-master-box","Dispatch"))}),t()}if(o&2){let e=d().$implicit;s("icon","ri-subtract-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")("matTooltip",(e==null||e.item==null?null:e.item.length)>0||(e==null||e.box==null?null:e.box.length)>0?"Disabled":"Delete Master Box")}}function it(o,n){if(o&1){let e=E();a(0,"tr",53)(1,"td",48),r(2),t(),a(3,"td",54),r(4),t(),a(5,"td",55)(6,"a",56),x("click",function(){let l=u(e).$implicit,c=d(3);return g((l==null||l.box==null?null:l.box.length)>0?c.openDialog("box-item",l.box,l.label):c.alertError(l.label))}),r(7),t()(),a(8,"td",57)(9,"a",56),x("click",function(){let l=u(e).$implicit,c=d(3);return g((l==null||l.item==null?null:l.item.length)>0?c.openDialog("item",l.item,l.label):c.alertError(l.label))}),r(10),t()(),a(11,"td",57)(12,"app-icon-button",58),x("clickEvent",function(){let l=u(e).$implicit,c=d(3);return c.printType="single-master-item",g(c.printMasterbox(l.item,"single-master-item",l.label))}),t(),_(13,et,1,2,"app-icon-button",59)(14,tt,1,3,"app-icon-button",60),t()()}if(o&2){let e=n.$implicit,p=n.index,l=d(3);i(2),h((l.pagination.cur_page-1)*l.pagination.limit+p+1),i(2),h(e.label?e.label:"---"),i(2),s("matTooltip",(e==null||e.box==null?null:e.box.length)>0?"View Detail":"Item not linked yet"),i(),m(" ",(e==null||e.box==null?null:e.box.length)||0," "),i(2),s("matTooltip",(e==null||e.item==null?null:e.item.length)>0?"View Detail":"Item not linked yet"),i(),m(" ",(e==null||e.item==null?null:e.item.length)||0," "),i(2),s("icon","ri-printer-line")("disabled",(e==null||e.item==null?null:e.item.length)===0&&(e==null||e.box==null?null:e.box.length)===0)("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light")("matTooltip",(e==null||e.item==null?null:e.item.length)===0&&(e==null||e.box==null?null:e.box.length)===0?"Disabled":"Print Master Box Sticker"),i(),s("ngIf",(l.count.planned_qty?l.count.planned_qty:0)!=(l.count.scanned_quantity?l.count.scanned_quantity:0)),i(),s("ngIf",(e==null||e.item==null?null:e.item.length)===0&&(e==null||e.box==null?null:e.box.length)===0)}}function nt(o,n){if(o&1&&(v(0),_(1,it,15,12,"tr",52),y()),o&2){let e=d(2);i(),s("ngForOf",e.masterQrList)}}function at(o,n){o&1&&(a(0,"td"),w(1,"app-skeleton"),t()),o&2&&(i(),b("h20 bg-skeleton"))}function ot(o,n){o&1&&(a(0,"tr",24),_(1,at,2,2,"td",64),t()),o&2&&(i(),s("ngForOf",I(1,T).constructor(5)))}function rt(o,n){o&1&&(v(0),_(1,ot,2,2,"tr",63),y()),o&2&&(i(),s("ngForOf",I(1,T).constructor(5)))}function lt(o,n){o&1&&(v(0),w(1,"app-data-not-found"),y())}function pt(o,n){if(o&1){let e=E();a(0,"div",49)(1,"mat-form-field",67)(2,"input",68,2),B("ngModelChange",function(l){u(e);let c=d().$implicit;return N(c.planned_qty,l)||(c.planned_qty=l),g(l)}),t()(),a(4,"app-icon-button",69),x("clickEvent",function(){u(e);let l=d().$implicit,c=d(3);return g(c.updateQty(l))}),t()()}if(o&2){let e=d().$implicit,p=d(3);i(2),L("ngModel",e.planned_qty),i(2),s("icon","ri-save-line")("matTooltip","Decrease Qty")("disabled",p.api.disabled)("buttonClass","ti-btn ti-btn-icon ti-btn-success  btn-wave ml-2")}}function st(o,n){if(o&1&&(v(0),r(1),y()),o&2){let e=d().$implicit;i(),m(" ",e.planned_qty," ")}}function ct(o,n){if(o&1&&(a(0,"tr",47)(1,"td",48),r(2),t(),a(3,"td",65),r(4),t(),a(5,"td",57),_(6,pt,5,5,"div",66)(7,st,2,1,"ng-container",5),t(),a(8,"td",48),r(9),t()()),o&2){let e=n.$implicit,p=n.index;s("ngClass",H(7,We,e.scanned_quantity===e.planned_qty,e.scanned_quantity>0&&e.scanned_quantity!==e.planned_qty,e.scanned_quantity===0)),i(2),h(p+1),i(2),z(" ",e.product_name?e.product_name:"---"," - ",e.product_code?e.product_code:"---"," "),i(2),s("ngIf",e.qty!=e.scanned_quantity),i(),s("ngIf",e.qty===e.scanned_quantity),i(2),h(e.scanned_quantity?e.scanned_quantity:"0")}}function dt(o,n){if(o&1&&(v(0),_(1,ct,10,11,"tr",46),y()),o&2){let e=d(2);i(),s("ngForOf",e.itemList)}}function mt(o,n){o&1&&(a(0,"td"),w(1,"app-skeleton"),t()),o&2&&(i(),b("h20 bg-skeleton"))}function _t(o,n){o&1&&(a(0,"tr",24),_(1,mt,2,2,"td",64),t()),o&2&&(i(),s("ngForOf",I(1,T).constructor(4)))}function ut(o,n){o&1&&(v(0),_(1,_t,2,2,"tr",63),y()),o&2&&(i(),s("ngForOf",I(1,T).constructor(3)))}function gt(o,n){o&1&&(v(0),w(1,"app-data-not-found"),y())}function ht(o,n){if(o&1){let e=E();v(0),a(1,"div",14)(2,"app-showcode-card",15)(3,"ul",16)(4,"li")(5,"div",17)(6,"div",18)(7,"div")(8,"span",19),r(9),t(),a(10,"span",20),r(11,"Company Name"),t()()(),a(12,"div",18)(13,"div")(14,"span",19),r(15),f(16,"titlecase"),t(),a(17,"span",20),r(18,"Account Code"),t()()(),a(19,"div",18)(20,"div")(21,"span",19),r(22),f(23,"titlecase"),t(),a(24,"span",20),r(25,"Contact Person"),t()()(),a(26,"div",18)(27,"div")(28,"span",19),r(29),t(),a(30,"span",20),r(31,"Contact Details"),t()()(),a(32,"div",18)(33,"div")(34,"span",19),r(35),t(),a(36,"span",20),r(37,"Address"),t()()()()()()(),_(38,Ue,22,21,"ng-container",5),t(),a(39,"div",14)(40,"app-showcode-card",15)(41,"ul",16)(42,"li")(43,"div",17)(44,"div",18)(45,"div")(46,"span",19),r(47),f(48,"date"),t(),a(49,"span",20),r(50,"Order Date"),t()()(),a(51,"div",18)(52,"div")(53,"span",19),r(54),t(),a(55,"span",20),r(56,"Billing Company"),t()()(),a(57,"div",18)(58,"div")(59,"span",19),r(60),f(61,"titlecase"),t(),a(62,"span",20),r(63,"Dispatch Type"),t()()(),a(64,"div",18)(65,"div")(66,"span",19),r(67),t(),a(68,"span",20),r(69,"Order Number"),t()()(),a(70,"div",18)(71,"div")(72,"span",19),r(73),t(),a(74,"span",20),r(75,"Total Item"),t()()(),a(76,"div",18)(77,"div")(78,"span",19),r(79),t(),a(80,"span",20),r(81,"Total Item QTY."),t()()(),a(82,"div",18)(83,"div")(84,"span",19),r(85),t(),a(86,"span",20),r(87,"Shipping Address"),t()()()()()()(),a(88,"app-showcode-card",21),x("action",function(){u(e);let l=d();return g(l.printMaster())})("onSingleSelectChange",function(l){u(e);let c=d();return g(c.onSingleSelectChange(l))}),a(89,"div",22)(90,"spk-reusable-tables",23)(91,"tr",24)(92,"td",25),r(93,"\xA0"),t(),a(94,"td",25)(95,"div",26)(96,"mat-form-field",27)(97,"input",28),B("ngModelChange",function(l){u(e);let c=d();return N(c.filter.label,l)||(c.filter.label=l),g(l)}),x("keyup.enter",function(){u(e);let l=d();return g(l.getMasterCodes(l.filter.label))}),t(),_(98,Xe,3,0,"button",29),t()()(),a(99,"td",25),r(100,"\xA0"),t(),a(101,"td",25),r(102,"\xA0"),t(),a(103,"td",25),r(104,"\xA0"),t()(),_(105,nt,2,1,"ng-container",5)(106,rt,2,2,"ng-container",5),t(),_(107,lt,2,0,"ng-container",5),t(),a(108,"app-pagination-footer",30),x("preButtonClick",function(){u(e);let l=d();return g(l.changeToPagination("Previous"))})("nextButtonClick",function(){u(e);let l=d();return g(l.changeToPagination("Next"))})("pageChange",function(l){u(e);let c=d();return g(c.changeToPage(l))}),t()(),a(109,"app-showcode-card",31),x("action",function(){u(e);let l=d();return l.printType="all-item",g(l.printMasterbox())}),a(110,"div",22)(111,"spk-reusable-tables",23),_(112,dt,2,1,"ng-container",5)(113,ut,2,2,"ng-container",5)(114,gt,2,0,"ng-container",5),t()()()(),y()}if(o&2){let e=d();i(2),b("text-primarytint1color"),s("title","Customer Details")("boxHeader","pt-3")("classbody","pt-0")("titleView",!0),i(7),m(" ",e.dispatchDetail.company_name?e.dispatchDetail.company_name:"---"," "),i(6),m(" ",e.dispatchDetail.customer_code?M(16,67,e.dispatchDetail.customer_code):"---"," "),i(7),m(" ",e.dispatchDetail.customer_name?M(23,69,e.dispatchDetail.customer_name):"---"," "),i(7),m(" ",e.dispatchDetail.mobile?e.dispatchDetail.mobile:"---"," "),i(6),m(" ",e.dispatchDetail.customer_address?e.dispatchDetail.customer_address:"---"," "),i(3),s("ngIf",(e.count.planned_qty?e.count.planned_qty:0)!=(e.count.scanned_quantity?e.count.scanned_quantity:0)),i(2),b("text-primarytint1color"),s("title","Order Details")("boxHeader","pt-3")("classbody","pt-0")("titleView",!0),i(7),m(" ",e.dispatchDetail.order_date?D(48,71,e.dispatchDetail.order_date,"dd MMM yyyy"):"---"," "),i(7),m(" ",e.dispatchDetail.billing_company?e.dispatchDetail.billing_company:"---"," "),i(6),m(" ",e.dispatchDetail.dispatch_from?M(61,74,e.dispatchDetail.dispatch_from):"---"," "),i(7),m(" ",e.dispatchDetail.order_no?e.dispatchDetail.order_no:"---"," "),i(6),m(" ",e.count.total_items?e.count.total_items:0," "),i(6),m(" ",e.count.planned_qty?e.count.planned_qty:0," "),i(6),m(" ",e.dispatchDetail.shipping_address?e.dispatchDetail.shipping_address:"---"," "),i(3),b("text-primarytint1color"),s("title","Master Box Detail")("boxHeader","pt-0")("classbody","pt-0")("titleView",!0)("disabled",e.printLoading)("actionIcons",!0)("iconClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-success waves-effect waves-light mt27")("iconName",e.printLoading?"ri-loader-line animate-spin":"ri-printer-line")("labelName","Party Marka")("filterLabel",!0)("showSelectOption",!0)("optionArray",e.marka)("filterForm",e.filterForm),i(2),s("columns",e.getColumns("master"))("showAction",!1),i(7),L("ngModel",e.filter.label),i(),$(e.filter.label?98:-1),i(7),s("ngIf",!e.masterQrLoading),i(),s("ngIf",e.masterQrLoading&&e.masterQrList.length===0),i(),s("ngIf",e.masterQrList.length===0&&!e.masterQrLoading),i(),s("currentPage",e.pagination.cur_page)("totalPage",e.pagination.total_pages)("pageLimit",e.pagination.limit)("listLength",e.masterQrList.length)("preBtn",!e.pagination.prev)("nextBtn",!e.pagination.next),i(),b("text-primarytint1color"),s("title","Product Details")("boxHeader","pt-3")("classbody","pt-0")("titleView",!0)("actionIcons",!0)("iconClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-success waves-effect waves-light")("iconName","ri-printer-line"),i(2),s("columns",e.getColumns("product"))("showAction",!1),i(),s("ngIf",!e.itemLoading),i(),s("ngIf",e.itemLoading),i(),s("ngIf",e.itemList.length===0&&!e.itemLoading)}}function xt(o,n){if(o&1&&(a(0,"tr")(1,"td",80),r(2),f(3,"truncateChars"),t(),a(4,"td",81),r(5),t()()),o&2){let e=n.$implicit;i(2),m(" ",D(3,2,e.product_name+("- "+e.product_code),74)," "),i(3),h(e.qty?e.qty:"0")}}function ft(o,n){if(o&1&&(a(0,"div",70)(1,"h2",71),r(2),t(),a(3,"div",72)(4,"div",73)(5,"p",74)(6,"strong"),r(7,"Company Name : "),t(),r(8),f(9,"truncateChars"),t(),a(10,"p",74)(11,"strong"),r(12,"Marka. : "),t(),r(13),t(),a(14,"p",74)(15,"strong"),r(16,"Order No. : "),t(),r(17),t(),a(18,"p",74)(19,"strong"),r(20,"Order Date : "),t(),r(21),f(22,"date"),t(),a(23,"p",74)(24,"strong"),r(25,"Master Box Serial No. : "),t(),r(26),t(),a(27,"p",74)(28,"strong"),r(29,"Master Box Total QTY. : "),t(),r(30),t()(),a(31,"div",75),w(32,"qrcode",76),t()(),a(33,"table",77)(34,"tr")(35,"td",78),r(36," Product Detail"),t(),a(37,"td",79),r(38," Dispatch QTY."),t()(),_(39,xt,6,5,"tr",64),t()()),o&2){let e=d();i(2),h(e.dispatchDetail.billing_company?e.dispatchDetail.billing_company:"---"),i(6),m(" ",e.dispatchDetail.company_name?D(9,21,e.dispatchDetail.company_name,50):"N/A",""),i(5),m(" ",e.markaValue?e.markaValue:"N/A",""),i(4),m(" ",e.dispatchDetail.order_no?e.dispatchDetail.order_no:"N/A",""),i(4),m(" ",e.dispatchDetail.order_date?D(22,24,e.dispatchDetail.order_date,"dd MMM yyyy"):"N/A",""),i(5),h(e.masterPrintData.masterBoxNumber),i(4),h(e.totalMasterQty),i(2),s("qrdata","MBV8E1ZQQIJRV7Y9")("allowEmptyString",!0)("ariaLabel","QR Code image with the following content...")("cssClass","center")("colorDark","#000000ff")("colorLight","#ffffffff")("elementType","img")("errorCorrectionLevel","M")("imageHeight",25)("imageWidth",25)("margin",4)("scale",1)("width",90),i(7),s("ngForOf",e.masterPrintData.item)}}function bt(o,n){if(o&1&&(a(0,"tr")(1,"td",81),r(2),t(),a(3,"td",80),r(4),f(5,"truncateChars"),t(),a(6,"td",86),r(7),t()()),o&2){let e=n.$implicit,p=d().$implicit;i(2),h(p.label),i(2),m(" ",D(5,3,e.product_name+e.product_code,74)," "),i(3),h(e.qty)}}function vt(o,n){if(o&1&&(v(0),_(1,bt,8,6,"tr",64),y()),o&2){let e=n.$implicit;i(),s("ngForOf",e.pdf_products)}}function yt(o,n){if(o&1&&(a(0,"div",70)(1,"h2",71),r(2),t(),a(3,"div",82)(4,"p",83)(5,"strong"),r(6,"Company Name : "),t(),r(7),f(8,"truncateChars"),t(),a(9,"p",83)(10,"strong"),r(11,"Marka. : "),t(),r(12),t(),a(13,"p",83)(14,"strong"),r(15,"Order No. : "),t(),r(16),t(),a(17,"p",83)(18,"strong"),r(19,"Order Date : "),t(),r(20),f(21,"date"),t(),a(22,"p",83)(23,"strong"),r(24,"Total Master Box : "),t(),r(25),t()(),a(26,"table",77)(27,"tr")(28,"td",84),r(29,"Master Box Number"),t(),a(30,"td",78),r(31," Product Detail"),t(),a(32,"td",85),r(33," Dispatch QTY."),t()(),_(34,vt,2,1,"ng-container",64),t()()),o&2){let e=d();i(2),h(e.dispatchDetail.billing_company?e.dispatchDetail.billing_company:"---"),i(5),m(" ",e.dispatchDetail.company_name?D(8,7,e.dispatchDetail.company_name,50):"N/A",""),i(5),m(" ",e.markaValue?e.markaValue:"N/A",""),i(4),m(" ",e.dispatchDetail.order_no?e.dispatchDetail.order_no:"N/A",""),i(4),m(" ",e.dispatchDetail.order_date?D(21,10,e.dispatchDetail.order_date,"dd MMM yyyy"):"N/A",""),i(5),h(e.pdfMasterQr.length),i(9),s("ngForOf",e.pdfMasterQr)}}function Ct(o,n){if(o&1&&(a(0,"tr")(1,"td",89),r(2),t(),a(3,"td",80),r(4),f(5,"truncateChars"),t(),a(6,"td",90),r(7),t(),a(8,"td",81),r(9),t()()),o&2){let e=n.$implicit,p=n.index;i(2),h(p+1),i(2),m(" ",e.product_name?D(5,4,e.product_name+("-"+e.product_code),74):"---"," "),i(3),h(e.planned_qty?e.planned_qty:"0"),i(2),h(e.scanned_quantity?e.scanned_quantity:"0")}}function Dt(o,n){if(o&1&&(a(0,"div",70)(1,"h2",71),r(2),t(),a(3,"div",82)(4,"p",83)(5,"strong"),r(6,"Company Name : "),t(),r(7),f(8,"truncateChars"),t(),a(9,"p",83)(10,"strong"),r(11,"Marka. : "),t(),r(12),t(),a(13,"p",83)(14,"strong"),r(15,"Order No. : "),t(),r(16),t(),a(17,"p",83)(18,"strong"),r(19,"Order Date : "),t(),r(20),f(21,"date"),t(),a(22,"p",83)(23,"strong"),r(24,"Total Master Box : "),t(),r(25),t()(),a(26,"table",77)(27,"tr")(28,"td",87),r(29,"S.No"),t(),a(30,"td",78),r(31," Product Detail"),t(),a(32,"td",88),r(33,"QTY."),t(),a(34,"td",79),r(35," Dispatched QTY."),t()(),_(36,Ct,10,7,"tr",64),t()()),o&2){let e=d();i(2),h(e.dispatchDetail.billing_company?e.dispatchDetail.billing_company:"---"),i(5),m(" ",e.dispatchDetail.company_name?D(8,7,e.dispatchDetail.company_name,50):"N/A",""),i(5),m(" ",e.markaValue,""),i(4),m(" ",e.dispatchDetail.order_no?e.dispatchDetail.order_no:"N/A",""),i(4),m(" ",e.dispatchDetail.order_date?D(21,10,e.dispatchDetail.order_date,"dd MMM yyyy"):"N/A",""),i(5),h(e.dropDownList.length),i(11),s("ngForOf",e.itemList)}}var Re=class o{constructor(n,e,p,l,c,S,St,wt,Et,It){this.route=n;this.router=e;this.toastr=p;this.fb=l;this.dialog=c;this.moduleService=S;this.comanFuncation=St;this.removeSpace=wt;this.api=Et;this.alert=It}couponInputComponent;dispatchLabel;dispatchForm=new ne({});filter={};id={};skLoading=!1;dispatchDetail={};itemList=[];masterQrList=[];dropDownList=[];count={};itemLoading=!1;masterQrLoading=!1;btnFlag=!1;pagination={};queScanList=[];printType;filterForm;FORMID=Ve;submodule={};pageType={};masterPrintData={};markaValue;ngOnInit(){this.filterForm=this.fb.group({select_value:[null]}),this.dispatchForm=this.fb.group({master_box_code:["",k.required],qr_code:["",[k.minLength(16),k.maxLength(16)]]});let n=this.moduleService.getSubModuleByName("WMS","Dispatch");n&&(this.submodule=n),this.route.paramMap.subscribe(e=>{this.id=e.get("id");let p=e.get("type");p&&(this.pageType=p),this.id&&(this.getDetail(),this.getMasterCodes(),this.getMasterDropdownCodes())}),this.dispatchForm.get("qr_code")?.valueChanges.pipe(O(150),P(e=>!!e&&e.length===16)).subscribe(e=>{this.handleCouponScan(e)})}ngAfterViewInit(){this.dispatchForm.get("master_box_code")?.valueChanges.subscribe(n=>{n&&setTimeout(()=>{this.couponInputComponent?.focusInput?.()})})}pendingQueue=[];isSending=!1;handleCouponScan(n){let e=`${n}-${Date.now()}`;this.pendingQueue.push({code:n,id:e}),this.queScanList.unshift({id:e,qr_code:n,status:"Pending",scanned_at:Date.now()}),this.dispatchForm.get("qr_code")?.setValue(""),this.processNextCode()}processNextCode(){if(this.isSending||this.pendingQueue.length===0)return;this.isSending=!0;let{code:n,id:e}=this.pendingQueue.shift(),p={dispatch_id:this.id,qr_code:n,master_box_code:this.dispatchForm.get("master_box_code")?.value};this.api.post(p,"dispatch/dispatch-qr-code").subscribe({next:l=>{let c=this.queScanList.find(S=>S.id===e);c&&(c.status=(l?.statusCode===200,l?.message),this.getItems(),this.getMasterCodes())},error:()=>{let l=this.queScanList.find(c=>c.id===e);l&&(l.status="Error")},complete:()=>{this.isSending=!1,setTimeout(()=>this.processNextCode(),200)}})}getColumns(n){return n==="master"?[{label:"Sr.No"},{label:"Master Box No."},{label:"Total Small Boxes"},{label:"Total Items"},{label:"Action"}]:n==="que-item"?[{label:"Sr.No"},{label:"Qr Code No."},{label:"Status"}]:[{label:"Sr.No"},{label:"Product Detail"},{label:"Qty."},{label:"Dispatch Qty.",table_class:"text-center"}]}marka=[];getDetail(){this.skLoading=!0,this.api.post({_id:this.id},"dispatch/detail").subscribe(n=>{if(n.statusCode===200){if(this.skLoading=!1,this.dispatchDetail=n?.data??{},this.dispatchDetail?.marka?.length&&(this.marka=this.dispatchDetail.marka.map(e=>({label:e.marka,value:e.marka})),this.marka.length===1)){let e=this.marka[0];this.filterForm.patchValue({select_value:e.value}),this.onSingleSelectChange(e.value)}this.getItems()}})}getItems(){this.itemLoading=!0,this.api.post({dispatch_id:this.id},"dispatch/items").subscribe(n=>{n.statusCode===200&&(this.itemLoading=!1,this.itemList=n?.data?.items??[],this.itemList.length>0?this.itemList=this.itemList.map(e=>A(Q({},e),{qty:e.planned_qty,plannedQtyControl:new ae(e.planned_qty||0)})):this.router.navigate(["/apps/wms/dispatch-list/order_packing"]),this.count=n?.data?.count??{})})}delete(n,e,p){this.comanFuncation.delete(n,this.submodule,p,e,"single_action",n).subscribe(l=>{l===!0&&this.getMasterCodes()})}getMasterCodes(n){this.masterQrLoading=!0,this.api.post({page:this.pagination.cur_page??1,pdf:!1,filters:{search:n},dispatch_id:this.id},"qr-code/read-master-box").subscribe(e=>{e.statusCode===200&&(this.masterQrLoading=!1,this.masterQrList=e?.data??[],this.pagination=e?.pagination??{})})}pdfMasterQr=[];printLoading=!1;printMaster(){this.printLoading=!0,this.api.post({pdf:!0,dispatch_id:this.id},"qr-code/read-master-box").subscribe(n=>{n.statusCode===200?(this.printMasterbox(),this.printType="master-all-item",this.pdfMasterQr=n?.data??[],this.printLoading=!1):this.printLoading=!1})}openDialog(n,e,p){this.dialog.open(Oe,{width:"1024px",data:{id:this.id,lastPage:n,masterbox_number:p,item:e??[]}}).afterClosed().subscribe(c=>{})}changeToPagination(n){n=="Previous"?this.pagination.prev&&this.pagination.cur_page>1&&(this.pagination.cur_page--,this.getMasterCodes()):this.pagination.next&&(this.pagination.cur_page++,this.getMasterCodes())}changeToPage(n){this.pagination.cur_page=n,this.getMasterCodes()}lastSearchTerm="";onSearch(n){let e=n?.trim()||"";e!==this.lastSearchTerm&&(this.lastSearchTerm=e,this.getMasterDropdownCodes(n))}getMasterDropdownCodes(n){this.api.post({filters:{search:n},dispatch_id:this.id},"qr-code/read-master-box-dropdown").subscribe(e=>{e.statusCode===200&&(this.dropDownList=e?.data??[])})}genrateMasterBox(){this.btnFlag=!0,this.api.post({dispatch_id:this.id},"qr-code/create-master-box").subscribe(n=>{n.statusCode===200?(this.btnFlag=!1,this.getMasterCodes(),this.getMasterDropdownCodes(),this.toastr.success(n.message,"","toast-top-right")):this.btnFlag=!1})}onSingleSelectChange(n){this.markaValue=n}alertError(n){this.toastr.warning(`Item not linked with master box ${n}`,"","toast-top-right")}totalMasterQty=0;printMasterbox(n,e,p){e==="single-master-item"&&(this.totalMasterQty=n.reduce((l,c)=>l+(+c.qty||0),0),this.dispatchDetail.marka.map(l=>({label:l.marka,value:l.marka})),this.masterPrintData={item:n,masterBoxNumber:p}),setTimeout(()=>{let l=this.dispatchLabel.nativeElement.cloneNode(!0),c=window.open("","_blank","top=0,left=0,height=100%,width=auto");c?(c.document.open(),c.document.write(`
        <html>
          <head>
            <title>Dispatch Print</title>
            <style>
              @media print {
              @page {margin: 0;}
                html, body {margin: 0; padding: 0;}
                #QR_CODE_LABEL > div { page-break-after: always; break-after: always; page-break-inside: avoid; display: block;}
                body {font-family: 'Arial', sans-serif;}
              }
            </style>
          </head>
          <body></body>
        </html>
      `),c.document.close(),setTimeout(()=>{let S=c.document.body;S&&(S.appendChild(l),c.focus(),c.print(),c.close())},500)):console.error("Popup blocked.")},500)}updateQty(n){if(Number(n.planned_qty)>Number(n.qty)){n.planned_qty=n.qty,this.toastr.error("maximum qty allowed "+Number(n.qty),"","toast-top-right");return}this.alert.confirm("Are you sure?","You want to decrease qty","Yes it!").then(e=>{e.isConfirmed&&(this.api.disabled=!0,this.api.post({dispatch_id:this.id,item_id:n._id,planned_qty:Number(n.planned_qty)},"dispatch/excess-item-return").subscribe(p=>{p.statusCode===200&&(this.api.disabled=!1,this.getItems(),this.toastr.success(p.message,"","toast-top-right"))})),e.isDismissed&&(n.planned_qty=n.qty)})}static \u0275fac=function(e){return new(e||o)(C(K),C(U),C(X),C(me),C(Ce),C(he),C(Fe),C(Be),C(_e),C(ue))};static \u0275cmp=R({type:o,selectors:[["app-dispatch-detail"]],viewQuery:function(e,p){if(e&1&&(q($e,5),q(ze,5)),e&2){let l;V(l=F())&&(p.couponInputComponent=l.first),V(l=F())&&(p.dispatchLabel=l.first)}},decls:10,vars:17,consts:[["dispatchLabel",""],["couponInput",""],["planned_qty","ngModel"],[3,"buttonClick","onsearchChange","onSingleSelectChange","title","title1","activeitem","btnShow","btnDisabled","buttonText","icon","showSelectOption","optionArray","search","filterForm"],[1,"grid","grid-cols-12","sm:gap-x-4"],[4,"ngIf"],["id","QR_CODE_LABEL"],["hidden",""],["style","width: 100mm; height: 150mm;",4,"ngIf"],[1,"xl:col-span-6","col-span-6"],[3,"titleView","view"],[1,"flex","gap-2","mb-1","flex-wrap"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"flex","items-center"],[1,"xl:col-span-6","col-span-12"],[3,"title","boxHeader","classbody","titleView"],[1,"ti-list-group","list-group-flush","border-0"],[1,"flex","items-center","gap-5","flex-wrap","text-[12px]"],[1,"flex","items-center","me-2","flex-wrap"],[1,"block","font-medium"],[1,"text-textmuted","dark:text-textmuted/50"],[3,"action","onSingleSelectChange","title","boxHeader","classbody","titleView","disabled","actionIcons","iconClass","iconName","labelName","filterLabel","showSelectOption","optionArray","filterForm"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary",3,"columns","showAction"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"table-search-filters"],[1,"table-input"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"action","title","boxHeader","classbody","titleView","actionIcons","iconClass","iconName"],[3,"boxHeader","classbody","titleView"],[3,"formGroup"],[1,"flex","items-center","gap-3","text-[12px]"],[1,"flex","items-center","me-2","flex-wrap","wp50","mt-4"],["formControlName","master_box_code","label","Select Master Box",3,"searchChanged","fieldReq","search","options","multiple"],["class","flex items-center flex-wrap wp50 mt-4",4,"ngIf"],[1,"flex","items-center","gap-2","flex-wrap","text-[12px]"],[1,"flex","items-center","me-2","flex-wrap","left-auto"],[1,"block","font-medium","text-5xl"],[1,"text-success"],[3,"ngClass"],["class","table-responsive overflow-auto table-bordered-default",4,"ngIf"],[1,"flex","items-center","flex-wrap","wp50","mt-4"],["formControlName","qr_code","label","Qr Code Number","type","text",1,"remove-default-class","wp100",3,"fieldReq","maxlength","minlength"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",3,"ngClass",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10",3,"ngClass"],[1,"text-center","w50"],[1,""],[1,"text-center","w80"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"w150"],[1,"w130"],[1,"text-primary","underline",3,"click","matTooltip"],[1,"w100"],[3,"clickEvent","icon","disabled","buttonClass","matTooltip"],["matTooltip","Add Manually",3,"icon","buttonClass","clickEvent",4,"ngIf"],[3,"icon","buttonClass","matTooltip","clickEvent",4,"ngIf"],["matTooltip","Add Manually",3,"clickEvent","icon","buttonClass"],[3,"clickEvent","icon","buttonClass","matTooltip"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"whitespace-normal"],["class","",4,"ngIf"],[1,"mat-custom-field","w60"],["type","text","matInput","","onkeypress","return (event.charCode >= 48 && event.charCode <= 57) || event.charCode == 46","type","number",3,"ngModelChange","ngModel"],[3,"clickEvent","icon","matTooltip","disabled","buttonClass"],[2,"width","100mm","height","150mm"],[2,"margin","0px","font-size","16px","font-weight","800 !important","text-align","center"],[2,"display","flex","justify-content","center"],[2,"min-width","75mm","width","75mm"],[2,"font-size","12px","margin","0px","line-height","16px","font-weight","600"],[2,"min-width","20mm","width","20mm"],[3,"qrdata","allowEmptyString","ariaLabel","cssClass","colorDark","colorLight","elementType","errorCorrectionLevel","imageHeight","imageWidth","margin","scale","width"],[2,"width","95mm","table-layout","fixed","box-sizing","border-box","border-collapse","collapse","margin-top","10px","margin","6px auto 0px auto"],[2,"line-height","14px","border","1.5px solid #000","font-size","12px","font-weight","900","padding","3px"],[2,"width","70px","line-height","14px","border","1.5px solid #000","font-size","12px","text-align","center","font-weight","900","padding","3px"],[2,"line-height","18x","border","1.5px solid #000","font-size","11px","font-weight","900","padding","2px 3px","text-transform","uppercase"],[2,"width","70px","line-height","18px","border","1.5px solid #000","font-size","11px","text-align","center","font-weight","900","padding","2px 3px"],[2,"width","95mm","margin","0px auto"],[2,"font-size","12px","margin","0px","line-height","16px","font-weight","700"],[2,"width","130px","line-height","14px","border","1.5px solid #000","font-size","12px","font-weight","900","padding","3px"],[2,"width","60px","line-height","14px","border","1.5px solid #000","font-size","12px","text-align","center","font-weight","900","padding","3px"],[2,"width","60px","line-height","18px","border","1.5px solid #000","font-size","11px","text-align","center","font-weight","900","padding","2px 3px"],[2,"width","35px","line-height","14px","border","1.5px solid #000","font-size","12px","font-weight","900","padding","3px"],[2,"width","50px","line-height","14px","border","1.5px solid #000","font-size","12px","text-align","center","font-weight","900","padding","3px"],[2,"width","35px","line-height","18px","border","1.5px solid #000","font-size","11px","font-weight","900","padding","2px 3px"],[2,"width","50px","line-height","18px","border","1.5px solid #000","font-size","11px","text-align","center","font-weight","900","padding","2px 3px"]],template:function(e,p){if(e&1){let l=E();a(0,"app-page-header",3),x("buttonClick",function(){return u(l),g(p.genrateMasterBox())})("onsearchChange",function(S){return u(l),g(p.getMasterDropdownCodes(S))})("onSingleSelectChange",function(S){return u(l),g(p.onSingleSelectChange(S))}),t(),a(1,"div",4),_(2,Ye,11,8,"ng-container",5)(3,ht,115,76,"ng-container",5),t(),a(4,"div",6,0)(6,"div",7),_(7,ft,40,27,"div",8)(8,yt,35,13,"div",8)(9,Dt,37,13,"div",8),t()()}e&2&&(s("title","WMS")("title1",I(16,He))("activeitem",p.removeSpace.formatText(p.pageType)+" Detail")("btnShow",(p.count.planned_qty?p.count.planned_qty:0)!=(p.count.scanned_quantity?p.count.scanned_quantity:0))("btnDisabled",p.btnFlag)("buttonText",p.btnFlag?"Please Wait":"Genrate Master Box")("icon","qr_code")("showSelectOption",!1)("optionArray",p.dropDownList)("search",!0)("filterForm",p.filterForm),i(2),s("ngIf",p.skLoading),i(),s("ngIf",!p.skLoading),i(4),s("ngIf",p.printType==="single-master-item"),i(),s("ngIf",p.printType==="master-all-item"),i(),s("ngIf",p.printType==="all-item"))},dependencies:[qe,W,j,G,re,ee,le,te,ie,ce,de,oe,pe,se,Me,Ee,Le,ge,Te,Ie,Ne,De,Y,J,Qe,Pe,Ae,ke,Z,Se,be,ve,ye,fe,xe,we],encapsulation:2})};export{Re as DispatchDetailComponent};
