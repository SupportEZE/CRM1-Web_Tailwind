import{a as Me}from"./chunk-3V3M5YLS.js";import{a as Ie}from"./chunk-REKAXM5L.js";import{b as Ce,c as Se}from"./chunk-CIBZCVJQ.js";import{a as w}from"./chunk-OTFCGVEU.js";import{a as ge}from"./chunk-OEHD5D2Y.js";import{a as De}from"./chunk-GLWQGYBC.js";import{a as ne}from"./chunk-DC4QM32I.js";import{B as xe,C as ye,F,c as ae,h as ue,q as fe,r as ve,s as _e,v as he,w as be}from"./chunk-VHE3PQ3O.js";import{A as N,B as W,C as X,H as Y,M as Z,Oa as oe,P as ee,Pa as re,Qa as le,Ra as pe,Ta as de,Ua as se,V as te,X as ie,Z as E,Za as me,hb as ce,w as T}from"./chunk-GYDYF5F3.js";import{K as $,N as J,Q,e as q,f as z,g as M,n as k,o as K,t as U}from"./chunk-PD5VTTIY.js";import{Aa as L,Ba as V,Bc as H,Hb as D,Mc as l,Nc as m,Ob as c,Oc as h,Yc as S,Zc as O,_b as p,ac as j,bc as b,ed as v,fd as I,gd as x,kb as R,kc as i,lb as A,lc as n,mc as g,nc as y,oc as C,qc as B,rb as t,sb as s,wc as _,yc as f}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";function Pe(o,a){o&1&&(i(0,"mat-dialog-content",7)(1,"div",8)(2,"div",9),g(3,"spk-input",10),n(),i(4,"div",9),g(5,"spk-flatpickr",11),n()()()),o&2&&(t(3),p("fieldReq",!0),t(2),p("fieldReq",!0))}var G=class o{constructor(a,e,r,d,u,Te,Ee){this.modalData=a;this.toastr=e;this.formValidation=r;this.fb=d;this.logService=u;this.api=Te;this.dialogRef=Ee;this.formIniatialized=!0}voucherForm;originalData={};formIniatialized=!1;ngOnInit(){this.voucherForm=this.fb.group({voucher_code:["",N.required],expiry_date:["",N.required]}),this.formIniatialized=!1}onSubmit(){if(this.voucherForm.valid){this.voucherForm.value.gift_id=this.modalData.gift_id;let a=!0;this.api.disabled=!0,this.api.post(this.voucherForm.value,"gift-gallery/create-voucher").subscribe(e=>{e.statusCode==200&&(this.dialogRef.close(!0),this.api.disabled=!1,this.toastr.success(e.message,"","toast-top-right"))})}else this.formValidation.markFormGroupTouched(this.voucherForm)}closeModal(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||o)(s(re),s(T),s(he),s(te),s(w),s(E),s(oe))};static \u0275cmp=D({type:o,selectors:[["app-gift-modal"]],decls:8,vars:15,consts:[[1,"mat-dialoge"],[3,"close","title","closeBtn"],[3,"ngSubmit","formGroup"],["class","mat-typography",4,"ngIf"],["align","end"],["mat-dialog-close","",3,"buttonType","buttonClass","label"],[3,"buttonType","buttonClass","disabled","formType","iconClass","loadingIconClass"],[1,"mat-typography"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xxl:col-span-6","xl:col-span-12","lg:col-span-12","md:col-span-6","col-span-12"],["label","Voucher Code","formControlName","voucher_code","type","text",1,"remove-default-class",3,"fieldReq"],["placeholder","Expiry Date","label","Expiry Date","formControlName","expiry_date",1,"form-control","custom-datepickr",3,"fieldReq"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"app-modal-header",1),v(2,"titlecase"),_("close",function(){return r.closeModal()}),n(),i(3,"form",2),_("ngSubmit",function(){return r.onSubmit()}),c(4,Pe,6,2,"mat-dialog-content",3),i(5,"mat-dialog-actions",4),g(6,"app-button",5)(7,"app-button",6),n()()()),e&2&&(t(),p("title",I(2,13,r.modalData.type)+" Voucher")("closeBtn",!0),t(2),p("formGroup",r.voucherForm),t(),p("ngIf",!r.formIniatialized),t(2),p("buttonType","button")("buttonClass","ti-btn ti-btn-outline-danger m-2")("label","Cancel"),t(),p("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("disabled",r.api.disabled)("formType","add")("iconClass","ri-save-line")("loadingIconClass","ri-loader-2-fill"))},dependencies:[ve,U,M,k,F,Y,W,X,Z,ee,be,ye,ce,pe,se,de,ue,ie],encapsulation:2})};var Re=()=>["Gift Gallery"],P=()=>[],Ae=o=>[o];function je(o,a){if(o&1&&(i(0,"div",13)(1,"div")(2,"span",14),l(3),v(4,"titlecase"),n(),i(5,"span",15),l(6,"Updated By"),n()()()),o&2){let e=f(2);t(3),h(" ",e.giftDetail.updated_name?I(4,1,e.giftDetail.updated_name):"---"," ")}}function He(o,a){if(o&1&&(i(0,"div",13)(1,"div")(2,"span",14),l(3),v(4,"date"),n(),i(5,"span",15),l(6,"Updated At"),n()()()),o&2){let e=f(2);t(3),h(" ",e.giftDetail.updated_at?x(4,1,e.giftDetail.updated_at,"dd MMM yyyy hh:mm a"):"---"," ")}}function Oe(o,a){if(o&1&&(y(0),i(1,"a",26),g(2,"img",27),n(),C()),o&2){let e=a.$implicit;t(2),H("src",e.signed_url,A)}}function qe(o,a){if(o&1){let e=B();i(0,"div")(1,"div",1)(2,"div",11)(3,"div",12)(4,"div",13)(5,"div")(6,"span",14),l(7),v(8,"date"),n(),i(9,"span",15),l(10,"Created At"),n()()(),i(11,"div",13)(12,"div")(13,"span",14),l(14),n(),i(15,"span",15),l(16,"Created By Name"),n()()(),i(17,"div",13)(18,"div")(19,"span",14),l(20),n(),i(21,"span",15),l(22,"Title "),n()()(),i(23,"div",13)(24,"div")(25,"span",14),l(26),n(),i(27,"span",15),l(28,"Customer Category"),n()()(),i(29,"div",13)(30,"div")(31,"span",14),l(32),n(),i(33,"span",15),l(34,"Eligible Points	"),n()()(),i(35,"div",16)(36,"div")(37,"div",17)(38,"span",18),l(39),n(),i(40,"app-toggle",19),_("checkedChange",function(d){L(e);let u=f();return V(u.onToggleChange(d,u.id,u.giftDetail.status))}),n()(),i(41,"span",20),l(42,"Status"),n()()(),c(43,je,7,3,"div",21)(44,He,7,4,"div",21),i(45,"div",13)(46,"div"),g(47,"span",22),i(48,"span",23),l(49,"Description"),n()()()()(),i(50,"div",24),c(51,Oe,3,1,"ng-container",25),n()()()}if(o&2){let e=f();t(7),m(x(8,14,e.giftDetail.created_at,"dd MMM yyyy hh:mm a")),t(7),m(e.giftDetail.created_name),t(6),m(e.giftDetail.title),t(6),m(e.giftDetail.customer_type_name),t(6),m(e.giftDetail.point_value?e.giftDetail.point_value+"PT":"---"),t(6),p("ngClass",e.giftDetail.status==="Active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),t(),m(e.giftDetail.status),t(),b("ti-switch-custom"),p("checked",e.giftDetail.status==="Active"),t(3),p("ngIf",e.giftDetail.updated_name),t(),p("ngIf",e.giftDetail.updated_at),t(3),p("innerHTML",e.giftDetail.description||"--",R),t(4),p("ngForOf",e.giftDetail.files)}}function ze(o,a){o&1&&(i(0,"div",30),g(1,"app-skeleton"),n()),o&2&&(t(),b("w180"))}function Ke(o,a){o&1&&(i(0,"div")(1,"div",28),c(2,ze,2,2,"div",29),n()()),o&2&&(t(2),p("ngForOf",S(1,P).constructor(10)))}function Ue(o,a){if(o&1&&(i(0,"div",31)(1,"div",32)(2,"span"),l(3,"Total Voucher"),n(),i(4,"p",33),l(5),n()(),i(6,"div",34)(7,"span"),l(8,"Redeem Voucher"),n(),i(9,"p",33),l(10),n()(),i(11,"div",35)(12,"span"),l(13,"Balance Voucher"),n(),i(14,"p",33),l(15),n()()()),o&2){let e=f();t(5),h(" ",(e.tabCount.used_count?e.tabCount.used_count:0)+(e.tabCount.available_count?e.tabCount.available_count:0)," "),t(5),h(" ",e.tabCount.used_count?e.tabCount.used_count:"0"," "),t(5),h(" ",e.tabCount.available_count?e.tabCount.available_count:"0"," ")}}function $e(o,a){if(o&1){let e=B();i(0,"tr",37)(1,"td",38),l(2),n(),i(3,"td",39),l(4),v(5,"date"),n(),i(6,"td",40),l(7),n(),i(8,"td",40),l(9),n(),i(10,"td",39),l(11),v(12,"date"),n(),i(13,"td",39)(14,"a",41),_("click",function(){let d=L(e).$implicit,u=f(2);return V(u.setHighLight(d._id))}),l(15),n()(),i(16,"td",42),l(17),n(),i(18,"td",39)(19,"span",43),l(20),n()(),i(21,"td",39),l(22),v(23,"date"),n()()}if(o&2){let e=a.$implicit,r=a.index,d=f(2);j("bg-gray-400",d.isHighlighted(e._id)),t(2),m(r+1),t(2),m(e.created_at?x(5,12,e.created_at,"dd MMM yyyy hh:mm a"):"---"),t(3),m(e.created_name?e.created_name:"---"),t(2),m(e.voucher_code?d.maskService.maskValue(e.voucher_code):"---"),t(2),m(e.expiry_date?x(12,15,e.expiry_date,"dd MMM yyyy"):"---"),t(3),p("routerLink",O(21,Ae,"/apps/customer/customer-detail/"+e.login_type_name+"/"+e.login_type_id+"/"+e.customer_type_name+"/"+e.customer_type_id+"/"+e.customer_id)),t(),h(" ",e.customer_name?e.customer_name:"---"," "),t(2),m(e.customer_type_name?e.customer_type_name:"---"),t(3),m(e.req_id?e.req_id:"---"),t(2),m(e.updated_at?x(23,18,e.updated_at,"dd MMM yyyy"):"---")}}function Je(o,a){if(o&1&&(y(0),c(1,$e,24,23,"tr",36),C()),o&2){let e=f();t(),p("ngForOf",e.vouhcer)}}function Qe(o,a){o&1&&(i(0,"td"),g(1,"app-skeleton"),n()),o&2&&(t(),b("h20 bg-skeleton"))}function We(o,a){o&1&&(i(0,"tr",45),c(1,Qe,2,2,"td",25),n()),o&2&&(t(),p("ngForOf",S(1,P).constructor(9)))}function Xe(o,a){o&1&&(y(0),c(1,We,2,2,"tr",44),C()),o&2&&(t(),p("ngForOf",S(1,P).constructor(8)))}function Ye(o,a){o&1&&(y(0),g(1,"app-data-not-found"),C())}var ke=class o{constructor(a,e,r,d,u,Te,Ee,Ze,et){this.route=a;this.api=e;this.toastr=r;this.moduleService=d;this.logService=u;this.dialog=Te;this.maskService=Ee;this.comanFuncation=Ze;this.highlightService=et}skLoading=!1;giftDetail={};vouhcer=[];submodule={};id;pagination={};filter={};mainTabs=[];tabCount={};pageKey="gift-detail";highlightedId;ngOnInit(){let a=this.moduleService.getSubModuleByName("IRP","Gift Gallery");a&&(this.submodule=a);let e=this.highlightService.getHighlight(this.pageKey);e!=null&&(this.highlightedId=e.rowId,this.pagination.cur_page=e.pageIndex,this.filter=e.filters,this.highlightService.clearHighlight(this.pageKey)),this.route.paramMap.subscribe(r=>{this.id=r.get("id"),this.id&&this.getGiftDetail()})}getColumns(){return[{label:"Created At"},{label:"Created By"},{label:"Voucher Code"},{label:"Voucher Expire Date"},{label:"Customer Detail"},{label:"Customer Type"},{label:"Redeem ID"},{label:"Transfer Date"}]}getGiftDetail(){this.skLoading=!0,this.api.post({_id:this.id},"gift-gallery/detail").subscribe(a=>{a.statusCode===200&&(this.skLoading=!1,this.giftDetail=a.data,this.getVoucherList())})}isHighlighted(a){return this.highlightedId===a}setHighLight(a){this.comanFuncation.setHighLight(this.pageKey,a,"",this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}getVoucherList(){this.skLoading=!0,this.api.post({filters:this.filter,gift_id:this.id,page:this.pagination.cur_page??1},"gift-gallery/read-voucher").subscribe(a=>{a.statusCode==200&&(this.skLoading=!1,this.vouhcer=a.data?a.data.result:[],this.tabCount=a.data?a.data.activeTab:{},this.pagination=a.pagination)})}changeToPagination(a){a==="Next"&&this.pagination.cur_page<this.pagination.total_pages?this.pagination.cur_page++:a==="Previous"&&this.pagination.cur_page>1&&this.pagination.cur_page--,this.getVoucherList()}changeToPage(a){this.pagination.cur_page=a,this.getVoucherList()}delete(a,e,r){this.comanFuncation.delete(a,this.submodule,r,e,"single_action",a).subscribe(d=>{d===!0&&this.getGiftDetail()})}openModal(a,e){this.dialog.open(G,{width:"500",data:{pageType:"item_list",type:a,data:e,gift_id:this.id}}).afterClosed().subscribe(d=>{d&&this.getGiftDetail()})}onToggleChange(a,e,r){this.comanFuncation.statusChange(a,e,r,this.submodule,"toggle","qr-code/update-status").subscribe(d=>{this.getGiftDetail()})}static \u0275fac=function(e){return new(e||o)(s($),s(E),s(T),s(ne),s(w),s(le),s(Me),s(Se),s(Ce))};static \u0275cmp=D({type:o,selectors:[["app-gift-detail"]],decls:18,vars:38,consts:[[3,"buttonClick","title","title1","activeitem","buttonText","icon","btnShow","buttonValue"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xxl:col-span-12","xl:col-span-12","lg:col-span-12","md:col-span-12","col-span-12"],[3,"title","titleView","actionIcons","iconClass","classbody","iconName"],[4,"ngIf"],[1,"xl:col-span-12","col-span-12"],["class","flex mt-3 mb-3 flex-wrap gap-2 justify-between flex-auto",4,"ngIf"],[1,"box-title"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"columns","showS_No"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[1,"xxl:col-span-9","xl:col-span-9","lg:col-span-9","md:col-span-9","col-span-9"],[1,"flex","gap-5","mb-1","flex-wrap"],[1,"flex","items-center","gap-2"],[1,"block","text-[14px]","font-medium"],[1,"text-xs","text-textmuted","dark:text-textmuted/50"],[1,"flex","items-center","me-2","gap-3","flex-wrap"],[1,"flex","gap-2"],[1,"text-[11px]","badge",3,"ngClass"],[3,"checkedChange","checked"],[1,"text-textmuted","block","dark:text-textmuted/50","font-medium"],["class","flex items-center gap-2",4,"ngIf"],[3,"innerHTML"],[1,"text-xs","block","text-textmuted","dark:text-textmuted/50"],[1,"xxl:col-span-3","xl:col-span-3","lg:col-span-3","md:col-span-3","col-span-3"],[4,"ngFor","ngForOf"],["data-gallery","gallery1",1,"box","glightbox","mb-0"],["alt","image",2,"cursor","pointer",3,"src"],[1,"flex","gap-2","mb-1","flex-wrap"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"flex","items-center"],[1,"flex","mt-3","mb-3","flex-wrap","gap-2","justify-between","flex-auto"],[1,"py-2","px-4","h60","rounded-sm","border","border-defaultborder","dark:border-defaultborder/10","border-dashed","bg-light","bg-secondary-transparent"],[1,"font-medium","text-[14px]","mb-0"],[1,"py-2","px-4","h60","rounded-sm","border","border-defaultborder","dark:border-defaultborder/10","border-dashed","bg-light","bg-danger-transparent"],[1,"py-2","px-4","h60","rounded-sm","border","border-defaultborder","dark:border-defaultborder/10","border-dashed","bg-light","bg-success-transparent"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"text-center","w50"],[1,"w150"],[1,"w110"],["matTooltip","View Profile",1,"text-primary","font-medium","underline",3,"click","routerLink"],[1,"w100"],[1,"primary-text"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"]],template:function(e,r){e&1&&(i(0,"app-page-header",0),_("buttonClick",function(){return r.openModal("add")}),n(),i(1,"div",1)(2,"div",2)(3,"app-showcode-card",3),c(4,qe,52,17,"div",4)(5,Ke,3,2,"div",4),n()(),i(6,"div",5)(7,"app-showcode-card",3),c(8,Ue,16,3,"div",6),i(9,"div")(10,"div",7),l(11,"Redeem Voucher List"),n(),i(12,"div",8)(13,"spk-reusable-tables",9),c(14,Je,2,1,"ng-container",4)(15,Xe,2,2,"ng-container",4),n(),c(16,Ye,2,0,"ng-container",4),n(),i(17,"app-pagination-footer",10),_("preButtonClick",function(){return r.changeToPagination("Previous")})("nextButtonClick",function(){return r.changeToPagination("Next")})("pageChange",function(u){return r.changeToPage(u)}),n()()()()()),e&2&&(p("title","Loyalty")("title1",S(37,Re))("activeitem","Voucher Details")("buttonText","Add New Voucher")("icon","local_activity")("btnShow",!1)("buttonValue",""),t(3),b("box-title font-medium text-[15px] block text-primarytint1color"),p("title","Basic Detail")("titleView",!0)("actionIcons",!1)("iconClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-primary waves-effect waves-light")("classbody","pt-0")("iconName","ri-pencil-line"),t(),p("ngIf",!r.skLoading),t(),p("ngIf",r.skLoading),t(2),b("box-title font-medium text-[15px] block text-primarytint1color"),p("title","Basic Detail")("titleView",!1)("actionIcons",!1)("iconClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-primary waves-effect waves-light")("classbody","pt-0")("iconName","ri-pencil-line"),t(),p("ngIf",r.skLoading),t(5),p("columns",r.getColumns())("showS_No",!0),t(),p("ngIf",!r.skLoading),t(),p("ngIf",r.skLoading),t(),p("ngIf",!r.vouhcer.length&&!r.skLoading),t(),p("currentPage",r.pagination.cur_page)("totalPage",r.pagination.total_pages)("pageLimit",r.pagination.limit)("listLength",r.vouhcer.length)("preBtn",!r.pagination.prev)("nextBtn",!r.pagination.next))},dependencies:[xe,F,q,z,M,De,ae,_e,fe,Ie,me,k,K,ge,Q,J],encapsulation:2})};export{ke as GiftDetailComponent};
