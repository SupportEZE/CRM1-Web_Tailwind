import{a as be}from"./chunk-J4NDCUAB.js";import{b as he,c as Ce}from"./chunk-CIBZCVJQ.js";import{a as fe}from"./chunk-OTFCGVEU.js";import{a as ue}from"./chunk-HPLI5COI.js";import{a as me}from"./chunk-OEHD5D2Y.js";import{a as ye}from"./chunk-GLWQGYBC.js";import{a as $}from"./chunk-DC4QM32I.js";import{F as ge,c as Z,q as de,s as pe,u as _e}from"./chunk-VHE3PQ3O.js";import{$ as X,Aa as ie,B as G,Ea as ne,G as Q,Ga as re,Ha as ae,Ia as oe,Ja as le,Qa as se,W as z,Z as J,_ as Le,hb as ce,p as K,va as ee,w as U,wa as te,z as q}from"./chunk-GYDYF5F3.js";import{M as Y,f as A,g as W,o as H,r as N,t as j}from"./chunk-PD5VTTIY.js";import{$c as B,Aa as m,Ba as d,Hb as E,Lc as F,Mc as p,Nc as h,Ob as u,Oc as O,Pc as R,Uc as y,Vc as b,Wc as x,Yc as w,Zc as D,_b as g,ac as I,bc as T,ed as k,fc as v,gd as M,kc as o,lc as a,mc as S,nc as L,oc as P,qc as f,rb as l,sb as C,wc as _,yc as c}from"./chunk-2NSPOFEK.js";import{g as Se}from"./chunk-66YHNWRR.js";var ve=Se(Le());var Pe=()=>["Primary Order"],V=()=>[],we=(r,n,e)=>({name:r,label:n,count:e}),Te=r=>[r];function Oe(r,n){r&1&&S(0,"app-page-header",11),r&2&&g("title","Primary Order")("title1",w(3,Pe))("activeitem","Primary Order List")}function ke(r,n){r&1&&S(0,"app-skeleton"),r&2&&T("w100 h25")}function Me(r,n){r&1&&(L(0),u(1,ke,1,2,"app-skeleton",12),P()),r&2&&(l(),g("ngForOf",w(1,V).constructor(6)))}function Ve(r,n){if(r&1){let e=f();o(0,"app-listing-tab",14),_("tabChange",function(t){m(e);let s=c(2);return d(s.onTabChange(t.tab))}),a()}if(r&2){let e=n.$implicit,i=c(2);g("tabs",D(6,Te,B(2,we,e.name,e.label,e.count)))("activeTab",i.activeTab)}}function Ee(r,n){if(r&1&&(L(0),u(1,Ve,1,8,"app-listing-tab",13),P()),r&2){let e=c();l(),g("ngForOf",e.mainTabs)}}function Ie(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.created_name="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function Fe(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.order_no="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function Re(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.customer_category="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function De(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.customer_detail="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function Be(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.customer_code="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function Ae(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.state="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function We(r,n){if(r&1){let e=f();o(0,"button",23),_("click",function(){m(e);let t=c(2);return t.filter.district="",d(t.getList())}),o(1,"mat-icon"),p(2,"close"),a()()}}function He(r,n){if(r&1){let e=f();o(0,"tr",24)(1,"td",25),p(2),a(),o(3,"td"),p(4),k(5,"date"),a(),o(6,"td"),p(7),a(),o(8,"td")(9,"a",26),_("click",function(){let t=m(e).$implicit,s=c(2);return d(s.goToDetailPage(t._id))}),p(10),a()(),o(11,"td"),p(12),a(),o(13,"td")(14,"div",27)(15,"span",28),p(16),a(),o(17,"span",29)(18,"span",30),p(19,"Mobile: "),a(),p(20),a()()(),o(21,"td",31),p(22),a(),o(23,"td",31),p(24),a(),o(25,"td",31),p(26),a(),o(27,"td",31),p(28),a(),o(29,"td",31),p(30),a(),o(31,"td",32)(32,"div",27)(33,"span",28),p(34),k(35,"number"),a()()()()}if(r&2){let e=n.$implicit,i=n.index,t=c(2);I("bg-gray-400",t.isHighlighted(e._id)),l(2),h(i+1),l(2),h(e!=null&&e.created_at?M(5,16,e==null?null:e.created_at,"d MMM yyyy, hh:mm a"):"--"),l(3),h((e==null?null:e.created_name)||"--"),l(3),h(e==null?null:e.order_no),l(2),h((e==null?null:e.customer_type_name)||"--"),l(4),O(" ",(e==null?null:e.customer_name)||"--",""),l(4),O(" ",(e==null?null:e.mobile)||"--",""),l(2),h((e==null?null:e.customer_code)||"--"),l(2),h((e==null?null:e.state)||"--"),l(2),h((e==null?null:e.district)||"--"),l(2),h((e==null?null:e.total_item_count)||"--"),l(2),h((e==null?null:e.total_item_quantity)||"--"),l(4),R("",t.CURRENCY_SYMBOLS.RUPEE," ",M(35,19,(e==null?null:e.net_amount_with_tax)||"--","1.2-2"),"")}}function Ne(r,n){if(r&1){let e=f();L(0),o(1,"tr",15)(2,"td"),p(3,"\xA0"),a(),o(4,"td")(5,"div",16)(6,"mat-form-field",17)(7,"input",18),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.created_at,t)||(s.filter.created_at=t),d(t)}),_("ngModelChange",function(){m(e);let t=c();return d(t.getList())}),a(),S(8,"mat-datepicker-toggle",19)(9,"mat-datepicker",null,0),a()()(),o(11,"td")(12,"div",16)(13,"mat-form-field",17)(14,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.created_name,t)||(s.filter.created_name=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(15,Ie,3,0,"button",21),a()()(),o(16,"td")(17,"div",16)(18,"mat-form-field",17)(19,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.order_no,t)||(s.filter.order_no=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(20,Fe,3,0,"button",21),a()()(),o(21,"td")(22,"div",16)(23,"mat-form-field",17)(24,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.customer_category,t)||(s.filter.customer_category=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(25,Re,3,0,"button",21),a()()(),o(26,"td")(27,"div",16)(28,"mat-form-field",17)(29,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.customer_detail,t)||(s.filter.customer_detail=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(30,De,3,0,"button",21),a()()(),o(31,"td")(32,"div",16)(33,"mat-form-field",17)(34,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.customer_code,t)||(s.filter.customer_code=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(35,Be,3,0,"button",21),a()()(),o(36,"td")(37,"div",16)(38,"mat-form-field",17)(39,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.state,t)||(s.filter.state=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(40,Ae,3,0,"button",21),a()()(),o(41,"td")(42,"div",16)(43,"mat-form-field",17)(44,"input",20),x("ngModelChange",function(t){m(e);let s=c();return b(s.filter.district,t)||(s.filter.district=t),d(t)}),_("keyup.enter",function(){m(e);let t=c();return d(t.getList())}),a(),u(45,We,3,0,"button",21),a()()(),o(46,"td"),p(47,"\xA0"),a(),o(48,"td"),p(49,"\xA0"),a(),o(50,"td"),p(51,"\xA0"),a()(),u(52,He,36,22,"tr",22),P()}if(r&2){let e=F(10),i=c();l(7),g("matDatepicker",e),y("ngModel",i.filter.created_at),l(),g("for",e),l(6),y("ngModel",i.filter.created_name),l(),v(i.filter.created_name?15:-1),l(4),y("ngModel",i.filter.order_no),l(),v(i.filter.order_no?20:-1),l(4),y("ngModel",i.filter.customer_category),l(),v(i.filter.customer_category?25:-1),l(4),y("ngModel",i.filter.customer_detail),l(),v(i.filter.customer_detail?30:-1),l(4),y("ngModel",i.filter.customer_code),l(),v(i.filter.customer_code?35:-1),l(4),y("ngModel",i.filter.state),l(),v(i.filter.state?40:-1),l(4),y("ngModel",i.filter.district),l(),v(i.filter.district?45:-1),l(7),g("ngForOf",i.listing)}}function je(r,n){r&1&&(o(0,"td"),S(1,"app-skeleton"),a()),r&2&&(l(),T("h20 bg-skeleton"))}function Ye(r,n){r&1&&(o(0,"tr",15),u(1,je,2,2,"td",34),a()),r&2&&(l(),g("ngForOf",w(1,V).constructor(12)))}function Ke(r,n){r&1&&(L(0),u(1,Ye,2,2,"tr",33),P()),r&2&&(l(),g("ngForOf",w(1,V).constructor(12)))}function Ue(r,n){r&1&&(L(0),S(1,"app-data-not-found"),P())}var xe=class r{constructor(n,e,i,t,s,qe,Ge,Qe,ze){this.dialog=n;this.api=e;this.comanFuncation=i;this.moduleService=t;this.highlightService=s;this.alert=qe;this.router=Ge;this.logService=Qe;this.toastr=ze}pageHeader=!0;_id;CURRENCY_SYMBOLS=K;FORMID=ue;skLoading=!1;activeTab="Pending";pagination={};filter={};mainTabs=[];modules={};listingCount={};listing=[];accessRight={};highlightedId;pageKey="primary-order";ngOnInit(){let n=this.highlightService.getHighlight(this.pageKey);n!=null&&(this.activeTab=n.tab,this.highlightedId=n.rowId,this.pagination.cur_page=n.pageIndex,this.filter=n.filters,this.highlightService.clearHighlight(this.pageKey));let e=this.moduleService.getAccessMap("SFA","Order","Primary Order");console.log(e,"accessRight"),e&&(this.accessRight=e,console.log(this.accessRight,"accessRight"),this.accessRight?.approveRight?this.activeTab="Pending":this.activeTab="Approved");let i=this.moduleService.getSubSubModuleByName("SFA","Order","Primary Order");i&&(this.modules=i),this.getList()}goToAddPage(){this.router.navigate(["/apps/order/primary-order/primary-order-add"])}setHighLight(n){this.comanFuncation.setHighLight(this.pageKey,n,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}isHighlighted(n){return this.highlightedId===n}goToDetailPage(n){this.setHighLight(n),this.router.navigate(["/apps/order/primary-order/primary-order-detail/",n])}onRefresh(){this.filter={},this.getList()}onTabChange(n){this.activeTab=n,this.getList()}changeToPage(n){this.pagination.cur_page=n,this.getList()}changeToPagination(n){n==="Next"&&this.pagination.cur_page<this.pagination.total_pages?this.pagination.cur_page++:n==="Previous"&&this.pagination.cur_page>1&&this.pagination.cur_page--,this.getList()}getList(){this.skLoading=!0,this.api.post({filters:this.filter,activeTab:this.activeTab,page:this.pagination.cur_page??1},"order/primary-order-list").subscribe(n=>{n.statusCode==200&&(this.skLoading=!1,this.listing=n.data.result,this.listingCount=n.data.activeTab,this.pagination=n.pagination,this.mainTabs=[...this.accessRight?.approveRight?[{name:"Pending",label:"Pending",icon:"ri-time-fill",count:this.listingCount.pending_count}]:[],{name:"Approved",label:"Approved",icon:"ri-checkbox-circle-fill",count:this.listingCount.approved_count},{name:"Reject",label:"Reject",icon:"ri-close-circle-fill",count:this.listingCount.reject_count},...this.accessRight?.approveRight?[{name:"Hold",label:"Hold",icon:"ri-pause-circle-fill",count:this.listingCount.hold_count}]:[],{name:"Partial Planned",label:"Partial Planned",icon:"ri-exchange-fill",count:this.listingCount.partially_planned_count},{name:"Complete Planned",label:"Complete Planned",icon:"ri-truck-fill",count:this.listingCount.complete_planned_count},{name:"Partially Planned & Dispatched",label:"Partially Planned & Dispatched",icon:"ri-truck-fill",count:this.listingCount.planned_dispatched_count},{name:"Partial Dispatched",label:"Partial Dispatched",icon:"ri-exchange-fill",count:this.listingCount.partially_dispatched_count},{name:"Dispatched",label:"Dispatched",icon:"ri-truck-fill",count:this.listingCount.dispatched_count}])})}openMainLogModal(n){this.comanFuncation.listLogsModal(this.modules.module_id,n,this.modules.module_type).subscribe(e=>{e===!0&&this.getList()})}onDeleteRow(n){this.alert.confirm("Are you sure?").then(e=>{e.isConfirmed&&this.api.patch({_id:n,is_delete:1},"primary-order/delete").subscribe(i=>{i.statusCode===200&&(this.logService.logActivityOnDelete(this.modules.module_id,this.modules.title,"delete",n,"Primary Order"),ve.default.fire("Deleted!",i.message,"success"),this.getList())})})}PageHeaders=[{label:"Created At"},{label:"Created By"},{label:"Order Id"},{label:"Customer Category"},{label:"Customer Detail"},{label:"Account Code",table_class:"text-center"},{label:"State",table_class:"text-center"},{label:"District",table_class:"text-center"},{label:"Total Items",table_class:"text-center"},{label:"Item QTY",table_class:"text-center"},{label:"Total Order Value",table_class:"text-center"}];static \u0275fac=function(e){return new(e||r)(C(se),C(J),C(Ce),C($),C(he),C(X),C(Y),C(fe),C(U))};static \u0275cmp=E({type:r,selectors:[["app-primary-order-list"]],inputs:{pageHeader:"pageHeader",_id:"_id"},decls:14,vars:22,consts:[["picker",""],[3,"title","title1","activeitem",4,"ngIf"],[1,"box","py-3","px-4"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","overflow-auto"],[4,"ngIf"],[1,"row"],[1,"col-xl-12"],[3,"onRefresh","button1","pageTitle","btnShow","refreshLabel","btnShow2","addBtnLabel"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"tableHead","showS_No","columns"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"title","title1","activeitem"],[3,"class",4,"ngFor","ngForOf"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","createdAt","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"text-primary","font-semibold","underline",3,"click"],[1,""],[1,"block","font-medium"],[1,"block"],[1,"text-textmuted","dark:text-textmuted/50","text-[11px]"],[1,"text-center"],[1,"text-right"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"]],template:function(e,i){e&1&&(u(0,Oe,1,4,"app-page-header",1),o(1,"div",2)(2,"nav",3),u(3,Me,2,2,"ng-container",4)(4,Ee,2,1,"ng-container",4),a(),o(5,"div",5)(6,"div",6)(7,"app-page-sub-header",7),_("onRefresh",function(){return i.onRefresh()})("button1",function(){return i.goToAddPage()}),a(),o(8,"div",8)(9,"spk-reusable-tables",9),u(10,Ne,53,18,"ng-container",4)(11,Ke,2,2,"ng-container",4),a(),u(12,Ue,2,0,"ng-container",4),a(),o(13,"app-pagination-footer",10),_("preButtonClick",function(){return i.changeToPagination("Previous")})("nextButtonClick",function(){return i.changeToPagination("Next")})("pageChange",function(s){return i.changeToPage(s)}),a()()()()),e&2&&(g("ngIf",i.pageHeader),l(3),g("ngIf",i.skLoading),l(),g("ngIf",!i.skLoading),l(3),T("p-0 pt-3"),g("pageTitle","Primary Order List")("btnShow",!0)("refreshLabel","Refresh")("btnShow2",i.accessRight==null?null:i.accessRight.addRight)("addBtnLabel","Create Order"),l(2),g("tableHead","border-b")("showS_No",!0)("columns",i.PageHeaders),l(),g("ngIf",!i.skLoading),l(),g("ngIf",i.skLoading),l(),g("ngIf",!i.listing.length&&!i.skLoading),l(),g("currentPage",i.pagination.cur_page)("totalPage",i.pagination.total_pages)("pageLimit",i.pagination.limit)("listLength",i.listing.length)("preBtn",!i.pagination.prev)("nextBtn",!i.pagination.next))},dependencies:[ge,A,W,q,G,Q,ye,Z,pe,de,be,_e,N,H,j,me,ce,ie,ae,oe,le,ne,re,te,ee,z],encapsulation:2})};export{xe as a};
