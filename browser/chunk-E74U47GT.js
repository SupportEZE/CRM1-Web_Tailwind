import{a as Be}from"./chunk-RR6NUCME.js";import{a as Ye}from"./chunk-SQZ3YN6N.js";import{a as Se}from"./chunk-CNF4GSI7.js";import{a as Fe}from"./chunk-OEHD5D2Y.js";import{a as Ne}from"./chunk-GLWQGYBC.js";import{a as we}from"./chunk-DC4QM32I.js";import{B as qe,C as Oe,F as Le,c as Te}from"./chunk-VHE3PQ3O.js";import{B as pe,C as ge,E as ue,G as ve,Ga as Ie,H as fe,Ha as Ve,I as he,Ia as De,Ja as ke,R as ye,U as xe,W as Ce,Ya as Re,Z as be,hb as Pe,jb as We,o as de,oa as Ee,p as se,va as Ae,w as me,wa as Me,y as ce,z as _e}from"./chunk-GYDYF5F3.js";import{K as oe,M as le,e as $,f as ee,g as te,k as ie,n as ne,o as ae,t as re}from"./chunk-PD5VTTIY.js";import{Aa as p,Ba as g,Ca as B,Cc as J,Da as U,Hb as j,Lc as h,Mc as d,Nc as v,Ob as _,Oc as k,Pc as R,Qc as P,Uc as x,Vc as C,Wc as b,Yc as W,Zb as q,Zc as K,_b as m,_c as X,bc as O,cc as H,ed as F,fd as Z,gc as z,gd as L,ic as Q,jc as G,kc as n,lc as o,mc as E,nc as S,oc as T,qc as A,rb as r,sb as M,wc as w,yc as c}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{a as V,b as Y}from"./chunk-66YHNWRR.js";var He=()=>["Target"],ze=(i,a)=>({"bg-primarytint1color":i,"bg-primarytint3color":a}),Qe=i=>({width:i}),je=()=>[];function Ge(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function Je(i,a){if(i&1&&(n(0,"div",49),_(1,Ge,2,0,"ng-container",38),o()),i&2){c();let e=h(83);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function Ke(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function Xe(i,a){if(i&1&&(n(0,"div",49),_(1,Ke,2,0,"ng-container",38),o()),i&2){c();let e=h(29);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function Ze(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function $e(i,a){if(i&1&&(n(0,"div",49),_(1,Ze,2,0,"ng-container",38),o()),i&2){c();let e=h(38);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function et(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function tt(i,a){if(i&1&&(n(0,"div",49),_(1,et,2,0,"ng-container",38),o()),i&2){c();let e=h(50);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function it(i,a){if(i&1&&(n(0,"mat-option",41),d(1),o()),i&2){let e=a.$implicit;m("value",e.value),r(),v(e.label)}}function nt(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function at(i,a){if(i&1&&(n(0,"div",49),_(1,nt,2,0,"ng-container",38),o()),i&2){c();let e=h(7);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function rt(i,a){if(i&1){let e=A();n(0,"div",24)(1,"label",25),d(2,"Customer Category"),n(3,"span",26),d(4,"*"),o()(),n(5,"mat-form-field",27)(6,"mat-select",50,10),b("ngModelChange",function(t){p(e);let l=c(2);return C(l.data.customer_type_id,t)||(l.data.customer_type_id=t),g(t)}),w("selectionChange",function(t){p(e);let l=c(2);return g(l.onCustomerCategoryChange(t.value))}),_(8,it,2,2,"mat-option",51),o()(),_(9,at,2,1,"div",31),o()}if(i&2){let e=h(7);c();let s=h(5),t=c();r(6),x("ngModel",t.data.customer_type_id),m("disabled",t.pageType.formType==="edit"),r(2),m("ngForOf",t.CommonApiService.customerCategorySubType),r(),m("ngIf",e.touched||s.submitted)}}function ot(i,a){if(i&1&&(n(0,"mat-option",41),d(1),o()),i&2){let e=a.$implicit;m("value",e.value),r(),v(e.label)}}function lt(i,a){if(i&1&&(S(0),_(1,ot,2,2,"mat-option",51),T()),i&2){let e=c(2);r(),m("ngForOf",e.CommonApiService.customerData)}}function dt(i,a){if(i&1&&(n(0,"mat-option",41),d(1),o()),i&2){let e=a.$implicit;m("value",e.value),r(),v(e.label)}}function st(i,a){if(i&1&&(S(0),_(1,dt,2,2,"mat-option",51),T()),i&2){let e=c(2);r(),m("ngForOf",e.CommonApiService.userData)}}function mt(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function ct(i,a){if(i&1&&(n(0,"div",49),_(1,mt,2,0,"ng-container",38),o()),i&2){c();let e=h(63);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function _t(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function pt(i,a){if(i&1&&(n(0,"div",49),_(1,_t,2,0,"ng-container",38),o()),i&2){c();let e=h(74);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function gt(i,a){i&1&&(S(0),d(1,"This field is required"),T())}function ut(i,a){if(i&1&&(n(0,"div",49),_(1,gt,2,0,"ng-container",38),o()),i&2){c();let e=h(83);r(),m("ngIf",e.errors==null?null:e.errors.required)}}function vt(i,a){if(i&1&&(n(0,"tr")(1,"td",55),d(2),o(),n(3,"td")(4,"span",56),d(5),o()(),n(6,"td",55)(7,"span",56),d(8),o()(),n(9,"td",55)(10,"span",56),d(11),o()(),n(12,"td",55)(13,"span",56),d(14),o()(),n(15,"td",55)(16,"span",57),d(17),o()()()),i&2){let e=a.$implicit,s=a.index;r(2),v(s+1),r(3),v((e==null?null:e.customer_name)||"--"),r(3),R("",(e==null||e.month_stats==null||e.month_stats.highest_month==null?null:e.month_stats.highest_month.achievement)||"0"," / ",(e==null||e.month_stats==null||e.month_stats.highest_month==null?null:e.month_stats.highest_month.title)||"--",""),r(3),R("",(e==null||e.month_stats==null||e.month_stats.lowest_month==null?null:e.month_stats.lowest_month.achievement)||"0"," / ",(e==null||e.month_stats==null||e.month_stats.lowest_month==null?null:e.month_stats.lowest_month.title)||"--",""),r(3),v((e==null||e.month_stats==null?null:e.month_stats.average_achievement)||"0"),r(2),m("ngClass",X(9,ze,(e==null?null:e.assign_type)==="Direct",(e==null?null:e.assign_type)==="Indirect")),r(),v((e==null?null:e.assign_type)||"--")}}function ft(i,a){if(i&1&&(n(0,"div",52)(1,"spk-reusable-tables",53),_(2,vt,18,12,"tr",54),o()()),i&2){let e=c(2);r(),m("tableHeight","170px")("columns",e.companiesColumn)("showCheckbox",!1),r(),m("ngForOf",e.assignCustomerAchievement)}}function ht(i,a){if(i&1&&(n(0,"li")(1,"div",80)(2,"div",81)(3,"span",82),d(4),o(),n(5,"div",83)(6,"p",84),d(7),F(8,"date"),F(9,"date"),o(),n(10,"p",85),d(11),o()()(),n(12,"h6",84),d(13),o()(),n(14,"div",86),E(15,"div",87),o()()),i&2){let e=a.$implicit,s=c(3);H("border-0 mb-5 p-0 ti-list-group-item ",e.liClass,""),r(4),v(s.CURRENCY_SYMBOLS.RUPEE),r(3),R("",e!=null&&e.start_date?L(8,12,e==null?null:e.start_date,"d MMM"):"--"," / ",e!=null&&e.end_date?L(9,15,e==null?null:e.end_date,"d MMM"):"--",""),r(4),k("",e.achievement_per||"0"," % Achievement"),r(2),P("",s.CURRENCY_SYMBOLS.RUPEE," ",e.achievement||"0"," / ",e.target||"0",""),r(),q("aria-valuenow",e.achievement_per),r(),m("ngStyle",K(18,Qe,e.achievement_per+"%"))}}function yt(i,a){if(i&1&&(S(0),n(1,"div",58)(2,"div",59)(3,"div",60),d(4," Target Achievement Rate "),o(),n(5,"div",61),B(),n(6,"svg",62),E(7,"circle",63),n(8,"g",64),E(9,"circle",65),o()(),U(),n(10,"div",66)(11,"span",67),d(12),o()()()(),n(13,"div",68)(14,"div",69)(15,"div",70)(16,"ul",71)(17,"li",72)(18,"div",73)(19,"div",74)(20,"div",75),d(21,"Maximum In Month"),o()(),n(22,"div",76)(23,"span",77),d(24),o()()()(),n(25,"li",72)(26,"div",73)(27,"div",74)(28,"div",75),d(29,"Minimum In Month"),o()(),n(30,"div",76)(31,"span",77),d(32),o()()()(),n(33,"li",72)(34,"div",73)(35,"div",74)(36,"div",75),d(37,"Average In Month"),o()(),n(38,"div",76)(39,"span",77),d(40),o()()()()(),n(41,"ul",78),Q(42,ht,16,20,"li",79,z),o()()()()(),T()),i&2){let e=c(2);r(9),q("stroke-dashoffset",e.targetAchievementRate==null?null:e.targetAchievementRate.montly_achievement_rate),r(3),k("",e.targetAchievementRate==null?null:e.targetAchievementRate.montly_achievement_rate,"%"),r(12),P("",e.CURRENCY_SYMBOLS.RUPEE," ",(e.targetAchievementRate==null||e.targetAchievementRate.month_stats==null||e.targetAchievementRate.month_stats.highest_month==null?null:e.targetAchievementRate.month_stats.highest_month.achievement)||"0"," / ",(e.targetAchievementRate==null||e.targetAchievementRate.month_stats==null||e.targetAchievementRate.month_stats.highest_month==null?null:e.targetAchievementRate.month_stats.highest_month.title)||"--",""),r(8),P("",e.CURRENCY_SYMBOLS.RUPEE," ",(e.targetAchievementRate==null||e.targetAchievementRate.month_stats==null||e.targetAchievementRate.month_stats.lowest_month==null?null:e.targetAchievementRate.month_stats.lowest_month.achievement)||"0"," / ",(e.targetAchievementRate==null||e.targetAchievementRate.month_stats==null||e.targetAchievementRate.month_stats.lowest_month==null?null:e.targetAchievementRate.month_stats.lowest_month.title)||"--",""),r(8),R("",e.CURRENCY_SYMBOLS.RUPEE," ",e.targetAchievementRate==null||e.targetAchievementRate.month_stats==null?null:e.targetAchievementRate.month_stats.average_achievement,""),r(2),G(e.targetAchievementRate==null?null:e.targetAchievementRate.last_three_targets)}}function xt(i,a){i&1&&(n(0,"div",91),E(1,"app-skeleton"),o()),i&2&&(r(),O("w112"))}function Ct(i,a){i&1&&(n(0,"div",22)(1,"div",70)(2,"app-showcode-card",88)(3,"div")(4,"div",89),_(5,xt,2,2,"div",90),o()()()()()),i&2&&(r(2),m("titleView",!1)("view",!1),r(3),m("ngForOf",W(3,je).constructor(8)))}function bt(i,a){if(i&1){let e=A();n(0,"div")(1,"div",104)(2,"mat-form-field",27)(3,"input",105),b("ngModelChange",function(t){p(e);let l=c().$implicit;return C(l.target_value,t)||(l.target_value=t),g(t)}),o()()()()}if(i&2){let e=c(),s=e.$implicit,t=e.index;r(3),J("name","target_value_",t,""),x("ngModel",s.target_value),m("disabled",!s.checked)}}function St(i,a){if(i&1){let e=A();n(0,"div",94)(1,"div",95)(2,"input",96),b("ngModelChange",function(t){let l=p(e).$implicit;return C(l.checked,t)||(l.checked=t),g(t)}),w("change",function(){let t=p(e),l=t.$implicit,y=t.index,f=c(3);return g(f.onCheckboxChange(l,y))}),o(),n(3,"div",97)(4,"div",98)(5,"div",99)(6,"i",100),d(7),o()(),n(8,"div",101)(9,"p",102),d(10),o(),n(11,"p",103),d(12),o()(),_(13,bt,4,4,"div",38),o()()()()}if(i&2){let e=a.$implicit,s=a.index;r(2),m("id","shipping-method"+s)("name","shipping-methods"+s),x("ngModel",e.checked),r(5),v(e.icon),r(3),v(e.name),r(2),v(e.description),r(),m("ngIf",e.input_show)}}function Tt(i,a){if(i&1&&(n(0,"div",92),_(1,St,14,7,"div",93),o()),i&2){let e=c(2);r(),m("ngForOf",e.customers)}}function wt(i,a){if(i&1&&(n(0,"mat-option",41),d(1),o()),i&2){let e=a.$implicit;m("value",e.value),r(),v(e.label)}}function Et(i,a){if(i&1){let e=A();n(0,"div",110)(1,"label",25),d(2,"Select Category"),n(3,"span",26),d(4,"*"),o()(),n(5,"mat-form-field",27)(6,"mat-select",120,13),b("ngModelChange",function(t){p(e);let l=c(3);return C(l.category_form.field_value,t)||(l.category_form.field_value=t),g(t)}),w("selectionChange",function(t){p(e);let l=c(3);return g(l.onProductChange(t.value))}),_(8,wt,2,2,"mat-option",51),o()()()}if(i&2){let e=c(3);r(6),x("ngModel",e.category_form.field_value),r(2),m("ngForOf",e.CommonApiService.dropDownData.category_name)}}function At(i,a){if(i&1){let e=A();n(0,"tr")(1,"td",124),d(2),o(),n(3,"td"),d(4),o(),n(5,"td"),d(6),o(),n(7,"td",55),d(8),o(),n(9,"td",55),d(10),o(),n(11,"td",125)(12,"div",126)(13,"app-icon-button",127),w("clickEvent",function(){let t=p(e).index,l=c(4);return g(l.deleteItem(t,"Category"))}),o()()()()}if(i&2){let e=a.$implicit,s=a.index;r(2),v(s+1),r(2),v(e.name||"--"),r(2),v(e.field_name||"--"),r(2),v(e.input_type),r(2),v(e.target_value),r(3),m("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave field_value-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}}function Mt(i,a){if(i&1&&(n(0,"div",121)(1,"div",122)(2,"spk-reusable-tables",123),_(3,At,14,7,"tr",54),o()()()),i&2){let e=c(3);r(2),m("columns",e.categoryHeaderColumn)("tableHead","border-b")("showCheckbox",!1),r(),m("ngForOf",e.categoryData)}}function It(i,a){if(i&1&&(n(0,"mat-option",41),d(1),o()),i&2){let e=a.$implicit;m("value",e.value),r(),v(e.label)}}function Vt(i,a){if(i&1){let e=A();n(0,"div",110)(1,"label",25),d(2,"Select Product"),n(3,"span",26),d(4,"*"),o()(),n(5,"mat-form-field",27)(6,"mat-select",120,13),b("ngModelChange",function(t){p(e);let l=c(3);return C(l.product_form.field_value,t)||(l.product_form.field_value=t),g(t)}),w("selectionChange",function(t){p(e);let l=c(3);return g(l.onProductChange(t.value))}),_(8,It,2,2,"mat-option",51),o()()()}if(i&2){let e=c(3);r(6),x("ngModel",e.product_form.field_value),r(2),m("ngForOf",e.CommonApiService.productList)}}function Dt(i,a){if(i&1){let e=A();n(0,"tr")(1,"td",124),d(2),o(),n(3,"td"),d(4),o(),n(5,"td"),d(6),o(),n(7,"td",55),d(8),o(),n(9,"td",55),d(10),o(),n(11,"td",125)(12,"div",126)(13,"app-icon-button",127),w("clickEvent",function(){let t=p(e).index,l=c(4);return g(l.deleteItem(t,"Product"))}),o()()()()}if(i&2){let e=a.$implicit,s=a.index;r(2),v(s+1),r(2),v(e.name||"--"),r(2),v(e.field_name||"--"),r(2),v(e.input_type),r(2),v(e.target_value),r(3),m("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave field_value-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}}function kt(i,a){if(i&1&&(n(0,"div",121)(1,"div",122)(2,"spk-reusable-tables",123),_(3,Dt,14,7,"tr",54),o()()()),i&2){let e=c(3);r(2),m("columns",e.productHeaderColumn)("tableHead","border-b")("showCheckbox",!1),r(),m("ngForOf",e.productData)}}function Rt(i,a){if(i&1){let e=A();n(0,"div",106),S(1),n(2,"label",107),d(3,"Category Wise Target"),o(),n(4,"div",108),_(5,Et,9,2,"div",109),n(6,"div",110)(7,"div",110)(8,"label",25),d(9,"Select Qty/Value"),n(10,"span",26),d(11,"*"),o()(),n(12,"mat-form-field",27)(13,"mat-select",111,11),b("ngModelChange",function(t){p(e);let l=c(2);return C(l.category_form.input_type,t)||(l.category_form.input_type=t),g(t)}),n(15,"mat-option",112),d(16,"Qty"),o(),n(17,"mat-option",113),d(18,"Value"),o()()()()(),n(19,"div",114)(20,"label",25),d(21),n(22,"span",26),d(23,"*"),o()(),n(24,"mat-form-field",27)(25,"input",115,12),b("ngModelChange",function(t){p(e);let l=c(2);return C(l.category_form.target_value,t)||(l.category_form.target_value=t),g(t)}),o()()(),n(27,"div",116)(28,"button",117),w("click",function(){p(e);let t=c(2);return g(t.addToList("Category"))}),E(29,"i",118),o()()(),_(30,Mt,4,4,"div",119),T(),S(31),n(32,"label",107),d(33,"Product Wise Target"),o(),n(34,"div",108),_(35,Vt,9,2,"div",109),n(36,"div",110)(37,"div",110)(38,"label",25),d(39,"Select Qty/Value"),n(40,"span",26),d(41,"*"),o()(),n(42,"mat-form-field",27)(43,"mat-select",111,11),b("ngModelChange",function(t){p(e);let l=c(2);return C(l.product_form.input_type,t)||(l.product_form.input_type=t),g(t)}),n(45,"mat-option",112),d(46,"Qty"),o(),n(47,"mat-option",113),d(48,"Value"),o()()()()(),n(49,"div",114)(50,"label",25),d(51),n(52,"span",26),d(53,"*"),o()(),n(54,"mat-form-field",27)(55,"input",115,12),b("ngModelChange",function(t){p(e);let l=c(2);return C(l.product_form.target_value,t)||(l.product_form.target_value=t),g(t)}),o()()(),n(57,"div",116)(58,"button",117),w("click",function(){p(e);let t=c(2);return g(t.addToList("Product"))}),E(59,"i",118),o()()(),_(60,kt,4,4,"div",119),T(),o()}if(i&2){let e=c(2);r(5),m("ngIf",e.category_form.name),r(8),x("ngModel",e.category_form.input_type),r(8),k("Target ",e.category_form.input_type,""),r(4),x("ngModel",e.category_form.target_value),r(5),m("ngIf",e.categoryData.length!==0),r(5),m("ngIf",e.product_form.name),r(8),x("ngModel",e.product_form.input_type),r(8),k("Target ",e.product_form.input_type,""),r(4),x("ngModel",e.product_form.target_value),r(5),m("ngIf",e.productData.length!==0)}}function Pt(i,a){if(i&1){let e=A();n(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"form",21,0),w("ngSubmit",function(){p(e);let t=h(5),l=c();return g(t.valid&&l.onSubmit())}),n(6,"div",22)(7,"div",23)(8,"div",22)(9,"div",24)(10,"label",25),d(11,"Target Type"),n(12,"span",26),d(13,"*"),o()(),n(14,"mat-form-field",27)(15,"mat-select",28,1),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.target_type,t)||(l.data.target_type=t),g(t)}),w("selectionChange",function(){p(e);let t=c();return g(t.onTabChange(t.data.target_type))}),n(17,"mat-option",29),d(18,"Field User"),o(),n(19,"mat-option",30),d(20,"Customer"),o()()(),_(21,Je,2,1,"div",31),o(),n(22,"div",24)(23,"label",25),d(24,"Title"),n(25,"span",26),d(26,"*"),o()(),n(27,"mat-form-field",27)(28,"input",32,2),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.title,t)||(l.data.title=t),g(t)}),o()(),_(30,Xe,2,1,"div",31),o(),n(31,"div",24)(32,"label",25),d(33,"Start Date"),n(34,"span",26),d(35,"*"),o()(),n(36,"mat-form-field",27)(37,"input",33,3),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.start_date,t)||(l.data.start_date=t),g(t)}),o(),E(39,"mat-datepicker-toggle",34)(40,"mat-datepicker",null,4),o(),_(42,$e,2,1,"div",31),o(),n(43,"div",24)(44,"label",25),d(45,"End Date"),n(46,"span",26),d(47,"*"),o()(),n(48,"mat-form-field",27)(49,"input",35,5),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.end_date,t)||(l.data.end_date=t),g(t)}),o(),E(51,"mat-datepicker-toggle",34)(52,"mat-datepicker",null,6),o(),_(54,tt,2,1,"div",31),o(),_(55,rt,10,4,"div",36),n(56,"div",24)(57,"label",25),d(58),n(59,"span",26),d(60,"*"),o()(),n(61,"mat-form-field",27)(62,"mat-select",37,7),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.assign_to_id,t)||(l.data.assign_to_id=t),g(t)}),w("selectionChange",function(t){p(e);let l=c();return l.onCustomerChange(t.value),g(l.getTargetAchievementRate())}),_(64,lt,2,1,"ng-container",38)(65,st,2,1,"ng-container",38),o()(),_(66,ct,2,1,"div",31),o(),n(67,"div",24)(68,"label",25),d(69,"Target Value"),n(70,"span",26),d(71,"*"),o()(),n(72,"mat-form-field",27)(73,"input",39,8),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.sale_value,t)||(l.data.sale_value=t),g(t)}),o()(),_(75,pt,2,1,"div",31),o(),n(76,"div",24)(77,"label",25),d(78,"Additional Target"),n(79,"span",26),d(80,"*"),o()(),n(81,"mat-form-field",27)(82,"mat-select",40,9),b("ngModelChange",function(t){p(e);let l=c();return C(l.data.is_additional_target,t)||(l.data.is_additional_target=t),g(t)}),w("selectionChange",function(t){p(e);let l=c();return g(l.getCategoryORProduct(t.value))}),n(84,"mat-option",41),d(85,"Yes"),o(),n(86,"mat-option",41),d(87,"No"),o()()(),_(88,ut,2,1,"div",31),o()(),_(89,ft,3,4,"div",42),o(),n(90,"div",43),_(91,yt,44,10,"ng-container",38)(92,Ct,6,4,"div",44),o()(),_(93,Tt,2,1,"div",45)(94,Rt,61,10,"div",46),n(95,"div",47),E(96,"app-button",48),o()()()()()()}if(i&2){let e=h(5),s=h(29),t=h(38),l=h(41),y=h(50),f=h(53),I=h(63),D=h(74),N=h(83),u=c();r(15),x("ngModel",u.data.target_type),m("disabled",u.pageType.formType==="edit"),r(6),m("ngIf",N.touched||e.submitted),r(7),x("ngModel",u.data.title),r(2),m("ngIf",s.touched||e.submitted),r(7),m("matDatepicker",l),x("ngModel",u.data.start_date),r(2),m("for",l),r(3),m("ngIf",t.touched||e.submitted),r(7),m("matDatepicker",f),x("ngModel",u.data.end_date),m("min",u.data.start_date),r(2),m("for",f),r(3),m("ngIf",y.touched||e.submitted),r(),m("ngIf",u.data.target_type==="Customer"),r(3),v(u.data.target_type==="Customer"?"Customers":"Users"),r(4),x("ngModel",u.data.assign_to_id),m("disabled",u.pageType.formType==="edit"),r(2),m("ngIf",u.data.target_type==="Customer"),r(),m("ngIf",u.data.target_type==="Field User"),r(),m("ngIf",I.touched||e.submitted),r(7),x("ngModel",u.data.sale_value),r(2),m("ngIf",D.touched||e.submitted),r(7),x("ngModel",u.data.is_additional_target),r(2),m("value",!0),r(2),m("value",!1),r(2),m("ngIf",N.touched||e.submitted),r(),m("ngIf",!u.loading&&u.data.target_type==="Field User"&&u.data.assign_to_id),r(2),m("ngIf",!u.loading&&u.data.assign_to_id),r(),m("ngIf",u.loading),r(),m("ngIf",u.data.is_additional_target&&u.data.target_type==="Field User"),r(),m("ngIf",u.data.is_additional_target),r(2),m("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("disabled",u.api.disabled)("formType",u.pageType.formType)("iconClass","ri-save-line")("loadingIconClass","ri-loader-2-fill")}}function Wt(i,a){i&1&&(n(0,"div",91),E(1,"app-skeleton"),o()),i&2&&(r(),O("w180"))}function Ft(i,a){i&1&&(n(0,"div",70)(1,"div",70)(2,"div",22)(3,"div",70)(4,"app-showcode-card",88)(5,"div")(6,"div",89),_(7,Wt,2,2,"div",90),o()()()()()()()),i&2&&(r(4),m("titleView",!1)("view",!1),r(3),m("ngForOf",W(3,je).constructor(14)))}var Ue=class i{constructor(a,e,s,t,l,y,f,I){this.api=a;this.toastr=e;this.CommonApiService=s;this.router=t;this.dateService=l;this.route=y;this.targetLogService=f;this.moduleService=I}CURRENCY_SYMBOLS=se;data={};category_form={};product_form={};pageType={};skLoading=!1;loading=!1;today=new Date;productData=[];categoryData=[];selectedCustomers=[];originalData={};submodule={};ngOnInit(){let a=this.moduleService.getSubModuleByName("SFA","Target");a&&(this.submodule=a),this.CommonApiService.getUserData(),this.data.target_type="Field User",this.route.paramMap.subscribe(e=>{if(e){this.DetailId=e.get("id");let s=e.get("edit");this.pageType.formType=s||"add",this.DetailId&&(this.skLoading=!0,this.getDetail())}})}onTabChange(a){this.data={},this.category_form={},this.product_form={},this.data.target_type=a,a==="Customer"&&this.CommonApiService.getCustomerCategorySubType(de.PRIMARY),a==="Field User"&&this.CommonApiService.getUserData()}getCategoryORProduct(a){setTimeout(()=>{this.category_form.name="Category",this.product_form.name="Product"},100),a===!0&&(this.CommonApiService.getDropDownData(6,"category_name"),this.CommonApiService.getProduct())}onCustomerCategoryChange(a){let e=this.CommonApiService.customerCategorySubType.find(s=>s.value===a);e&&(this.data.customer_type_name=e.label),this.CommonApiService.getCustomerData(this.data.customer_type_id)}onCustomerChange(a){let s=(this.data.target_type==="Customer"?this.CommonApiService.customerData:this.CommonApiService.userData).find(t=>t.value===a);this.data.assign_to_name=s.label||null}onProductChange(a){let e;this.category_form.name==="Category"&&(e=this.CommonApiService.dropDownData.category_name.find(s=>s.value===a),e&&(this.category_form.field_name=e.label)),this.product_form.name==="Product"&&(e=this.CommonApiService.productList.find(s=>s.value===a),e&&(this.product_form.field_name=e.label))}addToList(a){let e=this.category_form.name==="Category",s=this.product_form.name==="Product";if(e&&a&&a==="Category"){if(!this.category_form.field_value||!this.category_form.input_type||!this.category_form.target_value){this.toastr.error("Fill all required Category fields.","","toast-top-right");return}if(this.categoryData.some(l=>l.field_value===this.category_form.field_value&&l.input_type===this.category_form.input_type)){this.toastr.error("Entry with the same Category, already exists.","","toast-top-right"),this.category_form={},this.category_form.name="Category";return}this.categoryData.push(V({},this.category_form))}else if(s&&a&&a==="Product"){if(!this.product_form.field_value||!this.product_form.input_type||!this.product_form.target_value){this.toastr.error("Fill all required Product fields.","","toast-top-right");return}if(this.productData.some(l=>l.field_value===this.product_form.field_value&&l.input_type===this.product_form.input_type)){this.toastr.error("Entry with the same Product, already exists.","","toast-top-right"),this.product_form={},this.product_form.name="Product";return}this.productData.push(V({},this.product_form))}else{console.warn("Neither Category nor Product selected properly."),this.toastr.error("Please select a valid Product Type.","","toast-top-right");return}this.category_form={},this.product_form={},this.category_form.name="Category",this.product_form.name="Product"}deleteItem(a,e){e==="Category"&&this.categoryData.splice(a,1),e==="Product"&&this.productData.splice(a,1),this.toastr.success("Data removed from the list.","","toast-top-right")}targetAchievementRate={};getTargetAchievementRate(){this.loading=!0,this.api.post({target_type:this.data.target_type,assign_to_id:this.data.assign_to_id},"target/achievement").subscribe(a=>{a.statusCode===200&&(this.loading=!1,this.targetAchievementRate=a.data),(this.data.target_type="Field User")&&this.getAssignCustomerAchievement()})}assignCustomerAchievement={};getAssignCustomerAchievement(){this.loading=!0,this.api.post({target_type:this.data.target_type,assign_to_id:this.data.assign_to_id},"target/assign-customer-achievement").subscribe(a=>{a.statusCode===200&&(this.loading=!1,this.assignCustomerAchievement=a.data)})}onCheckboxChange(a,e){}onSubmit(){if(this.data.is_additional_target){if(this.data.target_type==="Customer"&&this.categoryData.length===0&&this.productData.length===0){this.toastr.error("Please add at least one row.","","toast-top-right");return}if(this.data.target_type==="Field User"&&(this.selectedCustomers=this.customers.filter(t=>t.checked&&t.target_value),this.categoryData.length===0&&this.productData.length===0&&this.selectedCustomers.length===0)){this.toastr.error("Please add at least one row.","","toast-top-right");return}this.data.additional_target=[...this.categoryData,...this.productData,...this.selectedCustomers]}(this.data.start_date||this.data.end_date)&&(this.data.start_date=this.dateService.formatToYYYYMMDD(this.data.start_date),this.data.end_date=this.dateService.formatToYYYYMMDD(this.data.end_date)),this.api.disabled=!0;let a=this.pageType.formType==="edit",e=a?"target/update":"target/create",s=a?"patch":"post";this.api[s](this.data,e).subscribe(t=>{if(t.statusCode===200){if(this.api.disabled=!1,this.pageType.formType==="edit"){let l=this.getSmartDiff(this.originalData,this.data);Object.keys(l).length>0&&this.targetLogService.logActivityOnUpdate(a,l,this.submodule.module_id,this.submodule.title,"update",this.DetailId||null,()=>{},this.submodule.module_type)}this.toastr.success(t.message,"","toast-top-right"),this.router.navigate(["/apps/sfa/target"])}else this.api.disabled=!1})}IGNORED_KEYS=["progress","total_achieved","status"];normalizeObject(a){if(Array.isArray(a))return a.map(this.normalizeObject);if(a&&typeof a=="object"){let e={};for(let[s,t]of Object.entries(a))this.IGNORED_KEYS.includes(s)||(e[s]=this.normalizeObject(t));return e}return a}deepEqual(a,e){return JSON.stringify(this.normalizeObject(a))===JSON.stringify(this.normalizeObject(e))}getArrayDiff(a,e,s="field_value"){let t={added:[],removed:[],modified:[]},l=new Map(a.map(f=>[f[s]||f.name,f])),y=new Map(e.map(f=>[f[s]||f.name,f]));for(let[f,I]of l.entries()){let D=y.get(f);D?this.deepEqual(I,D)||t.modified.push({old:I,new:D}):t.removed.push(I)}for(let[f,I]of y.entries())l.has(f)||t.added.push(I);return t}getSmartDiff(a,e){let s={};for(let t of Object.keys(V(V({},a),e))){let l=a[t],y=e[t];if(Array.isArray(l)&&Array.isArray(y)){let f=this.getArrayDiff(l,y);(f.added.length||f.removed.length||f.modified.length)&&(s[t]=f)}else typeof l=="object"&&typeof y=="object"&&l!==null&&y!==null?this.deepEqual(l,y)||(s[t]={old:l,new:y}):l!==y&&(s[t]={old:l,new:y})}return s}DetailId;basiqDetail={};getDetail(){this.api.post({_id:this.DetailId},"target/detail").subscribe(a=>{if(a.statusCode===200){this.skLoading=!1;let e=a.data;e?.result?.start_date&&(e.result.start_date=this.dateService.formatToYYYYMMDD(e.result.start_date)),e?.result?.end_date&&(e.result.end_date=this.dateService.formatToYYYYMMDD(e.result.end_date));let s=Y(V({},e.result),{additional_target:e.additional_target||[]});this.originalData=structuredClone(s),this.data=s,this.data?.target_type==="Field User"&&this.CommonApiService.getUserData(),this.getTargetAchievementRate(),this.data?.is_additional_target&&this.getCategoryORProduct(this.data?.is_additional_target),this.data?.additional_target?.length&&(this.categoryData=this.data?.additional_target.filter(t=>t.name==="Category"),this.productData=this.data?.additional_target.filter(t=>t.name==="Product"),this.data?.additional_target.forEach(t=>{let l=this.customers.find(y=>y.name===t.name);l&&(l.checked=!0,l.target_value=t.target_value)}))}})}productType=[{label:"Category"},{label:"Product"}];categoryHeaderColumn=[{label:"S.No",table_class:"text-center"},{label:"Type",table_class:""},{label:"Category Name",table_class:""},{label:"Qty/Value",table_class:"text-center"},{label:"Target",table_class:"text-center"},{label:"Action",table_class:"text-center"}];productHeaderColumn=[{label:"S.No",table_class:"text-center"},{label:"Type",table_class:""},{label:"Product Name",table_class:""},{label:"Qty/Value",table_class:"text-center"},{label:"Target",table_class:"text-center"},{label:"Action",table_class:"text-center"}];customers=[{name:"Primary Sale Target",description:"Additional primary sale target",icon:"shopping_cart",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Secondary Sale",description:"Target for secondary sale",icon:"repeat",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"New Customer",description:"New customer create target",icon:"person_add",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Enquiry Close",description:"Enquiry close target",icon:"done_all",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Site Creation",description:"New site creation target",icon:"add_location",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Site Close",description:"Close site target",icon:"location_off",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Customer Visit",description:"Customer visit target",icon:"event_available",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Event",description:"Event in your area target",icon:"event",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Influencer Registration",description:"New Influencer registration target",icon:"how_to_reg",input_show:!0,target_value:"",input_type:"qty",checked:!1},{name:"Payment Collection",description:"Payment collection target",icon:"payments",input_show:!0,target_value:"",input_type:"qty",checked:!1}];companiesColumn=[{label:"S.No",table_class:"text-center"},{label:"Name",table_class:""},{label:"Maximum In Month",table_class:"text-center"},{label:"Minimum In Month",table_class:"text-center"},{label:"Average In Month",table_class:"text-center"},{label:"Assign Type",table_class:"text-center"}];static \u0275fac=function(e){return new(e||i)(M(be),M(me),M(Se),M(le),M(We),M(oe),M(Be),M(we))};static \u0275cmp=j({type:i,selectors:[["app-target-add"]],decls:4,vars:8,consts:[["f","ngForm"],["target_type","ngModel"],["title","ngModel"],["start_date","ngModel"],["picker",""],["end_date","ngModel"],["picker1",""],["assign_to_id","ngModel"],["sale_value","ngModel"],["is_additional_target","ngModel"],["customer_type_id","ngModel"],["input_type","ngModel"],["target_value","ngModel"],["field_value","ngModel"],[3,"title","title1","activeitem"],["class","grid grid-cols-12 gap-x-6",4,"ngIf"],["class","xl:col-span-12 col-span-12",4,"ngIf"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xxl:col-span-12","col-span-12"],[1,"box"],[1,"box-body","field_value-checkout"],[3,"ngSubmit"],[1,"grid","grid-cols-12","sm:gap-x-6"],[1,"xxl:col-span-8","xl:col-span-4","col-span-12"],[1,"xl:col-span-4","col-span-12","mb-3"],[1,"form-label","mb-0"],[1,"text-red-500"],[1,"mat-custom-field","remove-space"],["placeholder","Select an option","name","target_type","required","",3,"ngModelChange","selectionChange","ngModel","disabled"],["value","Field User"],["value","Customer"],["class","mt-1 text-xs text-red-500 text-right",4,"ngIf"],["matInput","","placeholder","Type Here ...","name","title","pattern","^[^\\s].*","required","",3,"ngModelChange","ngModel"],["matInput","","placeholder","Start Date","name","start_date","required","",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","placeholder","End Date","name","end_date","required","",3,"ngModelChange","matDatepicker","ngModel","min"],["class","xl:col-span-4 col-span-12 mb-3",4,"ngIf"],["placeholder","Select an option","name","assign_to_id","required","",3,"ngModelChange","selectionChange","ngModel","disabled"],[4,"ngIf"],["type","number","matInput","","placeholder","Type Here ...","name","sale_value","required","",3,"ngModelChange","ngModel"],["placeholder","Select an option","name","is_additional_target","required","",3,"ngModelChange","selectionChange","ngModel"],[3,"value"],["class","table-responsive",4,"ngIf"],[1,"xxl:col-span-4","xl:col-span-4","col-span-12"],["class","grid grid-cols-12 sm:gap-x-6",4,"ngIf"],["class","grid grid-cols-12 sm:gap-x-6 gap-y-3 mb-6 mt-3",4,"ngIf"],["class","bg-light pt-2 p-4 rounded-md !mb-6 mt-3",4,"ngIf"],[1,"flex","items-center","justify-end","gap-2"],[3,"buttonType","buttonClass","disabled","formType","iconClass","loadingIconClass"],[1,"mt-1","text-xs","text-red-500","text-right"],["placeholder","Select an option","name","customer_type_id","required","",3,"ngModelChange","selectionChange","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"table-responsive"],["tableClass","ti-custom-table text-nowrap","checkboxClass","text-center",3,"tableHeight","columns","showCheckbox"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"font-medium"],[1,"badge",3,"ngClass"],[1,"box","overflow-hidden","mb-5"],[1,"box-header","justify-between","pt-1"],[1,"box-title"],[1,"relative","size-12"],["width","36","height","36","viewBox","0 0 36 36","xmlns","http://www.w3.org/2000/svg",1,"size-full"],["cx","18","cy","18","r","16","fill","none","stroke-width","3",1,"stroke-current","text-success"],[1,"origin-center","-rotate-90","transform"],["cx","18","cy","18","r","16","fill","none","stroke-width","3","stroke-dasharray","100",1,"stroke-current","text-gray-200","dark:text-white/10"],[1,"absolute","top-1/2","left-1/2","transform","-translate-y-1/2","-translate-x-1/2"],[1,"text-center","text-[11px]","font-bold"],[1,"box-body","p-0"],[1,"grid","grid-cols-12","p-4","pt-0"],[1,"xl:col-span-12","col-span-12"],[1,"ti-list-group","list-group-flush","border","border-t","flex","items-start","justify-center","bg-primary","bg-primary/10"],[1,"ti-list-group-item"],[1,""],[1,"session-type","leading-none","mobile"],[1,"font-medium","mb-0","text-textmuted","text9px","text-center","whitespace-nowrap"],[1,"leading-none","mt-2"],[1,"block","font-semibold","mb-0","text-center","text-[12px]"],[1,"list-none","mb-0","mt-4"],[3,"class"],[1,"flex","justify-between","items-top"],[1,"flex"],[1,"avatar","avatar-rounded","avatar-md","bg-primary/10","!text-primary"],[1,"flex","flex-col","ms-2"],[1,"font-medium","mb-0"],[1,"text-xs","text-textmuted","dark:text-textmuted/50","mb-0"],["role","progressbar","aria-label","Basic example","aria-valuenow","80","aria-valuemin","0","aria-valuemax","100",1,"progress","progress-xs","mt-2","mb-0"],[1,"progress-bar","progress-bar-striped","progress-bar-animated","bg-primary",3,"ngStyle"],[3,"titleView","view"],[1,"flex","gap-2","mb-1","flex-wrap"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"flex","items-center"],[1,"grid","grid-cols-12","sm:gap-x-6","gap-y-3","mb-6","mt-3"],["class","xl:col-span-6 col-span-12",4,"ngFor","ngForOf"],[1,"xl:col-span-6","col-span-12"],[1,"form-check","shipping-method-container","mb-0","flex","items-center","bg-light","mb-2","p-2"],["type","checkbox",1,"mt-1","radius",3,"ngModelChange","change","id","name","ngModel"],[1,"form-check-label","wp100"],[1,"sm:flex","items-center","justify-between"],[1,"me-4","ms-2","flex"],[1,"material-icons","text-primary",2,"font-size","25px !important"],[1,"shipping-partner-details","wp100"],[1,"mb-0","font-semibold"],[1,"text-textmuted","dark:text-textmuted/50","text-[11px]","mb-0"],[1,"xl:col-span-4","col-span-12"],["matInput","","placeholder","Type Here ...",3,"ngModelChange","name","ngModel","disabled"],[1,"bg-light","pt-2","p-4","rounded-md","!mb-6","mt-3"],[1,"font-medium","text-xs"],[1,"grid","grid-cols-12","sm:gap-x-6","gap-2","mt-3"],["class","xl:col-span-3 col-span-12 mb-3",4,"ngIf"],[1,"xl:col-span-3","col-span-12","mb-3"],["placeholder","Select an option","name","input_type",3,"ngModelChange","ngModel"],["value","Qty"],["value","Value"],[1,"xl:col-span-2","col-span-12","mb-3"],["type","number","matInput","","placeholder","Type Here ...","name","target_value",3,"ngModelChange","ngModel"],[1,"flex","justify-start","mt-6"],["type","button","aria-label","button",1,"ti-btn","ti-btn-icon","ti-btn-primary","btn-wave",3,"click"],[1,"ri-add-line"],["class","xl:col-span-6 col-span-12 mb-3",4,"ngIf"],["placeholder","Select an option","name","field_value",3,"ngModelChange","selectionChange","ngModel"],[1,"xl:col-span-6","col-span-12","mb-3"],[1,"table-responsive","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-hover ti-head-primary",3,"columns","tableHead","showCheckbox"],[1,"w60","text-center"],[1,"w60","relative"],[1,"flex","flex-row","items-center","!gap-2","text-[0.9375rem]"],[3,"clickEvent","icon","buttonClass"]],template:function(e,s){e&1&&(E(0,"app-page-header",14),F(1,"titlecase"),_(2,Pt,97,38,"div",15)(3,Ft,8,4,"div",16)),e&2&&(m("title","Target")("title1",W(7,He))("activeitem",Z(1,5,s.pageType.formType)+" Target"),r(2),m("ngIf",!s.skLoading),r(),m("ngIf",s.skLoading))},dependencies:[re,$,ee,te,ie,ne,ae,Le,fe,_e,he,ce,pe,ge,ye,xe,ve,ue,Ne,Te,Oe,Ye,Pe,Ee,Ve,De,ke,Ie,Me,Ae,Re,Fe,Ce,qe],encapsulation:2})};export{Ue as TargetAddComponent};
