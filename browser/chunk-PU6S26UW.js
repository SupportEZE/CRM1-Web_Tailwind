import{a as S}from"./chunk-OTFCGVEU.js";import{Z as y,u as v}from"./chunk-GYDYF5F3.js";import{M as h}from"./chunk-PD5VTTIY.js";import{ka as u,pa as p}from"./chunk-2NSPOFEK.js";var A=class c{constructor(r,o,a,n){this.router=r;this.logService=o;this.toastr=a;this.api=n}uploadFile(r,o,a,n,i,l,g,d,N){if(!a||a.length===0){console.warn("No files to upload.");return}let t=new FormData,f=[];a[0]instanceof File?a.forEach(e=>{let s=e.name.split(".").pop(),m=`${this.generateRandomName(12)}.${s}`;t.append("files",e,m),f.push({file:m,label:e.image_type||n,doc_no:e.doc_no||""})}):a.forEach(e=>{e&&Array.isArray(e.file)&&e.file.forEach(s=>{let m=s.name.split(".").pop(),_=`${this.generateRandomName(12)}.${m}`;t.append("files",s,_),f.push({file:_,label:s.image_type||n,doc_no:s.doc_no||""})})}),d!=""&&d!=null&&t.append("exist_id",d??0),t.append("module_id",i?.module_id??0),t.append("module_name",i?.module_name??""),t.append("sub_module_id",i?.sub_module_id??0),t.append("sub_module_name",i?.sub_module_name??""),t.append("label",JSON.stringify(f)),t.append("_id",r.toString()),N&&this.logService.logActivityOnDelete(i.sub_module_id?i.sub_module_id:i.module_id,i.title?i.title:i.module_name,"update",r,"Images are updated"),this.api.uploadFile(t,o+"/upload").subscribe({next:e=>{e?.statusCode===200&&(this.api.disabled=!1,this.toastr.success(e.message,"",{positionClass:"toast-top-right"}),l?this.router.navigate([l]).catch(()=>{g?.()}):g?.())},error:e=>{console.error("Error uploading files:",e)}})}generateRandomName(r=12){let o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a="";for(let n=0;n<r;n++)a+=o.charAt(Math.floor(Math.random()*o.length));return a}static \u0275fac=function(o){return new(o||c)(p(h),p(S),p(v),p(y))};static \u0275prov=u({token:c,factory:c.\u0275fac,providedIn:"root"})};export{A as a};
