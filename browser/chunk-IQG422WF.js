import{a as Ke}from"./chunk-56RTIVDZ.js";import"./chunk-PU6S26UW.js";import{a as Xe}from"./chunk-JUPJFX3F.js";import{a as Qe}from"./chunk-SQZ3YN6N.js";import"./chunk-CIBZCVJQ.js";import{a as We}from"./chunk-OTFCGVEU.js";import{a as ve}from"./chunk-CNF4GSI7.js";import{a as Re}from"./chunk-OEHD5D2Y.js";import{a as $e}from"./chunk-GLWQGYBC.js";import{a as Ee}from"./chunk-DC4QM32I.js";import{B as Ye,C as Ge,F as je,c as Se,f as Le,g as De,q as Ne,s as Ue,u as Be,w as qe}from"./chunk-VHE3PQ3O.js";import{$ as he,A as I,Aa as Ae,B as de,C as ce,Ea as ke,G as se,Ga as Ie,H as me,I as pe,M as _e,P as ue,Q as ge,Qa as Me,V as fe,W as be,X as xe,Ya as Pe,Z as Ce,Za as Ve,_ as et,aa as ye,hb as Fe,o as U,oa as Te,p as oe,va as we,w as ae,wa as Oe,z as le}from"./chunk-GYDYF5F3.js";import{e as Z,f as ee,g as te,n as ne,r as ie,t as re}from"./chunk-PD5VTTIY.js";import{$c as z,Aa as p,Ba as _,Cc as K,Hb as X,Ka as Q,Mc as d,Nc as O,Ob as u,Oc as S,Pc as v,Qc as N,Uc as P,Vc as V,Wc as F,Yc as A,Zc as Y,_b as s,_c as H,bc as M,ed as k,fc as D,fd as J,gd as R,kc as o,lc as r,mc as b,nc as x,oc as C,qc as h,rb as l,sb as E,wc as g,yc as m}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{a as W,b as $,g as Ze}from"./chunk-66YHNWRR.js";var G=Ze(et());var tt=()=>["Secondary Order Add"],nt=(i,t)=>({"xl:col-span-9 col-span-12":i,"xl:col-span-12 col-span-12":t}),it=(i,t,e)=>({name:i,label:t,icon:e}),ze=i=>[i],rt=()=>({name:"complete",label:"Complete Order",icon:"ri-checkbox-circle-line"}),B=()=>[];function ot(i,t){if(i&1){let e=h();o(0,"app-listing-tab",15),g("tabChange",function(){let n=p(e).$implicit,c=m();return _(c.onTabChange(n.name))}),r()}if(i&2){let e=t.$implicit,a=m();s("countShow",!1)("tabs",Y(7,ze,z(3,it,e.name,e.label,e.icon)))("activeTab",a.activeTab)}}function at(i,t){if(i&1){let e=h();o(0,"app-listing-tab",15),g("tabChange",function(){p(e);let n=m();return _(n.onTabChange("complete"))}),r()}if(i&2){let e=m();s("countShow",!1)("tabs",Y(4,ze,A(3,rt)))("activeTab",e.activeTab)}}function lt(i,t){if(i&1){let e=h();o(0,"div",19)(1,"spk-ng-select",23),g("searchChanged",function(n){p(e);let c=m(2);return _(c.onSearch(n,"customer"))})("selectedChange",function(n){p(e);let c=m(2);return _(c.onCustomerSelected(n))}),r()()}if(i&2){let e=m(2);l(),s("fieldReq",!0)("options",e.CommonApiService.customerData)("multiple",!1)("search",!0)}}function dt(i,t){if(i&1){let e=h();o(0,"div",19)(1,"spk-ng-select",24),g("searchChanged",function(n){p(e);let c=m(2);return _(c.onSearch(n,"customer"))})("selectedChange",function(n){p(e);let c=m(2);return _(c.onUserSelected(n))}),r()()}if(i&2){let e=m(2);l(),s("fieldReq",!0)("options",e.CommonApiService.customerMapping)("multiple",!1)("search",!0)}}function ct(i,t){if(i&1&&(o(0,"div",19),b(1,"spk-ng-select",25),r()),i&2){let e=m(2);l(),s("fieldReq",!0)("options",e.gstType)("multiple",!1)}}function st(i,t){if(i&1){let e=h();o(0,"div",26)(1,"button",27),g("click",function(){p(e);let n=m(2);return _(n.onNextTab("product"))}),d(2," Continue"),b(3,"i",28),r()()}}function mt(i,t){if(i&1){let e=h();x(0),o(1,"div",16)(2,"form",17)(3,"div",18)(4,"div",19)(5,"spk-ng-select",20),g("selectedChange",function(n){p(e);let c=m();return _(c.onCustomerCategoryChange(n))}),r()(),u(6,lt,2,4,"div",21)(7,dt,2,4,"div",21)(8,ct,2,3,"div",21),r()()(),u(9,st,4,0,"div",22),C()}if(i&2){let e,a,n,c,f=m();l(2),s("formGroup",f.primaryOrderForm),l(3),s("fieldReq",!0)("options",f.CommonApiService.customerCategorySubType)("multiple",!1),l(),s("ngIf",(e=f.primaryOrderForm.get("customer_type_id"))==null?null:e.value),l(),s("ngIf",(a=f.primaryOrderForm.get("retailer_id"))==null?null:a.value),l(),s("ngIf",(n=f.primaryOrderForm.get("distributor_id"))==null?null:n.value),l(),s("ngIf",f.activeTab==="customer"&&((c=f.primaryOrderForm.get("gst_type"))==null?null:c.value))}}function pt(i,t){if(i&1){let e=h();o(0,"button",36),g("click",function(){p(e);let n=m(2);return n.filter.search="",_(n.getProductList())}),o(1,"mat-icon"),d(2,"close"),r()()}}function _t(i,t){if(i&1&&(o(0,"span",44),b(1,"i",63),d(2),r()),i&2){let e=m().$implicit;l(2),S(" ",e==null?null:e.scheme_description," ")}}function ut(i,t){if(i&1&&(o(0,"mat-option",64),d(1),r()),i&2){let e=t.$implicit;s("value",e),l(),O(e)}}function gt(i,t){if(i&1){let e=h();o(0,"tr",38)(1,"td",31),d(2),r(),o(3,"td",39)(4,"div",40)(5,"div",41)(6,"div",42)(7,"a",43),g("click",function(){let n=p(e).$implicit,c=m(3);return _(c.openSchemeModal(n==null?null:n.scheme_id))}),d(8),u(9,_t,3,1,"span",44),r()(),o(10,"div",45)(11,"div")(12,"span",46),d(13,"Product : "),r(),o(14,"span",47),d(15),r()(),o(16,"div")(17,"span",46),d(18,"Code:"),r(),o(19,"span",47),d(20),r()()()()()(),o(21,"td")(22,"div",48),d(23),r()(),o(24,"td")(25,"div",49)(26,"input",50),F("ngModelChange",function(n){let c=p(e).$implicit;return V(c.basic_discount,n)||(c.basic_discount=n),_(n)}),g("blur",function(){let n=p(e).$implicit,c=m(3);return _(c.validateDiscount(n))}),r()()(),o(27,"td")(28,"div",48),d(29),r()(),o(30,"td",51)(31,"div",52)(32,"button",53),g("click",function(){let n=p(e).$implicit,c=m(3);return _(c.decreaseQuantity(n))}),b(33,"i",54),r(),o(34,"input",55),F("ngModelChange",function(n){let c=p(e).$implicit;return V(c.quantity,n)||(c.quantity=n),_(n)}),g("ngModelChange",function(){let n=p(e).$implicit,c=m(3);return _(c.recalculateProductAmounts(n))}),r(),o(35,"button",56),g("click",function(){let n=p(e).$implicit,c=m(3);return _(c.increaseQuantity(n))}),b(36,"i",57),r()()(),o(37,"td")(38,"mat-form-field",58)(39,"mat-select",59),F("ngModelChange",function(n){let c=p(e).$implicit;return V(c.uom,n)||(c.uom=n),_(n)}),u(40,ut,2,2,"mat-option",60),r()()(),o(41,"td")(42,"div",48),d(43),r()(),o(44,"td")(45,"div",48),d(46),r()(),o(47,"td")(48,"div",61),d(49),r()(),o(50,"td")(51,"div",40)(52,"app-icon-button",62),g("click",function(){let n=p(e).$implicit,c=m(3);return _(c.addOrder(n))}),r()()()()}if(i&2){let e=t.$implicit,a=t.index,n=m(3);l(2),S(" ",(n.pagination.cur_page-1)*n.pagination.limit+a+1," "),l(6),S("",(e==null?null:e.category_name)||"--"," "),l(),D(e!=null&&e.scheme_description?9:-1),l(6),O((e==null?null:e.product_name)||"--"),l(5),O((e==null?null:e.product_code)||"--"),l(3),v("",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.mrp)||"--",""),l(3),K("name","point_",a,""),P("ngModel",e.basic_discount),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.unit_price)||"--"," "),l(5),P("ngModel",e.quantity),l(5),P("ngModel",e.uom),l(),s("ngForOf",n.uomOptions),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.sub_total)||"--"," "),l(3),N(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.gst)||"0.00"," (",(e==null?null:e.gst_percent)||18,"%) "),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.net_amount)||"--"," "),l(3),s("icon","ri-shopping-cart-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-info waves-effect waves-light")}}function ft(i,t){if(i&1&&(x(0),u(1,gt,53,24,"tr",37),C()),i&2){let e=m(2);l(),s("ngForOf",e.productDetail)}}function bt(i,t){i&1&&(o(0,"td"),b(1,"app-skeleton"),r()),i&2&&(l(),M("h20 bg-skeleton"))}function xt(i,t){i&1&&(o(0,"tr",30),u(1,bt,2,2,"td",66),r()),i&2&&(l(),s("ngForOf",A(1,B).constructor(11)))}function Ct(i,t){i&1&&(x(0),u(1,xt,2,2,"tr",65),C()),i&2&&(l(),s("ngForOf",A(1,B).constructor(11)))}function ht(i,t){i&1&&(x(0),b(1,"app-data-not-found"),C())}function yt(i,t){if(i&1){let e=h();x(0),o(1,"spk-reusable-tables",29)(2,"tr",30)(3,"td",31),d(4,"\xA0"),r(),o(5,"td")(6,"div",32)(7,"mat-form-field",33)(8,"input",34),F("ngModelChange",function(n){p(e);let c=m();return V(c.filter.search,n)||(c.filter.search=n),_(n)}),g("ngModelChange",function(){p(e);let n=m();return _(n.getProductList())}),r(),u(9,pt,3,0,"button",35),r()()(),o(10,"td"),d(11,"\xA0"),r(),o(12,"td"),d(13,"\xA0"),r(),o(14,"td"),d(15,"\xA0"),r(),o(16,"td"),d(17,"\xA0"),r(),o(18,"td"),d(19,"\xA0"),r(),o(20,"td"),d(21,"\xA0"),r(),o(22,"td"),d(23,"\xA0"),r(),o(24,"td"),d(25,"\xA0"),r(),o(26,"td"),d(27,"\xA0"),r()(),u(28,ft,2,1,"ng-container",8)(29,Ct,2,2,"ng-container",8),r(),u(30,ht,2,0,"ng-container",8),C()}if(i&2){let e=m();l(),s("columns",e.cartColumn)("showAction",!0),l(7),P("ngModel",e.filter.search),l(),D(e.filter.search?9:-1),l(19),s("ngIf",!e.productListLoading),l(),s("ngIf",e.productListLoading),l(),s("ngIf",!e.productDetail.length&&!e.productListLoading)}}function vt(i,t){if(i&1){let e=h();o(0,"div",67)(1,"button",68),g("click",function(){p(e);let n=m();return _(n.onPreviousTab("customer"))}),b(2,"i",69),d(3,"Previous"),r(),o(4,"button",70),g("click",function(){p(e);let n=m();return _(n.onNextTab("cart"))}),d(5,"Continue"),b(6,"i",71),r()()}}function St(i,t){if(i&1){let e=h();o(0,"button",36),g("click",function(){p(e);let n=m(2);return n.filter.search="",_(n.getCartList())}),o(1,"mat-icon"),d(2,"close"),r()()}}function Et(i,t){if(i&1){let e=h();o(0,"tr",38)(1,"td",31),d(2),r(),o(3,"td",39)(4,"div",40)(5,"div",41)(6,"div",73)(7,"a"),d(8),r()(),o(9,"div",45)(10,"div")(11,"span",46),d(12,"Product:"),r(),o(13,"span",47),d(14),r()(),o(15,"div")(16,"span",46),d(17,"Code:"),r(),o(18,"span",47),d(19),r()()()()()(),o(20,"td")(21,"div",48),d(22),r()(),o(23,"td")(24,"div"),d(25),r()(),o(26,"td")(27,"div",48),d(28),r()(),o(29,"td")(30,"div",31),d(31),r()(),o(32,"td")(33,"div"),d(34),r()(),o(35,"td")(36,"div",48),d(37),r()(),o(38,"td")(39,"div",48),d(40),r()(),o(41,"td")(42,"div",61),d(43),r()(),o(44,"td")(45,"div",40)(46,"app-icon-button",74),g("clickEvent",function(){let n=p(e).$implicit,c=m(3);return _(c.onDeletCart(n._id))}),r()()()()}if(i&2){let e=t.$implicit,a=t.index,n=m(3);l(2),S(" ",(n.pagination.cur_page-1)*n.pagination.limit+a+1," "),l(6),O((e==null?null:e.category_name)||"--"),l(6),O((e==null?null:e.product_name)||"--"),l(5),O((e==null?null:e.product_code)||"--"),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.mrp)||"--"," "),l(3),N(" ",(e==null?null:e.discount_percent)||"--"," (",n.CURRENCY_SYMBOLS.RUPEE,"",(e==null?null:e.discount_amount)||"--",") "),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.unit_price)||"--"," "),l(3),S(" ",(e==null?null:e.total_quantity)||"--"," "),l(3),S(" ",(e==null?null:e.uom)||"--"," "),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.gross_amount)||"--"," "),l(3),N(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.gst_amount)||"--"," (",(e==null?null:e.gst_percent)||18,"%) "),l(3),v(" ",n.CURRENCY_SYMBOLS.RUPEE," ",(e==null?null:e.net_amount_with_tax)||"--"," "),l(3),s("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}}function Tt(i,t){if(i&1&&(x(0),u(1,Et,47,22,"tr",37),C()),i&2){let e=m(2);l(),s("ngForOf",e.cartDetail)}}function wt(i,t){i&1&&(o(0,"td"),b(1,"app-skeleton"),r()),i&2&&(l(),M("h20 bg-skeleton"))}function Ot(i,t){i&1&&(o(0,"tr",30),u(1,wt,2,2,"td",66),r()),i&2&&(l(),s("ngForOf",A(1,B).constructor(11)))}function At(i,t){i&1&&(x(0),u(1,Ot,2,2,"tr",65),C()),i&2&&(l(),s("ngForOf",A(1,B).constructor(11)))}function kt(i,t){i&1&&(x(0),b(1,"app-data-not-found"),C())}function It(i,t){if(i&1){let e=h();x(0),o(1,"spk-reusable-tables",29)(2,"tr",30)(3,"td",31),d(4,"\xA0"),r(),o(5,"td")(6,"div",32)(7,"mat-form-field",33)(8,"input",72),F("ngModelChange",function(n){p(e);let c=m();return V(c.filter.search,n)||(c.filter.search=n),_(n)}),g("keyup.enter",function(){p(e);let n=m();return _(n.getCartList())}),r(),u(9,St,3,0,"button",35),r()()(),o(10,"td"),d(11,"\xA0"),r(),o(12,"td"),d(13,"\xA0"),r(),o(14,"td"),d(15,"\xA0"),r(),o(16,"td"),d(17,"\xA0"),r(),o(18,"td"),d(19,"\xA0"),r(),o(20,"td"),d(21,"\xA0"),r(),o(22,"td"),d(23,"\xA0"),r(),o(24,"td"),d(25,"\xA0"),r(),o(26,"td"),d(27,"\xA0"),r()(),u(28,Tt,2,1,"ng-container",8)(29,At,2,2,"ng-container",8),r(),u(30,kt,2,0,"ng-container",8),C()}if(i&2){let e=m();l(),s("columns",e.cartColumn)("showAction",!0),l(7),P("ngModel",e.filter.search),l(),D(e.filter.search?9:-1),l(19),s("ngIf",!e.skLoading),l(),s("ngIf",e.skLoading),l(),s("ngIf",!e.cartDetail.length&&!e.skLoading)}}function Mt(i,t){if(i&1){let e=h();o(0,"div",75)(1,"button",76),g("click",function(){p(e);let n=m();return _(n.onPreviousTab("product"))}),b(2,"i",69),d(3,"Previous"),r()()}}function Pt(i,t){i&1&&(x(0),o(1,"div",77)(2,"h5",78),d(3,"Order Successful..."),r()(),o(4,"div",79),b(5,"img",80),r(),o(6,"div",77)(7,"p",81),d(8,"You can track your order with Order Id "),o(9,"b"),d(10,"SPK#1FR"),r(),d(11," from "),o(12,"a",82)(13,"u"),d(14,"Track Order"),r()()(),o(15,"p",83),d(16,"Thankyou for shopping with us."),r()(),o(17,"a",84),d(18,"View PDF"),b(19,"i",85),r(),C())}function Vt(i,t){i&1&&(o(0,"button",92),d(1," Order Summary "),r())}function Ft(i,t){i&1&&(o(0,"button",93),d(1," Product Filter "),r())}function Rt(i,t){i&1&&(x(0),b(1,"app-data-not-found"),C())}function Lt(i,t){if(i&1){let e=h();x(0),o(1,"div",95)(2,"div",96)(3,"div",97),d(4,"Total Item"),r(),o(5,"div",98),d(6),r()(),o(7,"div",99)(8,"div",97),d(9,"Total Item Qty"),r(),o(10,"div",98),d(11),r()(),o(12,"div",99)(13,"div",97),d(14,"Total Unit Price"),r(),o(15,"div",98),d(16),k(17,"number"),r()(),o(18,"div",99)(19,"div",97),d(20,"Total Discount Amount"),r(),o(21,"div",100),d(22),k(23,"number"),r()(),o(24,"div",99)(25,"div",97),d(26,"Sub Total"),r(),o(27,"div",98),d(28),k(29,"number"),r()(),o(30,"div",99)(31,"div",97),d(32,"Total GST Amount"),r(),o(33,"div",101),d(34),k(35,"number"),r()(),o(36,"div",99)(37,"div",102),d(38,"Grand Total :"),r(),o(39,"div",103),d(40),k(41,"number"),r()(),o(42,"div",104),b(43,"spk-input",105),r()(),o(44,"div",106)(45,"div",107)(46,"app-button",108),g("click",function(){p(e);let n=m(3);return _(n.removeCart())}),r()(),o(47,"div",109)(48,"app-button",110),g("click",function(){p(e);let n=m(3);return _(n.placeOrder())}),r()()(),C()}if(i&2){let e=m(3);l(6),O((e.orderSummary==null?null:e.orderSummary.total_item_count)||"--"),l(5),O((e.orderSummary==null?null:e.orderSummary.total_item_quantity)||"--"),l(5),v(" ",e.CURRENCY_SYMBOLS.RUPEE," ",R(17,24,e.orderSummary==null?null:e.orderSummary.net_amount_before_tax,"1.2-2")," "),l(6),v(" ",e.CURRENCY_SYMBOLS.RUPEE," ",R(23,27,e.orderSummary==null?null:e.orderSummary.discount_amount,"1.2-2")," "),l(6),v(" ",e.CURRENCY_SYMBOLS.RUPEE," ",R(29,30,e.orderSummary==null?null:e.orderSummary.gross_amount,"1.2-2")," "),l(6),v(" ",e.CURRENCY_SYMBOLS.RUPEE," ",R(35,33,e.orderSummary==null?null:e.orderSummary.gst_amount,"1.2-2")," "),l(6),v(" ",e.CURRENCY_SYMBOLS.RUPEE," ",R(41,36,e.orderSummary==null?null:e.orderSummary.net_amount_with_tax,"1.2-2")," "),l(3),s("fieldReq",!0),l(3),s("buttonType","button")("buttonClass","ti-btn ti-btn-outline-danger w-full py-2 px-4 text-sm rounded-md")("label","Clear")("disabled",e.api.disabled)("loadingIconClass","ri-loader-2-fill"),l(2),s("buttonType","submit")("buttonClass","ti-btn bg-success text-white btn-wave w-full py-2 px-4 text-sm rounded-md")("label","Place Order")("iconClass","ri-shopping-cart-2-line")("loadingIconClass","ri-loader-2-fill")("disabled",e.api.disabled)}}function Dt(i,t){if(i&1&&(o(0,"div",94),u(1,Rt,2,0,"ng-container",8)(2,Lt,49,39,"ng-container",8),r()),i&2){let e=m(2);l(),s("ngIf",!e.cartDetail.length),l(),s("ngIf",e.cartDetail.length)}}function Nt(i,t){i&1&&(x(0),b(1,"app-data-not-found"),C())}function Ut(i,t){if(i&1&&(o(0,"span",121),d(1),r()),i&2){let e=m(2).$implicit;l(),S(" (",e==null?null:e.count,") ")}}function Bt(i,t){if(i&1){let e=h();o(0,"div",117)(1,"input",118),g("change",function(n){p(e);let c=m().index,f=m(2).$implicit,y=m(3);return _(y.onFilterChange(f,c,n))}),r(),o(2,"label",119),d(3),u(4,Ut,2,1,"span",120),r()()}if(i&2){let e=m(),a=e.$implicit,n=e.index,c=m(2).$implicit;l(),s("id",c+"-"+n)("checked",a.checked),l(),s("for",c+"-"+n),l(),S(" ",a==null?null:a.label," "),l(),s("ngIf",a.count!==void 0)}}function qt(i,t){if(i&1&&(x(0),u(1,Bt,5,5,"div",116),C()),i&2){let e=t.$implicit;l(),s("ngIf",e.label&&e.label.trim()&&e.count>0)}}function Yt(i,t){if(i&1){let e=h();o(0,"div",122)(1,"a",123),g("click",function(){p(e);let n=m(2).$implicit,c=m(3);return _(c.toggleShowMore(n))}),d(2),r()()}if(i&2){let e=m(2).$implicit,a=m(3);l(2),S(" ",a.showMoreMap[e]?"LESS":"MORE"," ")}}function Gt(i,t){if(i&1&&(x(0),o(1,"div",112)(2,"h6",113),d(3),k(4,"titlecase"),r(),o(5,"div",114),u(6,qt,2,1,"ng-container",66)(7,Yt,3,1,"div",115),r()(),C()),i&2){let e=m().$implicit,a=m(3);l(3),S(" ",J(4,3,e.replace("_"," "))," "),l(3),s("ngForOf",a.showMoreMap[e]?a.filterGroups[e]:a.filterGroups[e].slice(0,5)),l(),s("ngIf",a.filterGroups[e].length>5)}}function jt(i,t){if(i&1&&(x(0),u(1,Gt,8,5,"ng-container",8),C()),i&2){let e=t.$implicit,a=m(3);l(),s("ngIf",a.productDetail.length&&a.hasAnyValidFilter(e))}}function Wt(i,t){if(i&1&&(o(0,"div",111),u(1,Nt,2,0,"ng-container",8)(2,jt,2,1,"ng-container",66),r()),i&2){let e=m(2);l(),s("ngIf",!e.productDetail.length),l(),s("ngForOf",e.filterGroupKeys)}}function $t(i,t){if(i&1&&(x(0),o(1,"div",86)(2,"app-showcode-card",3)(3,"div",87),u(4,Vt,2,0,"button",88)(5,Ft,2,0,"button",89),o(6,"form",17),u(7,Dt,3,2,"div",90),r(),u(8,Wt,3,2,"div",91),r()()(),C()),i&2){let e=m();l(2),M("box-title font-medium text-[15px] block text-primarytint1color"),s("title","Order Summary")("titleView",!1),l(2),s("ngIf",e.activeTab==="cart"),l(),s("ngIf",e.activeTab==="product"),l(),s("formGroup",e.orderForm),l(),s("ngIf",e.activeTab==="cart"),l(),s("ngIf",e.activeTab==="product")}}var He=class i{constructor(t,e,a,n,c,f,y,T,w){this.moduleService=t;this.dialog=e;this.CommonApiService=a;this.fb=n;this.api=c;this.toastr=f;this.logService=y;this.alert=T;this.authService=w;this.orgData=this.authService.getUser()}CURRENCY_SYMBOLS=oe;primaryOrderForm;orderForm;filter={};data={};shippingDetails=[];submodule;quantity=1;skLoading=!1;activeTab="customer";showCompleteTab=!1;productDetail=[];cartDetail=[];discountDetail={};selectedCustomerId=null;pagination={};filterGroups={};showMoreMap={};customer_type_id;orderSummary={};productListLoading=!1;dropdownLoading=!1;isCustomerSelected=!1;uomOptions=["PCS","Boxes","Cartons"];customerCategorySubType=[];orgData={};valueChange=new Q;mainTabs=[{name:"customer",label:"Customer Details",icon:"ri-user-3-line"},{name:"product",label:"Product Detail",icon:"ri-box-3-line"},{name:"cart",label:"Cart",icon:"ri-shopping-cart-line"}];cartColumn=[{label:"Sr. No.",table_class:"Sr. No."},{label:"Product Detail"},{label:"Price",table_class:"text-right"},{label:"Discount",table_class:"text-center"},{label:"Unit Price",table_class:"text-right"},{label:"Qty",table_class:"text-center"},{label:"UOM",table_class:"text-center"},{label:"Sub-Total",table_class:"text-right"},{label:"GST",table_class:"text-right"},{label:"Net Amount",table_class:"text-right"}];gstType=[{label:"GST PAID",value:"GST PAID"},{label:"GST EXTRA",value:"GST EXTRA"}];ngOnInit(){let t=this.moduleService.getSubModuleByName("SFA","Order");t&&(this.submodule=t),this.orderForm=this.fb.group({order_create_remark:["",I.required]}),this.primaryOrderForm=this.fb.group({customer_type_id:[null,I.required],customer_type_name:[""],retailer_id:[null,I.required],distributor_id:[null,I.required],customer_id:[null,I.required],gst_type:[null,I.required]});let e=[];(this.orgData?.org?.sfa||this.orgData?.org?.dms)&&(e=[U.SECONDARY]),this.CommonApiService.getCustomerCategorySubType([U.SECONDARY]),this.getCartList()}onTabChange(t){if(t==="customer"&&this.cartDetail?.length>0){this.toastr.error("Please clear cart first","","toast-top-right");return}if(t==="product"&&this.cartDetail?.length>0){this.toastr.error("Please clear cart first","","toast-top-right");return}if(!this.selectedCustomerId&&t!=="customer"&&!(t==="cart"&&this.cartDetail?.length===0)){this.toastr.error("Please Select a Customer First","","toast-top-right");return}this.activeTab=t,t==="product"&&this.getProductList(),t==="cart"&&this.getCartList()}onNextTab(t){this.activeTab=t,t==="product"&&this.getProductList(),t==="cart"&&this.getCartList()}onPreviousTab(t){this.activeTab=t,t==="product"&&this.getProductList(),t==="cart"&&this.getCartList()}fetchOrderDropdowns(){Object.keys(this.filterGroups).length>0||(this.dropdownLoading=!0,this.api.post({},"order/fetch-order-dropdowns").subscribe(t=>{if(t.statusCode===200){let e=t.data;this.filterGroups={},Object.keys(e).forEach(a=>{this.filterGroups[a]=(e[a]||[]).map(n=>$(W({},n),{checked:!1})),this.showMoreMap[a]=!1})}this.dropdownLoading=!1}))}get filterGroupKeys(){return Object.keys(this.filterGroups)}hasAnyValidFilter(t){return this.filterGroups[t]?.some(e=>e.count>0)}onFilterChange(t,e,a){let n=a.target;this.filterGroups[t][e].checked=n.checked,this.filter={},Object.keys(this.filterGroups).forEach(c=>{let f=this.filterGroups[c].filter(y=>y.checked).map(y=>y.label);this.filter[c]=f}),this.getProductList()}onCustomerCategoryChange(t){let e=this.CommonApiService.customerCategorySubType.find(a=>a.value===t);e&&this.primaryOrderForm.patchValue({customer_type_name:e.label}),this.CommonApiService.getCustomerData(t)}onCustomerSelected(t){let e=this.CommonApiService.customerData.find(a=>a.value===t);e&&(this.primaryOrderForm.patchValue({customer_id:e.value}),this.selectedCustomerId=e.value),this.CommonApiService.getCustomerMapping(t)}onUserSelected(t){this.primaryOrderForm.patchValue({distributor_id:t}),this.isCustomerSelected=!0}getProductList(){let t=this.primaryOrderForm.get("retailer_id")?.value;t&&(this.productListLoading=!0,this.api.post({customer_id:t,filters:this.filter,page:1},"secondary-order/read-product").subscribe(e=>{e.statusCode===200&&(this.productDetail=e.data,this.discountDetail=e.data.discount_form,this.pagination=e.pagination,this.fetchOrderDropdowns(),this.productDetail.forEach(a=>{a.basic_discount=null,this.calculateProductPrice(a)})),this.productListLoading=!1}))}validateDiscount(t){if(t.basic_discount==null||t.basic_discount==="")return;let e=+t.discount_form?.basic_discount||0;+t.basic_discount>e&&(this.toastr.error("Input Disocunt Cannot be Greater than Basiq Discount","","toast-top-right"),t.basic_discount=e),this.calculateProductPrice(t)}calculateProductPrice(t){let e=this.primaryOrderForm.get("gst_type")?.value,a=+t.mrp||0,n=+t.quantity||0,c=+t.gst_percent||18,f=t.basic_discount!=null?+t.basic_discount:null;if(t.quantity=n,f===null||isNaN(f)){t.unit_price=null,t.sub_total=null,t.gst=null,t.net_amount=null,t.discount_amount=null,t.net_price_per_unit=null;return}let y=a*f/100,T=a-y,w=0,L=0,q=0,j=0;if(e==="GST PAID"){w=T;let Je=T/(1+c/100);L=(w-Je)*n}else w=T,L=w*c/100*n;q=w*n,j=q+(e==="GST PAID"?0:L),t.discount_amount=this.toFixed(y*n),t.unit_price=this.toFixed(w),t.sub_total=this.toFixed(q),t.gst=this.toFixed(L),t.net_amount=this.toFixed(j),t.net_price_per_unit=this.toFixed(T)}recalculateProductAmounts(t){let e=+t.quantity||0;if(t.quantity=e,e===0){t.sub_total=0,t.gst=0,t.net_amount=0;return}let a=this.primaryOrderForm?.get("gst_type")?.value||"GST EXTRA",n=+t.gst_percent||18,c=+t.unit_price||0,f=c*e,y=0,T=0;if(a==="GST PAID"){let w=c/(1+n/100);y=(c-w)*e,T=f}else y=f*n/100,T=f+y;t.sub_total=this.toFixed(f),t.gst=this.toFixed(y),t.net_amount=this.toFixed(T)}toFixed(t){return Math.round(t*100)/100}getCartList(){this.skLoading=!0,this.api.post({customer_id:this.selectedCustomerId,filters:this.filter,page:1},"secondary-order/read-cart").subscribe(t=>{this.skLoading=!1,t.statusCode===200&&(this.cartDetail=t.data.items,this.orderSummary=t.data.summary,this.pagination=t.pagination,this.cartDetail.length>0?this.activeTab="cart":this.activeTab="customer")})}decreaseQuantity(t){t.quantity>1?t.quantity--:t.quantity=0,this.recalculateProductAmounts(t)}increaseQuantity(t){t.quantity=(+t.quantity||0)+1,this.recalculateProductAmounts(t)}toggleShowMore(t){this.showMoreMap[t]=!this.showMoreMap[t]}onSearch(t,e){if(!(!t||t.trim().length<2)&&e==="customer"){let a=this.primaryOrderForm.get("customer_type_id")?.value;this.CommonApiService.getCustomerData(a,U.PRIMARY,t)}}changeToPagination(t){t=="Previous"?this.pagination.prev&&this.pagination.cur_page>1&&(this.pagination.cur_page--,this.getProductList()):this.pagination.next&&(this.pagination.cur_page++,this.getProductList())}changeToPage(t){this.pagination.cur_page=t,this.getProductList()}openSchemeModal(t){this.dialog.open(Ke,{width:"400px",data:{lastPage:"order-add",scheme_id:t||null}}).afterClosed().subscribe(a=>{a===!0&&this.getProductList()})}addOrder(t){if(!this.selectedCustomerId)return this.toastr.error("Please select a customer.","","toast-top-right");if(!t||!t._id)return this.toastr.error("Invalid product data.","","toast-top-right");if(!t.quantity||t.quantity<=0)return this.toastr.error("Quantity must be greater than 0.","","toast-top-right");if(!t.unit_price||t.unit_price<=0)return this.toastr.error("Unit price is required and must be greater than 0.","","toast-top-right");if(!t.uom)return this.toastr.error("Please select Unit of Measure (UOM).","","toast-top-right");let e=this.primaryOrderForm.get("distributor_id")?.value;this.calculateProductPrice(t);let a={customer_id:this.selectedCustomerId,customer_type_id:this.customer_type_id,product_id:t._id,product_code:t.product_code,product_name:t.product_name,category_name:t.category_name||"--",total_quantity:t.quantity,mrp:t.mrp,unit_price:t.unit_price,gross_amount:t.sub_total,gst_amount:t.gst,gst_percent:t.gst_percent||18,net_amount_with_tax:t.net_amount,uom:t.uom,discount_percent:t.basic_discount||0,discount_amount:t.discount_amount||0,delivery_from:e||null};t.scheme_id&&(a.scheme_id=t.scheme_id),this.api.post(a,"secondary-order/add-cart").subscribe(n=>{n.statusCode===200&&(this.toastr.success(n.message,"","toast-top-right"),this.getProductList())})}placeOrder(){let t=this.orderForm.get("order_create_remark")?.value?.trim(),e=this.primaryOrderForm.get("gst_type")?.value;if(!t){this.toastr.error("Please enter a remark before placing the order.","","toast-top-right");return}this.alert.confirm("Do you want to place the order?").then(a=>{a.isConfirmed&&(this.api.disabled=!0,this.api.post({customer_id:this.selectedCustomerId,order_create_remark:t,gst_type:e},"secondary-order/secondary-order-add").subscribe(n=>{n?.statusCode===200||n?.success===!0?(this.toastr.success(n.message||"Order placed successfully.","","toast-top-right"),this.showCompleteTab=!0,this.activeTab="complete"):this.toastr.error(n?.message||"Failed to place the order.","","toast-top-right"),this.api.disabled=!1}))})}removeCart(){this.alert.confirm("Are you sure you want to clear the cart?").then(t=>{t.isConfirmed&&(this.api.disabled=!0,this.api.patch({customer_id:this.selectedCustomerId},"secondary-order/delete-cart").subscribe(e=>{e.statusCode===200&&(G.default.fire("Cleared!",e.message,"success"),this.getCartList()),this.api.disabled=!1}))})}onDeletCart(t){this.alert.confirm("Are you sure?").then(e=>{e.isConfirmed&&this.api.patch({_id:t,is_delete:1},"secondary-order/delete-cart-item").subscribe(a=>{a.statusCode===200&&(this.logService.logActivityOnDelete(this.submodule.module_id,this.submodule.title,"delete",t,"Order",this.submodule.module_type),G.default.fire("Deleted!",a.message,"success"),this.getCartList())})})}static \u0275fac=function(e){return new(e||i)(E(Ee),E(Me),E(ve),E(fe),E(Ce),E(ae),E(We),E(he),E(ye))};static \u0275cmp=X({type:i,selectors:[["app-secondary-order-add"]],outputs:{valueChange:"valueChange"},decls:19,vars:29,consts:[[3,"title","title1","activeitem"],[1,"grid","grid-cols-12","sm:gap-x-6"],[3,"ngClass"],[3,"title","titleView"],["aria-label","Tabs","role","tablist",1,"nav","nav-tabs","tab-style-8","scaleX","md:flex","block","justify-around","border","border-dashed","dark:border-defaultborder/10","border-b-0","bg-light","rounded-top"],[3,"countShow","tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"countShow","tabs","activeTab","tabChange",4,"ngIf"],["id","myTabContent",1,"tab-content","border","border-dashed","dark:border-defaultborder/10"],[4,"ngIf"],[1,"table-responsive","overflow-auto","table-bordered-default","mt-2","whitespace-nowrap"],["class","px-4 py-3 border-top border-block-start-dashed sm:flex justify-between",4,"ngIf"],[1,"table-responsive","overflow-auto","table-bordered-default","whitespace-nowrap"],["class","px-6 py-4 border-t border-dashed dark:border-defaultborder/10 sm:flex justify-between",4,"ngIf"],[1,"checkout-payment-success"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"tabChange","countShow","tabs","activeTab"],[1,"xl:col-span-12","col-span-12","mt-4"],[3,"formGroup"],[1,"grid","grid-cols-12","sm:gap-x-6","px-3"],[1,"xl:col-span-3","col-span-12","mb-3"],["formControlName","customer_type_id","label","Customer Category",3,"selectedChange","fieldReq","options","multiple"],["class","xl:col-span-3 col-span-12 mb-3",4,"ngIf"],["class","px-6 py-4 border-t border-dashed dark:border-defaultborder/10 sm:flex justify-end",4,"ngIf"],["label","Retailers","formControlName","retailer_id",1,"remove-space",3,"searchChanged","selectedChange","fieldReq","options","multiple","search"],["label","Distributors","formControlName","distributor_id",1,"remove-space",3,"searchChanged","selectedChange","fieldReq","options","multiple","search"],["formControlName","gst_type","label","GST Type",3,"fieldReq","options","multiple"],[1,"px-6","py-4","border-t","border-dashed","dark:border-defaultborder/10","sm:flex","justify-end"],["type","button","id","personal-details-trigger",1,"ti-btn","ti-btn-soft-success",3,"click"],[1,"ri-skip-right-fill","ms-2","align-middle","inline-block"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"columns","showAction"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"text-center"],[1,"table-search-filters"],[1,"table-input"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","product-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"product-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"cart-items01"],[1,"flex","items-center"],[1,"flex-auto"],[1,"text-[10px]","font-semibold"],[3,"click"],[1,"badge","bg-primarytint3color","text-white","text-[0.5625rem]","inline-flex","gap-1"],[1,"flex","gap-4","flex-wrap","mb-1","items-center"],[1,"me-1"],[1,"font-normal","text-textmuted","dark:text-textmuted/50"],[1,"text-right"],[1,"w80"],["type","number","placeholder","Discount",1,"border","border-gray-300","rounded","px-3","py-1","w-full","focus:outline-none","focus:border-blue-500",3,"ngModelChange","blur","ngModel","name"],[1,"product-quantity-container"],[1,"flex","items-center","flex-nowrap","gap-1","rounded-full","cart-input-group"],["type","button","aria-label","button",1,"ti-btn","ti-btn-icon","btn-wave","ti-btn-sm","!rounded-full","bg-primary/10","text-primary","border","product-quantity-minus1","border-end-0","waves-effect","waves-light",3,"click"],[1,"ri-subtract-line"],["type","number","min","0","aria-label","number","value","2",1,"form-control","form-control-sm","!rounded-full","text-center","p-0",3,"ngModelChange","ngModel"],["type","button","aria-label","button",1,"ti-btn","ti-btn-icon","btn-wave","ti-btn-sm","!rounded-full","bg-primary/10","text-primary","border","product-quantity-plus1","border-start-0","waves-effect","waves-light",3,"click"],[1,"ri-add-line"],["appearance","fill",1,"mat-custom-field","remove-space","w80"],["placeholder","Selct UOM",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"font-semibold","text-[14px]","text-right"],[3,"click","icon","buttonClass"],[1,"ri-discount-percent-line","text-[10px]"],[3,"value"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"px-4","py-3","border-top","border-block-start-dashed","sm:flex","justify-between"],["type","button","id","back-shipping-trigger",1,"ti-btn","ti-btn-soft-danger","m-1",3,"click"],[1,"ri-skip-left-fill","me-2","align-middle","inline-block"],["type","button","id","payment-trigger",1,"ti-btn","ti-btn-soft-success","m-1",3,"click"],[1,"ri-skip-right-fill","align-middle","ms-2","inline-block"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],[1,"mb-1","text-[12px]","font-semibold"],["matTooltip","Delete Cart",3,"clickEvent","icon","buttonClass"],[1,"px-6","py-4","border-t","border-dashed","dark:border-defaultborder/10","sm:flex","justify-between"],["type","button","id","back-personal-trigger",1,"ti-btn","ti-btn-soft-danger","m-1",3,"click"],[1,"mb-4"],[1,"text-success","font-semibold"],[1,"mb-4","flex","justify-center"],["src","./assets/images/ecommerce/png/24.png","alt",""],[1,"mb-1","text-[14px]"],["href","javascript:void(0);",1,"text-primarytint1color"],[1,"text-textmuted","dark:text-textmuted/50"],[1,"ti-btn","bg-primary","text-white"],[1,"bi","bi-file-earmark-pdf","ms-2"],[1,"xl:col-span-3","col-span-12"],[1,"border-b","border-defaultborder","dark:border-defaultborder/10","border-dashed"],["type","button","class","hs-tab-active text-primary text-[16px] bg-light rounded-top nav-link w-full active","id","freeshipping-pane","aria-selected","true","data-hs-tab","#freeshipping","aria-controls","freeshipping","role","tab",4,"ngIf"],["type","button","class","hs-tab-active text-primary text-[16px] nav-link w-full active mb-2","id","filter-tab-pane","aria-selected","true","data-hs-tab","#filter","aria-controls","filter","role","tab",4,"ngIf"],["class","overflow-hidden p-0 border-0 min-h-[150px]",4,"ngIf"],["class","overflow-hidden p-0 border-0 scroll-y-600 pr-2",4,"ngIf"],["type","button","id","freeshipping-pane","aria-selected","true","data-hs-tab","#freeshipping","aria-controls","freeshipping","role","tab",1,"hs-tab-active","text-primary","text-[16px]","bg-light","rounded-top","nav-link","w-full","active"],["type","button","id","filter-tab-pane","aria-selected","true","data-hs-tab","#filter","aria-controls","filter","role","tab",1,"hs-tab-active","text-primary","text-[16px]","nav-link","w-full","active","mb-2"],[1,"overflow-hidden","p-0","border-0","min-h-[150px]"],[1,"pr-2"],[1,"flex","items-center","justify-between","pt-3","mb-2"],[1,"text-textmuted","dark:text-textmuted/50","text-[12px]"],[1,"font-medium","text-[12px]"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-medium","text-[12px]","text-success"],[1,"font-medium","text-[12px]","text-danger"],[1,"text-[1rem]"],[1,"font-semibold"],[1,"xl:col-span-6","col-span-12","mb-3"],["label","Description","formControlName","order_create_remark","type","textarea",1,"remove-default-class",3,"fieldReq"],[1,"flex","justify-center","gap-4","mt-4"],[1,"w-1/3"],["matTooltip","Remove Cart",3,"click","buttonType","buttonClass","label","disabled","loadingIconClass"],[1,"w-2/2"],["matTooltip","Place Order",3,"click","buttonType","buttonClass","label","iconClass","loadingIconClass","disabled"],[1,"overflow-hidden","p-0","border-0","scroll-y-600","pr-2"],[1,"mb-3"],[1,"font-semibold","mb-2","capitalize","text-[12px]","bg-light","rounded-top","px-2","py-1"],[1,"scroll-y-300","pr-2"],["class","mt-2",4,"ngIf"],["class","form-check border-b pt-1 mb-1",4,"ngIf"],[1,"form-check","border-b","pt-1","mb-1"],["type","checkbox",1,"form-check-input","float-end",3,"change","id","checked"],[1,"form-check-label","text-[10px]","text-wrap","pe-3","!ps-0",3,"for"],["class","text-[11px] font-normal text-textmuted",4,"ngIf"],[1,"text-[11px]","font-normal","text-textmuted"],[1,"mt-2"],[1,"ecommerce-more-link","cursor-pointer",3,"click"]],template:function(e,a){e&1&&(b(0,"app-page-header",0),o(1,"div",1)(2,"div",2)(3,"app-showcode-card",3)(4,"nav",4),u(5,ot,1,9,"app-listing-tab",5)(6,at,1,6,"app-listing-tab",6),r(),o(7,"div",7),u(8,mt,10,8,"ng-container",8),o(9,"div",9),u(10,yt,31,7,"ng-container",8)(11,vt,7,0,"div",10),r(),o(12,"div",11),u(13,It,31,7,"ng-container",8)(14,Mt,4,0,"div",12),r(),o(15,"div",13),u(16,Pt,20,0,"ng-container",8),r()(),o(17,"app-pagination-footer",14),g("preButtonClick",function(){return a.changeToPagination("Previous")})("nextButtonClick",function(){return a.changeToPagination("Next")})("pageChange",function(c){return a.changeToPage(c)}),r()()(),u(18,$t,9,9,"ng-container",8),r()),e&2&&(s("title","Secondary Order")("title1",A(25,tt))("activeitem","Secondary Order Add"),l(2),s("ngClass",H(26,nt,a.activeTab==="cart"||a.activeTab==="product",a.activeTab==="customer"||a.activeTab==="complete")),l(),M("box-title font-medium text-[15px] block text-primarytint1color"),s("title","Cart Items")("titleView",!1),l(2),s("ngForOf",a.mainTabs),l(),s("ngIf",a.showCompleteTab),l(2),s("ngIf",a.activeTab==="customer"),l(2),s("ngIf",a.activeTab==="product"),l(),s("ngIf",a.activeTab==="product"),l(2),s("ngIf",a.activeTab==="cart"),l(),s("ngIf",a.activeTab==="cart"),l(2),s("ngIf",a.activeTab==="complete"),l(),M("p-0"),s("currentPage",a.pagination.cur_page)("totalPage",a.pagination.total_pages)("pageLimit",a.pagination.limit)("listLength",a.productDetail.length)("preBtn",!a.pagination.prev)("nextBtn",!a.pagination.next),l(),s("ngIf",a.activeTab==="cart"||a.activeTab==="product"))},dependencies:[je,Z,ee,te,me,le,pe,de,ce,ge,se,_e,ue,qe,De,$e,Se,Ue,Ne,Ge,Qe,Be,Ve,ie,ne,Xe,Ye,re,Fe,Te,Ae,ke,Ie,Oe,we,Pe,Re,Le,xe,be],encapsulation:2})};export{He as SecondaryOrderAddComponent};
