import{a as Se}from"./chunk-J4NDCUAB.js";import{a as Ce}from"./chunk-REKAXM5L.js";import{a as be}from"./chunk-SQZ3YN6N.js";import{b as _e,c as fe}from"./chunk-CIBZCVJQ.js";import{a as ue}from"./chunk-OTFCGVEU.js";import{a as ge}from"./chunk-HPLI5COI.js";import{a as le}from"./chunk-OEHD5D2Y.js";import{a as he}from"./chunk-GLWQGYBC.js";import{a as Q}from"./chunk-DC4QM32I.js";import{F as de,c as J,q as pe,s as ce,u as me}from"./chunk-VHE3PQ3O.js";import{$ as z,Aa as $,B as Y,Ea as ee,G as U,Ga as te,Ha as ie,Ia as ne,Ja as ae,Qa as oe,W as G,Z as q,hb as re,jb as se,va as X,w as j,wa as Z,z as K}from"./chunk-GYDYF5F3.js";import{M as O,f as A,g as R,o as H,t as N}from"./chunk-PD5VTTIY.js";import{$c as D,Aa as m,Ba as d,Hb as x,Lc as E,Mc as g,Nc as b,Ob as f,Uc as W,Vc as T,Wc as k,Yc as L,Zc as V,_b as p,ac as F,bc as w,ed as P,fc as I,gd as B,kc as s,lc as o,mc as S,nc as C,oc as v,qc as y,rb as r,sb as _,wc as u,yc as h}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";var ye=()=>["Bonus"],M=()=>[],Le=(n,e,i)=>({name:n,label:e,count:i}),we=n=>[n];function We(n,e){n&1&&S(0,"app-skeleton"),n&2&&w("w100 h25")}function Te(n,e){n&1&&(C(0),f(1,We,1,2,"app-skeleton",19),v()),n&2&&(r(),p("ngForOf",L(1,M).constructor(2)))}function ke(n,e){if(n&1){let i=y();s(0,"app-listing-tab",21),u("tabChange",function(a){m(i);let l=h(2);return d(l.onTabChange(a.tab))}),o()}if(n&2){let i=e.$implicit,t=h(2);p("tabs",V(6,we,D(2,Le,i.name,i.label,i.count)))("activeTab",t.activeTab)}}function Ie(n,e){if(n&1&&(C(0),f(1,ke,1,8,"app-listing-tab",20),v()),n&2){let i=h();r(),p("ngForOf",i.mainTabs)}}function Me(n,e){if(n&1){let i=y();s(0,"button",22),u("click",function(){m(i);let a=h();return a.filter.created_name="",d(a.getSpinWinList())}),s(1,"mat-icon"),g(2,"close"),o()()}}function xe(n,e){if(n&1){let i=y();s(0,"button",22),u("click",function(){m(i);let a=h();return a.filter.customer_type_name="",d(a.getSpinWinList())}),s(1,"mat-icon"),g(2,"close"),o()()}}function Fe(n,e){if(n&1){let i=y();s(0,"tr",10)(1,"td",11),g(2),o(),s(3,"td"),g(4),P(5,"date"),o(),s(6,"td"),g(7),o(),s(8,"td"),g(9),o(),s(10,"td"),g(11),o(),s(12,"td"),g(13),o(),s(14,"td"),g(15),o(),s(16,"td")(17,"span",24)(18,"app-toggle",25),u("checkedChange",function(a){let l=m(i).$implicit,c=h(2);return d(c.onToggleChange(a,l._id,l.status))}),o()()(),s(19,"td")(20,"div")(21,"app-icon-button",26),u("clickEvent",function(){let a=m(i).$implicit,l=h(2);return d(l.openMainLogModal(a._id))}),o(),s(22,"app-icon-button",26),u("clickEvent",function(){let a=m(i).$implicit,l=h(2);return d(l.onUpdate(a._id))}),o()()()()}if(n&2){let i=e.$implicit,t=e.index,a=h(2);F("bg-gray-400",a.isHighlighted(i._id)),r(2),b((a.pagination.cur_page-1)*a.pagination.limit+t+1),r(2),b(i.created_at?B(5,14,i.created_at,"d MMM yyyy"):"---"),r(3),b(i.created_name?i.created_name:"---"),r(2),b((i.customer_type_name==null?null:i.customer_type_name.join(", "))||"--"),r(2),b(i.point_section||"--"),r(2),b(i.eligible_days?i.eligible_days+" Days":"--"),r(2),b(a.getSlabPoints(i.slab_data)),r(3),p("checked",i.isChecked),r(3),p("icon","ri-file-list-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light"),r(),p("icon","ri-edit-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-success waves-effect waves-light")}}function Ee(n,e){if(n&1&&(C(0),f(1,Fe,23,17,"tr",23),v()),n&2){let i=h();r(),p("ngForOf",i.spinWinList)("ngForTrackBy",i.trackById)}}function Ve(n,e){n&1&&(s(0,"td"),S(1,"app-skeleton"),o()),n&2&&(r(),w("h20 bg-skeleton"))}function De(n,e){n&1&&(s(0,"tr",10),f(1,Ve,2,2,"td",28),o()),n&2&&(r(),p("ngForOf",L(1,M).constructor(9)))}function Pe(n,e){n&1&&(C(0),f(1,De,2,2,"tr",27),v()),n&2&&(r(),p("ngForOf",L(1,M).constructor(8)))}function Be(n,e){n&1&&(C(0),S(1,"app-data-not-found"),v())}var ve=class n{constructor(e,i,t,a,l,c,Ae,Re,He,Ne){this.dialog=e;this.api=i;this.alert=t;this.router=a;this.dateFormat=l;this.toastr=c;this.moduleService=Ae;this.logService=Re;this.comanFuncation=He;this.highlightService=Ne}mainTabs=[];FORMID=ge;filter={};skLoading=!1;view;pagination={};spinWinList=[];cashMasterList=[];moduleFormId=0;submoduleId={};sorting={};spinWinDetails;spinWinId;activeTab="Active";tabCount={};pageKey="spin-win-list";highlightedId;submodule={};accessRight={};ngOnInit(){let e=this.moduleService.getAccessMap("IRP","Bonus","Spin & Win");e&&(this.accessRight=e),this.getSpinWinList();let i=this.moduleService.getSubModuleByName("IRP","Bonus"),t=this.moduleService.getSubSubModuleByName("IRP","Bonus","Spin & Win"),a=this.moduleService.getFormById("IRP","Bonus",this.FORMID.ID.SpinWinList);t&&(this.submodule=t),a&&(this.moduleFormId=a.form_id);let l=this.highlightService.getHighlight(this.pageKey);l!=null&&(this.activeTab=l.tab,this.highlightedId=l.rowId,this.pagination.cur_page=l.pageIndex,this.filter=l.filters,this.highlightService.clearHighlight(this.pageKey))}spinWinListColumns=[{label:"S.No",field:"S.No"},{label:"Created At",field:"Created At"},{label:"Created Name",field:"Created Name"},{label:"Customer Category",field:"Customer Category"},{label:"Point Section",field:"Point Section"},{label:"Eligibilty Days Interval",field:"Eligibilty Days Interval"},{label:"Spin Points Slab",field:"Spin Points Slab"},{label:"Status",field:"Status"},{label:"Action",field:"Action"}];onTabChange(e){this.activeTab=e,this.activeTab==="Active"&&this.getSpinWinList(),this.getSpinWinList()}isHighlighted(e){return this.highlightedId===e}setHighLight(e){this.comanFuncation.setHighLight(this.pageKey,e,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}goToSpinWinAdd(){this.router.navigate(["/apps/loyalty/spin-win-list/spin-win-add"])}trackById(e,i){return i.id}getSpinWinList(){this.skLoading=!0,this.api.post({filters:this.filter,activeTab:this.activeTab,page:this.pagination.cur_page??1},"spin-win/read").subscribe(e=>{if(e.statusCode==200){this.skLoading=!1,this.spinWinList=e.data.result,this.tabCount=e.data.statusTabs?e.data.statusTabs:{},this.mainTabs=[{name:"Active",label:"Active",icon:"ri-team-fill",count:this.tabCount.activeCount?this.tabCount.activeCount:0},{name:"Inactive",label:"Inactive",icon:"ri-calendar-check-fill",count:this.tabCount.inActiveCount?this.tabCount.inActiveCount:0}],this.pagination=e.pagination;for(let i=0;i<this.spinWinList.length;i++){let t=this.spinWinList[i];t.isChecked=t.status==="Active"}}})}getSlabPoints(e){return e?.map(i=>i.slab_point).join(", ")||"--"}onRefresh(){this.filter={},this.getSpinWinList()}onDateChange(e,i){if(i){let t=this.dateFormat.formatToYYYYMMDD(i);this.filter[e]=t}else this.filter[e]=null;(this.filter.date_from&&this.filter.date_to||this.filter.created_at)&&this.getSpinWinList()}openMainLogModal(e){this.comanFuncation.listLogsModal(this.submoduleId.sub_module_id,e,this.submoduleId.module_type).subscribe(i=>{})}changeToPagination(e){e==="Next"&&this.pagination.cur_page<this.pagination.total_pages?this.pagination.cur_page++:e==="Previous"&&this.pagination.cur_page>1&&this.pagination.cur_page--,this.getSpinWinList()}changeToPage(e){this.pagination.cur_page=e,this.getSpinWinList()}onToggleChange(e,i,t){this.comanFuncation.statusChange(e,i,t,this.submoduleId,"toggle","spin-win/update-status").subscribe(a=>{a?this.getSpinWinList():this.getSpinWinList()})}onUpdate(e){this.setHighLight(e),this.router.navigate(["/apps/loyalty/spin-win-list/edit",e,"edit"])}getSpinWinDetail(){this.skLoading=!0,this.api.post({_id:this.spinWinId},"spin-win/detail").subscribe(e=>{e.statusCode===200&&(this.skLoading=!1,this.spinWinDetails=e.data)})}static \u0275fac=function(i){return new(i||n)(_(oe),_(q),_(z),_(O),_(se),_(j),_(Q),_(ue),_(fe),_(_e))};static \u0275cmp=x({type:n,selectors:[["app-spin-win-list"]],decls:45,vars:35,consts:[["picker",""],[3,"title","title1","activeitem","btnShow1"],[1,"box","py-3","px-4"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[4,"ngIf"],[1,"row"],[1,"col-xl-12"],[3,"onRefresh","button1","pageTitle","refreshLabel","btnShow","btnShow2","addBtnLabel"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-hover ti-head-primary",3,"tableHead","tableHeadColumn","tableHeight","showCheckbox","columns"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","createdAt","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"class",4,"ngFor","ngForOf"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf","ngForTrackBy"],[1,"badge"],[3,"checkedChange","checked"],[3,"clickEvent","icon","buttonClass"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"]],template:function(i,t){if(i&1){let a=y();S(0,"app-page-header",1),s(1,"div",2)(2,"nav",3),f(3,Te,2,2,"ng-container",4)(4,Ie,2,1,"ng-container",4),o(),s(5,"div",5)(6,"div",6)(7,"app-page-sub-header",7),u("onRefresh",function(){return m(a),d(t.onRefresh())})("button1",function(){return m(a),d(t.goToSpinWinAdd())}),o(),s(8,"div",8)(9,"div",8)(10,"spk-reusable-tables",9)(11,"tr",10)(12,"td",11),g(13,"\xA0"),o(),s(14,"td")(15,"div",12)(16,"mat-form-field",13)(17,"input",14),k("ngModelChange",function(c){return m(a),T(t.filter.created_at,c)||(t.filter.created_at=c),d(c)}),u("ngModelChange",function(c){return m(a),d(t.onDateChange("created_at",c))}),o(),S(18,"mat-datepicker-toggle",15)(19,"mat-datepicker",null,0),o()()(),s(21,"td",11)(22,"div",12)(23,"mat-form-field",13)(24,"input",16),k("ngModelChange",function(c){return m(a),T(t.filter.created_name,c)||(t.filter.created_name=c),d(c)}),u("keyup.enter",function(){return m(a),d(t.getSpinWinList())}),o(),f(25,Me,3,0,"button",17),o()()(),s(26,"td",11)(27,"div",12)(28,"mat-form-field",13)(29,"input",16),k("ngModelChange",function(c){return m(a),T(t.filter.customer_type_name,c)||(t.filter.customer_type_name=c),d(c)}),u("keyup.enter",function(){return m(a),d(t.getSpinWinList())}),o(),f(30,xe,3,0,"button",17),o()()(),s(31,"td",11),g(32,"\xA0"),o(),s(33,"td",11),g(34,"\xA0"),o(),s(35,"td",11),g(36,"\xA0"),o(),s(37,"td",11),g(38,"\xA0"),o(),s(39,"td",11),g(40,"\xA0"),o()(),f(41,Ee,2,2,"ng-container",4)(42,Pe,2,2,"ng-container",4),o(),f(43,Be,2,0,"ng-container",4),o(),s(44,"app-pagination-footer",18),u("preButtonClick",function(){return m(a),d(t.changeToPagination("Previous"))})("nextButtonClick",function(){return m(a),d(t.changeToPagination("Next"))})("pageChange",function(c){return m(a),d(t.changeToPage(c))}),o()()()()()}if(i&2){let a=E(20);p("title","IRP")("title1",L(34,ye))("activeitem","Spin & Win")("btnShow1",!1),r(3),p("ngIf",t.skLoading),r(),p("ngIf",!t.skLoading),r(3),w("p-0 pt-3"),p("pageTitle","Spin & Win List")("refreshLabel","Refresh")("btnShow",!0)("btnShow2",t.accessRight==null?null:t.accessRight.addRight)("addBtnLabel","Add Spin & Win"),r(3),p("tableHead","border-b")("tableHeadColumn","!text-center")("tableHeight","630px")("showCheckbox",!1)("columns",t.spinWinListColumns),r(7),p("matDatepicker",a),W("ngModel",t.filter.created_at),r(),p("for",a),r(6),W("ngModel",t.filter.created_name),r(),I(t.filter.created_name?25:-1),r(4),W("ngModel",t.filter.customer_type_name),r(),I(t.filter.customer_type_name?30:-1),r(11),p("ngIf",!t.skLoading),r(),p("ngIf",t.skLoading),r(),p("ngIf",!t.spinWinList.length&&!t.skLoading),r(),p("currentPage",t.pagination.cur_page)("totalPage",t.pagination.total_pages)("pageLimit",t.pagination.limit)("listLength",t.spinWinList.length)("preBtn",!t.pagination.prev)("nextBtn",!t.pagination.next)}},dependencies:[N,A,R,H,de,K,Y,U,he,J,ce,pe,Se,be,Ce,me,le,G,re,$,ie,ne,ae,ee,te,Z,X],encapsulation:2})};export{ve as SpinWinListComponent};
