import{a as ye}from"./chunk-J4NDCUAB.js";import{a as Se}from"./chunk-REKAXM5L.js";import{b as be,c as Ce}from"./chunk-CIBZCVJQ.js";import{a as he}from"./chunk-OTFCGVEU.js";import{a as fe}from"./chunk-HPLI5COI.js";import{a as ce}from"./chunk-OEHD5D2Y.js";import{a as ve}from"./chunk-GLWQGYBC.js";import{a as $}from"./chunk-DC4QM32I.js";import{F as _e,c as Z,q as me,s as ue,u as ge}from"./chunk-VHE3PQ3O.js";import{$ as X,Aa as ie,B as q,Ea as ne,G as z,Ga as oe,Ha as ae,Ia as re,Ja as se,Qa as le,W as J,Z as Q,_ as Te,hb as pe,jb as de,va as ee,w as G,wa as te,z as U}from"./chunk-GYDYF5F3.js";import{K as O,M as Y,N as j,Q as K,f as A,g as W,o as H,t as N}from"./chunk-PD5VTTIY.js";import{$c as R,Aa as d,Ba as c,Hb as x,Lc as P,Mc as g,Nc as C,Ob as f,Uc as y,Vc as S,Wc as L,Yc as T,Zc as D,_b as m,ac as E,bc as M,ed as I,fc as k,gd as V,kc as p,lc as s,mc as b,nc as B,oc as w,qc as v,rb as r,sb as _,wc as u,yc as h}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{g as we}from"./chunk-66YHNWRR.js";var Be=we(Te());var Me=()=>["Bonus"],F=()=>[],ke=(o,i,t)=>({name:o,label:i,count:t}),Pe=o=>[o],Ie=o=>["/apps/loyalty/bonus/detail",o];function Ve(o,i){o&1&&b(0,"app-skeleton"),o&2&&M("w100 h25")}function De(o,i){o&1&&(B(0),f(1,Ve,1,2,"app-skeleton",26),w()),o&2&&(r(),m("ngForOf",T(1,F).constructor(2)))}function Fe(o,i){if(o&1){let t=v();p(0,"app-listing-tab",28),u("tabChange",function(n){d(t);let l=h(2);return c(l.onTabChange(n.tab))}),s()}if(o&2){let t=i.$implicit,e=h(2);m("tabs",D(6,Pe,R(2,ke,t.name,t.label,t.count)))("activeTab",e.activeTab)}}function xe(o,i){if(o&1&&(B(0),f(1,Fe,1,8,"app-listing-tab",27),w()),o&2){let t=h();r(),m("ngForOf",t.mainTabs)}}function Ee(o,i){if(o&1){let t=v();p(0,"button",29),u("click",function(){d(t);let n=h();return n.filter.created_name="",c(n.getBonusList())}),p(1,"mat-icon"),g(2,"close"),s()()}}function Re(o,i){if(o&1){let t=v();p(0,"button",29),u("click",function(){d(t);let n=h();return n.filter.customer_type_name="",c(n.getBonusList())}),p(1,"mat-icon"),g(2,"close"),s()()}}function Ae(o,i){if(o&1){let t=v();p(0,"button",29),u("click",function(){d(t);let n=h();return n.filter.title="",c(n.getBonusList())}),p(1,"mat-icon"),g(2,"close"),s()()}}function We(o,i){if(o&1){let t=v();p(0,"tr",12)(1,"td",13),g(2),s(),p(3,"td"),g(4),I(5,"date"),s(),p(6,"td"),g(7),s(),p(8,"td"),g(9),I(10,"date"),s(),p(11,"td"),g(12),I(13,"date"),s(),p(14,"td"),g(15),s(),p(16,"td")(17,"a",31),u("click",function(){let n=d(t).$implicit,l=h(2);return c(l.setHighLight(n._id))}),g(18),s()(),p(19,"td")(20,"span",32)(21,"app-toggle",33),u("checkedChange",function(n){let l=d(t).$implicit,a=h(2);return c(a.onToggleChange(n,l._id,l.status))}),s()()()()}if(o&2){let t=i.$implicit,e=i.index,n=h(2);E("bg-gray-400",n.isHighlighted(t._id)),r(2),C((n.pagination.cur_page-1)*n.pagination.limit+e+1),r(2),C(t.created_at?V(5,11,t.created_at,"d MMM yyyy"):"---"),r(3),C(t.created_name?t.created_name:"---"),r(2),C(t.start_date?V(10,14,t.start_date,"d MMM yyyy"):"---"),r(3),C(t.end_date?V(13,17,t.end_date,"d MMM yyyy"):"---"),r(3),C(t.customer_type_name?t.customer_type_name:"---"),r(2),m("routerLink",D(20,Ie,t._id)),r(),C(t.title||"--"),r(3),m("checked",t.isChecked)}}function He(o,i){if(o&1&&(B(0),f(1,We,22,22,"tr",30),w()),o&2){let t=h();r(),m("ngForOf",t.bonusList)("ngForTrackBy",t.trackById)}}function Ne(o,i){o&1&&(p(0,"td"),b(1,"app-skeleton"),s()),o&2&&(r(),M("h20 bg-skeleton"))}function Oe(o,i){o&1&&(p(0,"tr",12),f(1,Ne,2,2,"td",35),s()),o&2&&(r(),m("ngForOf",T(1,F).constructor(8)))}function Ye(o,i){o&1&&(B(0),f(1,Oe,2,2,"tr",34),w()),o&2&&(r(),m("ngForOf",T(1,F).constructor(8)))}function je(o,i){o&1&&(B(0),b(1,"app-data-not-found"),w())}var Le=class o{constructor(i,t,e,n,l,a,Ke,Ge,Ue,qe,ze){this.dialog=i;this.api=t;this.alert=e;this.router=n;this.dateService=l;this.toastr=a;this.moduleService=Ke;this.logService=Ge;this.comanFuncation=Ue;this.route=qe;this.highlightService=ze}FORMID=fe;filter={};skLoading=!1;view;pagination={};bonusList=[];sorting={};moduleFormId=0;moduleId=0;submoduleId={};moduleName="";mainTabs=[];activeTab="Active";tabCount={};pageKey="bonus-list";highlightedId;accessRight={};ngOnInit(){let i=this.moduleService.getAccessMap("IRP","Bonus");i&&(this.accessRight=i);let t=this.moduleService.getSubModuleByName("IRP","Bonus"),e=this.moduleService.getSubSubModuleByName("IRP","Bonus","Spin & Win"),n=this.moduleService.getFormById("IRP","Bonus",this.FORMID.ID.BonusList);t&&(this.submoduleId=t,this.submoduleId.sub_module_id=this.submoduleId.module_id),e&&(this.submoduleId=e,this.moduleName=e.title),n&&(this.moduleFormId=n.form_id);let l=this.highlightService.getHighlight(this.pageKey);l!=null&&(this.activeTab=l.tab,this.highlightedId=l.rowId,this.pagination.cur_page=l.pageIndex,this.filter=l.filters,this.highlightService.clearHighlight(this.pageKey)),this.getBonusList()}spinWinListColumns=[{label:"S.No",field:"S.No"},{label:"Created At",field:"Created At"},{label:"Created Name",field:"Created Name"},{label:"Date From",field:"Date From"},{label:"Date To",field:"Date To"},{label:"Customer Category",field:"Customer Category"},{label:"Title",field:"Title"},{label:"Status",field:"Status"}];onTabChange(i){this.activeTab=i,this.activeTab==="Active"&&this.getBonusList(),this.getBonusList()}onRefresh(){this.filter={},this.getBonusList()}isHighlighted(i){return this.highlightedId===i}setHighLight(i){this.comanFuncation.setHighLight(this.pageKey,i,this.activeTab,this.filter,this.pagination.cur_page?this.pagination.cur_page:1)}goToBonusAdd(){this.router.navigate(["/apps/loyalty/bonus/bonus-add"])}trackById(i,t){return t.id}getBonusList(){this.skLoading=!0,this.api.post({filters:this.filter,activeTab:this.activeTab,page:this.pagination.cur_page??1},"bonus/read").subscribe(i=>{if(i.statusCode==200){this.skLoading=!1,this.bonusList=i.data.result,this.tabCount=i.data.statusTabs?i.data.statusTabs:{},this.mainTabs=[{name:"Active",label:"Active",icon:"ri-team-fill",count:this.tabCount.activeCount?this.tabCount.activeCount:0},{name:"Inactive",label:"Inactive",icon:"ri-calendar-check-fill",count:this.tabCount.inActiveCount?this.tabCount.inActiveCount:0}],this.pagination=i.pagination;for(let t=0;t<this.bonusList.length;t++){let e=this.bonusList[t];e.isChecked=e.status==="Active",e.created_at&&(e.created_at=this.dateService.formatToYYYYMMDD(new Date(e.created_at))),e.start_date&&(e.start_date=this.dateService.formatToYYYYMMDD(new Date(e.start_date))),e.end_date&&(e.end_date=this.dateService.formatToYYYYMMDD(new Date(e.end_date)))}}})}onDateChange(i,t){if(t){let e=this.dateService.formatToYYYYMMDD(t);this.filter[i]=e}else this.filter[i]="";(this.filter.start_date&&this.filter.end_date||this.filter.created_at)&&this.getBonusList()}changeToPagination(i){i==="Next"&&this.pagination.cur_page<this.pagination.total_pages?this.pagination.cur_page++:i==="Previous"&&this.pagination.cur_page>1&&this.pagination.cur_page--,this.getBonusList()}changeToPage(i){this.pagination.cur_page=i,this.getBonusList()}onToggleChange(i,t,e){this.comanFuncation.statusChange(i,t,e,this.submoduleId,"toggle","bonus/update-status").subscribe(n=>{n?this.getBonusList():this.getBonusList()})}onUpdate(i){this.router.navigate(["/apps/loyalty/bonus-point-add",i,"edit"])}onDeleteRow(i){this.alert.confirm("Are you sure?").then(t=>{if(t.isConfirmed){let e="";e="bonus/delete",this.api.patch({_id:i,is_delete:1},e).subscribe(n=>{n.statusCode=="200"&&(Be.default.fire("Deleted!",n.message,"success"),this.getBonusList())})}})}static \u0275fac=function(t){return new(t||o)(_(le),_(Q),_(X),_(Y),_(de),_(G),_($),_(he),_(Ce),_(O),_(be))};static \u0275cmp=x({type:o,selectors:[["app-bonus-point-list"]],decls:56,vars:43,consts:[["picker",""],["picker2",""],["picker3",""],[3,"title","title1","activeitem","btnShow1"],[1,"box","py-3","px-4"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[4,"ngIf"],[1,"row"],[1,"col-xl-12"],[3,"onRefresh","button1","pageTitle","refreshLabel","btnShow","btnShow2","addBtnLabel"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-hover ti-head-primary",3,"tableHead","tableHeadColumn","tableHeight","showCheckbox","columns"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[1,"w100"],[1,"table-search-filters"],[1,"table-input"],["matInput","","name","createdAt","placeholder","Date Created",3,"ngModelChange","matDatepicker","ngModel"],["matIconSuffix","",3,"for"],[1,"!text-center","w150"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],["matInput","","name","dateFrom","placeholder","Date From",3,"ngModelChange","matDatepicker","ngModel"],["matInput","","name","dateTo","placeholder","Date To",3,"ngModelChange","matDatepicker","ngModel"],[1,"!text-center","w50"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[3,"class",4,"ngFor","ngForOf"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",3,"bg-gray-400",4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-primary","underline",3,"click","routerLink"],[1,"badge"],[3,"checkedChange","checked"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"]],template:function(t,e){if(t&1){let n=v();b(0,"app-page-header",3),p(1,"div",4)(2,"nav",5),f(3,De,2,2,"ng-container",6)(4,xe,2,1,"ng-container",6),s(),p(5,"div",7)(6,"div",8)(7,"app-page-sub-header",9),u("onRefresh",function(){return d(n),c(e.onRefresh())})("button1",function(){return d(n),c(e.goToBonusAdd())}),s(),p(8,"div",10)(9,"div",10)(10,"spk-reusable-tables",11)(11,"tr",12)(12,"td",13),g(13,"\xA0"),s(),p(14,"td",14)(15,"div",15)(16,"mat-form-field",16)(17,"input",17),L("ngModelChange",function(a){return d(n),S(e.filter.created_at,a)||(e.filter.created_at=a),c(a)}),u("ngModelChange",function(a){return d(n),c(e.onDateChange("created_at",a))}),s(),b(18,"mat-datepicker-toggle",18)(19,"mat-datepicker",null,0),s()()(),p(21,"td",19)(22,"div",15)(23,"mat-form-field",16)(24,"input",20),L("ngModelChange",function(a){return d(n),S(e.filter.created_name,a)||(e.filter.created_name=a),c(a)}),u("keyup.enter",function(){return d(n),c(e.getBonusList())}),s(),f(25,Ee,3,0,"button",21),s()()(),p(26,"td",14)(27,"div",15)(28,"mat-form-field",16)(29,"input",22),L("ngModelChange",function(a){return d(n),S(e.filter.start_date,a)||(e.filter.start_date=a),c(a)}),u("ngModelChange",function(a){return d(n),c(e.onDateChange("start_date",a))}),s(),b(30,"mat-datepicker-toggle",18)(31,"mat-datepicker",null,1),s()()(),p(33,"td",14)(34,"div",15)(35,"mat-form-field",16)(36,"input",23),L("ngModelChange",function(a){return d(n),S(e.filter.end_date,a)||(e.filter.end_date=a),c(a)}),u("ngModelChange",function(a){return d(n),c(e.onDateChange("end_date",a))}),s(),b(37,"mat-datepicker-toggle",18)(38,"mat-datepicker",null,2),s()()(),p(40,"td",13)(41,"div",15)(42,"mat-form-field",16)(43,"input",20),L("ngModelChange",function(a){return d(n),S(e.filter.customer_type_name,a)||(e.filter.customer_type_name=a),c(a)}),u("keyup.enter",function(){return d(n),c(e.getBonusList())}),s(),f(44,Re,3,0,"button",21),s()()(),p(45,"td",13)(46,"div",15)(47,"mat-form-field",16)(48,"input",20),L("ngModelChange",function(a){return d(n),S(e.filter.title,a)||(e.filter.title=a),c(a)}),u("keyup.enter",function(){return d(n),c(e.getBonusList())}),s(),f(49,Ae,3,0,"button",21),s()()(),p(50,"td",24),g(51,"\xA0"),s()(),f(52,He,2,2,"ng-container",6)(53,Ye,2,2,"ng-container",6),s(),f(54,je,2,0,"ng-container",6),s(),p(55,"app-pagination-footer",25),u("preButtonClick",function(){return d(n),c(e.changeToPagination("Previous"))})("nextButtonClick",function(){return d(n),c(e.changeToPagination("Next"))})("pageChange",function(a){return d(n),c(e.changeToPage(a))}),s()()()()()}if(t&2){let n=P(20),l=P(32),a=P(39);m("title","IRP")("title1",T(42,Me))("activeitem","Bonus List")("btnShow1",!1),r(3),m("ngIf",e.skLoading),r(),m("ngIf",!e.skLoading),r(3),M("p-0 pt-3"),m("pageTitle","Bonus List")("refreshLabel","Refresh")("btnShow",!0)("btnShow2",e.accessRight==null?null:e.accessRight.addRight)("addBtnLabel","Add Bonus"),r(3),m("tableHead","border-b")("tableHeadColumn","!text-center")("tableHeight","630px")("showCheckbox",!1)("columns",e.spinWinListColumns),r(7),m("matDatepicker",n),y("ngModel",e.filter.created_at),r(),m("for",n),r(6),y("ngModel",e.filter.created_name),r(),k(e.filter.created_name?25:-1),r(4),m("matDatepicker",l),y("ngModel",e.filter.start_date),r(),m("for",l),r(6),m("matDatepicker",a),y("ngModel",e.filter.end_date),r(),m("for",a),r(6),y("ngModel",e.filter.customer_type_name),r(),k(e.filter.customer_type_name?44:-1),r(4),y("ngModel",e.filter.title),r(),k(e.filter.title?49:-1),r(3),m("ngIf",!e.skLoading),r(),m("ngIf",e.skLoading),r(),m("ngIf",!e.bonusList.length&&!e.skLoading),r(),m("currentPage",e.pagination.cur_page)("totalPage",e.pagination.total_pages)("pageLimit",e.pagination.limit)("listLength",e.bonusList.length)("preBtn",!e.pagination.prev)("nextBtn",!e.pagination.next)}},dependencies:[N,A,W,H,_e,U,q,z,ve,Z,ue,me,ye,Se,ge,ce,J,pe,ie,ae,re,se,ne,oe,te,ee,K,j],encapsulation:2})};export{Le as BonusPointListComponent};
