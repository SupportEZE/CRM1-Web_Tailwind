import{a as oe}from"./chunk-J4NDCUAB.js";import{a as ae}from"./chunk-ZON5AR26.js";import"./chunk-LGZVJJDX.js";import"./chunk-54KZ5YIV.js";import{a as ne}from"./chunk-SQZ3YN6N.js";import{c as te}from"./chunk-CIBZCVJQ.js";import"./chunk-OTFCGVEU.js";import{a as ee}from"./chunk-HPLI5COI.js";import"./chunk-DUVWFXSE.js";import{a as W}from"./chunk-CNF4GSI7.js";import{a as K}from"./chunk-OEHD5D2Y.js";import{a as ie}from"./chunk-GLWQGYBC.js";import{a as G}from"./chunk-DC4QM32I.js";import{F as Z,c as q,s as U,u as X}from"./chunk-VHE3PQ3O.js";import{$ as Q,Qa as z,Z as B,_ as ce,jb as J,w as $}from"./chunk-GYDYF5F3.js";import{M as P,f as O,g as Y,o as j,t as N}from"./chunk-PD5VTTIY.js";import{Aa as p,Ba as m,Fc as D,Gc as M,Hb as I,Hc as k,Mc as T,Nc as R,Ob as _,Oc as y,Yc as C,Zc as E,_b as r,ad as V,bc as S,ed as A,gd as H,kc as l,lc as s,mc as w,nc as f,oc as b,qc as h,rb as o,sb as g,wc as v,yc as d}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{a as L,b as F,g as le}from"./chunk-66YHNWRR.js";var se=le(ce());var de=["reusableTable"],pe=()=>["Leave"],x=()=>[],me=(n,i,t,e)=>({name:n,label:i,icon:t,count:e}),_e=n=>[n];function ue(n,i){n&1&&w(0,"app-skeleton"),n&2&&S("w100 h30 bg-skeleton")}function ge(n,i){n&1&&(f(0),l(1,"div",9),_(2,ue,1,2,"app-skeleton",10),s(),b()),n&2&&(o(2),r("ngForOf",C(1,x).constructor(3)))}function fe(n,i){if(n&1){let t=h();l(0,"app-listing-tab",13),v("tabChange",function(a){p(t);let c=d(2);return m(c.onTabChange(a.tab))}),s()}if(n&2){let t=i.$implicit,e=d(2);r("tabs",E(7,_e,V(2,me,t.name,t.label,t.icon,t.count)))("activeTab",e.activeTab)}}function be(n,i){if(n&1&&(f(0),l(1,"nav",11),_(2,fe,1,9,"app-listing-tab",12),s(),b()),n&2){let t=d();o(2),r("ngForOf",t.mainTabs)}}function ve(n,i){if(n&1&&(l(0,"span"),T(1),A(2,"date"),s()),n&2){let t=d().$implicit,e=d().$implicit;o(),y(" ",H(2,1,(e==null?null:e[t.name])||(e==null||e.form_data==null?null:e.form_data[t.name]),"d MMM yyyy, hh:mm a")," ")}}function he(n,i){if(n&1&&(l(0,"span"),T(1),s()),n&2){let t,e=d().$implicit,a=d().$implicit;o(),y(" ",(t=(t=a[(e==null?null:e.actual_name)||(e==null?null:e.name)])!==null&&t!==void 0?t:a.form_data==null?null:a.form_data[e==null?null:e.name])!==null&&t!==void 0?t:"--"," ")}}function Ce(n,i){if(n&1&&(f(0),l(1,"td"),_(2,ve,3,4,"span",22)(3,he,2,1,"span",5),s(),b()),n&2){let t=i.$implicit;o(2),r("ngIf",t.name.includes("date")||t.name.endsWith("_at")),o(),r("ngIf",!(t.name.includes("date")||t.name.endsWith("_at")))}}function Le(n,i){if(n&1){let t=h();l(0,"app-icon-button",20),v("clickEvent",function(){p(t);let a=d().$implicit,c=d(2);return m(c.onDeleteLeave(a._id))}),s()}n&2&&r("icon","ri-delete-bin-line")("buttonClass","ti-btn btn-wave leave-btn ti-btn-sm ti-btn-soft-danger waves-effect waves-light")}function Se(n,i){if(n&1){let t=h();l(0,"tr",15)(1,"td",16),T(2),s(),_(3,Ce,4,2,"ng-container",17),l(4,"td",18)(5,"div",19)(6,"app-icon-button",20),v("clickEvent",function(){let a=p(t).$implicit,c=d(2);return m(c.goToDetailPage(a._id))}),s(),_(7,Le,1,2,"app-icon-button",21),s()()()}if(n&2){let t=i.index,e=d(2);o(2),R(t+1),o(),r("ngForOf",e.visibleHeaders),o(3),r("icon","ri-eye-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light"),o(),r("ngIf",e.accessRight==null?null:e.accessRight.deleteRight)}}function we(n,i){if(n&1&&(f(0),_(1,Se,8,5,"tr",14),b()),n&2){let t=d();o(),r("ngForOf",t.leaveListing)}}function Te(n,i){n&1&&(l(0,"td"),w(1,"app-skeleton"),s()),n&2&&(o(),S("h20 bg-skeleton"))}function ye(n,i){n&1&&(l(0,"tr",24),_(1,Te,2,2,"td",17),s()),n&2&&(o(),r("ngForOf",C(1,x).constructor(11)))}function xe(n,i){n&1&&(f(0),_(1,ye,2,2,"tr",23),b()),n&2&&(o(),r("ngForOf",C(1,x).constructor(8)))}function Fe(n,i){n&1&&(f(0),w(1,"app-data-not-found"),b())}var re=class n{constructor(i,t,e,a,c,u,Ie,De,Me){this.toastr=i;this.api=t;this.alert=e;this.dateService=a;this.router=c;this.moduleService=u;this.comanFuncation=Ie;this.CommonApiService=De;this.dialog=Me}reusableTable;activeTab="Pending";filter={};listColumns=[];skLoading=!1;view;mainTabs=[];leaveTabs={};disabled=!1;leaveModule=[];leaveList=[];page=1;moduleId=0;moduleFormId=0;moduleTableId=0;FORMID=ee;sorting={};subModule={};tableId;leaveData=[];leaveListing=[];leavePageDropdownOption=[];accessRight={};ngOnInit(){let i=this.moduleService.getAccessMap("SFA","Leave");i&&(this.accessRight=i);let t=this.moduleService.getSubModuleByName("SFA","Leave"),e=this.moduleService.getFormById("SFA","Leave",this.FORMID.ID.LeaveFormData),a=this.moduleService.getTableById("SFA","Leave",this.FORMID.ID.LeaveTableData);t&&(this.subModule=t),e&&(this.moduleFormId=e.form_id),a&&(this.tableId=a.table_id),this.getHeaderConfigListing()}onTabChange(i){this.activeTab=i,this.getList()}onRefresh(){this.filter={},this.reusableTable.clearSearchInputs(),this.getHeaderConfigListing()}updateLeaveWiseLeave(i){this.router.navigate(["/apps/sfa/leave-list/leave-add"])}tableConfigData={};visibleHeaders=[];getHeaderConfigListing(){this.CommonApiService.getHeaderConfigListing(this.moduleTableId,this.moduleFormId).subscribe(i=>{this.tableConfigData=i.data.table_data;let t=this.tableConfigData.tableHead;this.visibleHeaders=t.filter(e=>e.list_view_checked),this.getList()})}goToDetailPage(i){this.router.navigate(["/apps/sfa/leave-list/leave-detail",i])}getList(){this.skLoading=!0;let i=F(L({},this.filter),{activeTab:this.activeTab});this.api.post({filters:i,sorting:this.sorting,page:this.page},"leave/leave-read").subscribe(t=>{if(t.statusCode===200){this.skLoading=!1,this.leaveListing=t.data.result,this.leaveTabs=t.data.leave_status_tabs,this.mainTabs=[{name:"Pending",label:"Pending",icon:"ri-time-fill",count:this.leaveTabs.find(e=>e.pendingCount!==void 0)?.pendingCount||0},{name:"Approved",label:"Approved",icon:"ri-checkbox-circle-fill",count:this.leaveTabs.find(e=>e.approvedCount!==void 0)?.approvedCount||0},{name:"Rejected",label:"Rejected",icon:"ri-close-circle-fill",count:this.leaveTabs.find(e=>e.rejectCount!==void 0)?.rejectCount||0}];for(let e=0;e<this.leaveListing.length;e++){let a=this.leaveListing[e];a.updated_at&&(a.updated_at=this.dateService.formatToYYYYMMDD(new Date(a.updated_at))),a.created_at&&(a.created_at=this.dateService.formatToYYYYMMDD(new Date(a.created_at))),a.leave_end&&(a.leave_end=this.dateService.formatToYYYYMMDD(new Date(a.leave_end))),a.leave_start&&(a.leave_start=this.dateService.formatToYYYYMMDD(new Date(a.leave_start)))}}})}onSortChanged(i){this.sorting={},this.sorting[i.field]=i.order,this.getList()}handleSelectionChange(i){let{category_name:t,selections:e}=i;this.filter[t]=e,this.getList()}updateSearchFilter(i){this.filter[i.name]=i.searchText,this.getList()}handleDateRangeChange(i){this.filter=i,this.getList()}handleDateChange(i){this.filter=L(L({},this.filter),i),this.getList()}onDeleteLeave(i){this.alert.confirm("Are you sure?").then(t=>{t.isConfirmed&&this.api.patch({_id:i,is_delete:1},"leave/delete").subscribe(e=>{e.statusCode===200&&(se.default.fire("Deleted!",e.message,"success"),this.getList())})})}openHeaderSettingModal(){this.getHeaderConfigListing(),this.dialog.open(ae,{width:"450px",panelClass:"mat-right-modal",position:{right:"0px"},data:{lastPage:"header-config",moduleFormId:this.moduleFormId,moduleTableId:this.moduleTableId,moduleName:this.subModule.title,tableConfigData:this.tableConfigData}}).afterClosed().subscribe(t=>{t===!0&&this.getHeaderConfigListing()})}openMainLogModal(i){this.comanFuncation.listLogsModal(this.subModule.module_id,i,this.subModule.module_type).subscribe(t=>{})}static \u0275fac=function(t){return new(t||n)(g($),g(B),g(Q),g(J),g(P),g(G),g(te),g(W),g(z))};static \u0275cmp=I({type:n,selectors:[["app-leave-list"]],viewQuery:function(t,e){if(t&1&&D(de,5),t&2){let a;M(a=k())&&(e.reusableTable=a.first)}},decls:13,vars:27,consts:[["reusableTable",""],[3,"buttonClick1","title","title1","activeitem","btnShow1","buttonText1","icon1","dataHsOverlay"],[1,"box","py-3","px-4"],[1,"col-xl-12"],[1,"row"],[4,"ngIf"],[3,"onRefresh","button1","pageTitle","btnShow","refreshLabel","addBtnLabel","btnShow2"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"sortChanged","selectionChange","textSearchChange","dateChange","dateRangeChange","tableHead","showCheckbox","showS_No","showSorting","showFilterRow","showAction","columns"],[1,"flex","items-center","gap-3"],[3,"class",4,"ngFor","ngForOf"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],["class","leave-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"leave-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"!text-center"],[4,"ngFor","ngForOf"],[1,"!text-center","relative","w100"],[1,"flex","flex-row","items-center","!gap-2","text-[0.9375rem]"],[3,"clickEvent","icon","buttonClass"],[3,"icon","buttonClass","clickEvent",4,"ngIf"],[4,"ngIfElseNonDate","ngIf"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"]],template:function(t,e){if(t&1){let a=h();l(0,"app-page-header",1),v("buttonClick1",function(){return p(a),m(e.openHeaderSettingModal())}),s(),l(1,"div",2)(2,"div",3)(3,"div",4),_(4,ge,3,2,"ng-container",5)(5,be,3,1,"ng-container",5),l(6,"app-page-sub-header",6),v("onRefresh",function(){return p(a),m(e.onRefresh())})("button1",function(){return p(a),m(e.updateLeaveWiseLeave(""))}),s(),l(7,"div",7)(8,"spk-reusable-tables",8,0),v("sortChanged",function(u){return p(a),m(e.onSortChanged(u))})("selectionChange",function(u){return p(a),m(e.handleSelectionChange(u))})("textSearchChange",function(u){return p(a),m(e.updateSearchFilter(u))})("dateChange",function(u){return p(a),m(e.handleDateChange(u))})("dateRangeChange",function(u){return p(a),m(e.handleDateRangeChange(u))}),_(10,we,2,1,"ng-container",5)(11,xe,2,2,"ng-container",5),s(),_(12,Fe,2,0,"ng-container",5),s()()()()}t&2&&(r("title","SFA")("title1",C(26,pe))("activeitem","Leave List")("btnShow1",!0)("buttonText1","Header Config")("icon1","settings")("dataHsOverlay","#leave-header-config"),o(4),r("ngIf",e.skLoading),o(),r("ngIf",!e.skLoading),o(),S("p-0 pt-2"),r("pageTitle","Leave List")("btnShow",!0)("refreshLabel","Refresh")("addBtnLabel","Add Leave")("btnShow2",e.accessRight==null?null:e.accessRight.addRight),o(2),r("tableHead","border-b")("showCheckbox",!1)("showS_No",!0)("showSorting",!1)("showFilterRow",!0)("showAction",!0)("columns",e.visibleHeaders),o(2),r("ngIf",!e.skLoading),o(),r("ngIf",e.skLoading),o(),r("ngIf",!e.leaveListing.length&&!e.skLoading))},dependencies:[Z,O,Y,ie,q,U,oe,ne,X,j,K,N],encapsulation:2})};export{re as LeaveListComponent};
