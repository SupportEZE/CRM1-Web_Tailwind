import{a as ie}from"./chunk-56RTIVDZ.js";import"./chunk-PU6S26UW.js";import{a as Z}from"./chunk-JUPJFX3F.js";import{d as ee,e as te}from"./chunk-4JVCC6N3.js";import{a as W}from"./chunk-PJTW4QXW.js";import"./chunk-SQZ3YN6N.js";import"./chunk-CIBZCVJQ.js";import{a as Q}from"./chunk-OTFCGVEU.js";import{a as J}from"./chunk-HPLI5COI.js";import"./chunk-CNF4GSI7.js";import"./chunk-OEHD5D2Y.js";import{a as X}from"./chunk-GLWQGYBC.js";import{a as Y}from"./chunk-DC4QM32I.js";import{B as q,F as z,c as K,s as U,t as $}from"./chunk-VHE3PQ3O.js";import{$ as N,Qa as G,Z as V,_ as oe,jb as H,u as P}from"./chunk-GYDYF5F3.js";import{K as B,M as O,Q as j,f as F,g as w,n as k,o as A,q as R,t as T}from"./chunk-PD5VTTIY.js";import{Aa as _,Ba as h,Hb as E,Mc as r,Nc as s,Ob as m,Oc as I,Yc as M,_b as d,bc as D,ed as v,fd as L,gd as x,kc as t,lc as i,mc as f,nc as S,oc as y,qc as b,rb as n,sb as p,wc as C,yc as c}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import{g as le}from"./chunk-66YHNWRR.js";var ne=le(oe());var re=()=>["Leave"],de=()=>[];function se(l,a){if(l&1){let e=b();t(0,"a",20),C("click",function(){_(e);let u=c(2);return h(u.updateStatus())}),t(1,"i",21),r(2,"edit"),i()()}}function pe(l,a){if(l&1&&(t(0,"div",11)(1,"div")(2,"span",12),r(3),v(4,"titlecase"),i(),t(5,"span",13),r(6,"Updated By"),i()()()),l&2){let e=c(2);n(3),I("",e.Detail!=null&&e.Detail.updated_name?L(4,1,e.Detail==null?null:e.Detail.updated_name):"---"," ")}}function me(l,a){if(l&1&&(t(0,"div",11)(1,"div")(2,"span",12),r(3),i(),t(4,"span",13),r(5),i()()()),l&2){let e=a.$implicit;n(3),s(e.value),n(2),s(e.key)}}function ce(l,a){if(l&1&&(t(0,"div")(1,"div",10)(2,"div",11)(3,"div")(4,"span",12),r(5),v(6,"date"),i(),t(7,"span",13),r(8,"Created At"),i()()(),t(9,"div",11)(10,"div")(11,"span",12),r(12),i(),t(13,"span",13),r(14,"Created By"),i()()(),t(15,"div",11)(16,"div")(17,"span",12),r(18),i(),t(19,"span",13),r(20,"Leave Type"),i()()(),t(21,"div",11)(22,"div")(23,"span",12),r(24),v(25,"date"),i(),t(26,"span",13),r(27,"Leave Start"),i()()(),t(28,"div",11)(29,"div")(30,"span",12),r(31),v(32,"date"),i(),t(33,"span",13),r(34,"Leave End"),i()()(),t(35,"div",11)(36,"div")(37,"span",14),r(38),m(39,se,3,0,"a",15),i(),t(40,"span",13),r(41,"Status"),i()()(),t(42,"div",11)(43,"div")(44,"span",12),r(45),i(),t(46,"span",13),r(47,"Reason"),i()()(),t(48,"div",11)(49,"div")(50,"span",12),r(51),i(),t(52,"span",13),r(53,"Subject"),i()()(),t(54,"div",11)(55,"div")(56,"span",12),r(57),i(),t(58,"span",13),r(59,"Description"),i()()(),m(60,pe,7,3,"div",16),t(61,"div",11)(62,"div")(63,"span",12),r(64),v(65,"date"),i(),t(66,"span",13),r(67,"Updated At"),i()()()(),f(68,"div",17),t(69,"div",18),m(70,me,6,2,"div",19),v(71,"keyvalue"),i()()),l&2){let e=c();n(5),s(e.Detail!=null&&e.Detail.created_at?x(6,13,e.Detail==null?null:e.Detail.created_at,"d MMM yyyy, hh:mm a"):"---"),n(7),s((e.Detail==null?null:e.Detail.created_name)||"---"),n(6),s((e.Detail==null?null:e.Detail.leave_type)||"---"),n(6),s(e.Detail!=null&&e.Detail.leave_start?x(25,16,e.Detail==null?null:e.Detail.leave_start,"d MMM yyyy"):"---"),n(7),s(e.Detail!=null&&e.Detail.leave_end?x(32,19,e.Detail==null?null:e.Detail.leave_end,"d MMM yyyy"):"---"),n(7),I("",(e.Detail==null?null:e.Detail.status)||"--"," "),n(),d("ngIf",e.accessRight==null?null:e.accessRight.approveRight),n(6),s((e.Detail==null?null:e.Detail.reason)||"---"),n(6),s((e.Detail==null?null:e.Detail.subject)||"---"),n(6),s((e.Detail==null?null:e.Detail.description)||"---"),n(3),d("ngIf",e.Detail==null?null:e.Detail.updated_name),n(4),s(e.Detail!=null&&e.Detail.updated_at?x(65,22,e.Detail==null?null:e.Detail.updated_at,"d MMM yyyy, hh:mm a"):"---"),n(6),d("ngForOf",L(71,25,e.formattedKeysFormData))}}function ve(l,a){l&1&&(t(0,"div",24),f(1,"app-skeleton"),i()),l&2&&(n(),D("w180"))}function ue(l,a){l&1&&(t(0,"div")(1,"div",22),m(2,ve,2,2,"div",23),i()()),l&2&&(n(2),d("ngForOf",M(1,de).constructor(10)))}function fe(l,a){if(l&1){let e=b();t(0,"div",27)(1,"spk-product-card",28),C("delete",function(u){_(e);let g=c(2);return h(g.onDeleteImage(u))}),i()()}if(l&2){let e=a.$implicit,o=c(2);n(),d("apiPath","leave/get-doc")("imageData",e)("editBtn",!1)("heading",!1)("subHeading",!1)("delBtn",(o.accessRight==null?null:o.accessRight.deleteRight)&&(o.Detail==null?null:o.Detail.status)==="Draft")}}function ge(l,a){if(l&1&&(t(0,"div",25),S(1),m(2,fe,2,6,"div",26),y(),i()),l&2){let e=c();n(2),d("ngForOf",e.Detail==null?null:e.Detail.files)}}function xe(l,a){l&1&&(S(0),f(1,"app-data-not-found"),y())}var ae=class l{constructor(a,e,o,u,g,De,_e,he,Se,ye){this.lightbox=a;this.router=e;this.alert=o;this.route=u;this.api=g;this.toastr=De;this.moduleService=_e;this.logService=he;this.dialog=Se;this.dateService=ye}FORMID=J;logList=[];Detail;formattedKeysFormData={};formattedKeysRecentActivities={};leaveDetailFormData;skLoading=!1;subModule={};accessRight={};leaveId;ngOnInit(){let a=this.moduleService.getAccessMap("SFA","Leave");a&&(this.accessRight=a);let e=this.moduleService.getSubModuleByName("SFA","Leave");e&&(this.subModule=e),this.route.paramMap.subscribe(o=>{this.leaveId=o.get("id"),this.leaveId&&this.getLeaveDetail()})}getLeaveDetail(){this.skLoading=!0,this.api.post({leave_id:this.leaveId},"leave/leave-detail").subscribe(a=>{a.statusCode===200&&(this.skLoading=!1,this.Detail=a.data,this.leaveDetailFormData=a.data.form_data,this.Detail=this.dateService.formatToDDMMYYYY(this.Detail),this.logService.getLogs(this.subModule.module_id,e=>{this.logList=e},this.leaveId?this.leaveId:"",this.subModule.module_type),this.formattedKeysFormData=this.formatAndPrintFormData(this.leaveDetailFormData),delete this.formattedKeysFormData.Files)})}formatAndPrintFormData(a){let e={};for(let o in a)if(a.hasOwnProperty(o)){let u=o.split("_").map(g=>g.charAt(0).toUpperCase()+g.slice(1)).join(" ");e[u]=a[o]}return e}onDeleteImage(a){this.api.disabled=!0,this.alert.confirm("Are you sure you want to delete this?","Once deleted, this item cannot be restored.","Delete it!").then(e=>{e.isConfirmed&&this.api.patch({_id:this.leaveId,file_id:a.file_id,file_path:a.filepath},"leave/delete-file").subscribe(o=>{o.statusCode===200&&(this.api.disabled=!1,ne.default.fire("Deleted!",o.message,"success"),this.logService.logActivityOnDelete(this.subModule.module_id,this.subModule.module_name,"delete",a.file_id),this.getLeaveDetail())})})}updateStatus(){this.dialog.open(ie,{width:"450px",data:{lastPage:"leave-detail",leaveId:this.leaveId,status:this.Detail.status,subModule:this.subModule}}).afterClosed().subscribe(e=>{e===!0&&this.getLeaveDetail()})}static \u0275fac=function(e){return new(e||l)(p(ee),p(O),p(N),p(B),p(V),p(P),p(Y),p(Q),p(G),p(H))};static \u0275cmp=E({type:l,selectors:[["app-leave-detail"]],decls:13,vars:23,consts:[[3,"title","title1","activeitem","buttonText","icon"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xxl:col-span-8","xl:col-span-8","lg:col-span-8","md:col-span-7","col-span-12"],[3,"title","titleView"],[4,"ngIf"],[1,"xxl:col-span-4","xl:col-span-4","lg:col-span-4","md:col-span-5","col-span-12"],[3,"logList","closeBtn"],[1,"xl:col-span-5","col-span-12"],[3,"title","titleView","iconClass","classbody","iconName"],["class","grid grid-cols-12 gap-x-4",4,"ngIf"],[1,"flex","gap-6","mb-1","flex-wrap","text-[11px]"],[1,"flex","items-center","gap-2"],[1,"block","font-medium"],[1,"text-xs","text-textmuted","dark:text-textmuted/50"],[1,"flex","items-center","block","font-medium","badge","bg-info/10","text-info"],["class","text-info font-medium",3,"click",4,"ngIf"],["class","flex items-center gap-2",4,"ngIf"],[1,"dropdown-divider","mb-1"],[1,"flex","gap-5","mb-1","flex-wrap"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],[1,"text-info","font-medium",3,"click"],[1,"material-icons","ms-1"],[1,"flex","gap-2","mb-1","flex-wrap"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"flex","items-center"],[1,"grid","grid-cols-12","gap-x-4"],["class","xxl:col-span-2 lg:col-span-3 xl:col-span-4 sm:col-span-6 col-span-12",4,"ngFor","ngForOf"],[1,"xxl:col-span-2","lg:col-span-3","xl:col-span-4","sm:col-span-6","col-span-12"],[3,"delete","apiPath","imageData","editBtn","heading","subHeading","delBtn"]],template:function(e,o){e&1&&(f(0,"app-page-header",0),t(1,"div",1)(2,"div",2)(3,"app-showcode-card",3),m(4,ce,72,27,"div",4)(5,ue,3,2,"div",4),i()(),t(6,"div",5),f(7,"app-logs",6),i()(),t(8,"div",1)(9,"div",7)(10,"app-showcode-card",8),m(11,ge,3,1,"div",9)(12,xe,2,0,"ng-container",4),i()()()),e&2&&(d("title","SFA Modules")("title1",M(22,re))("activeitem","Leave Details")("buttonText","Filter")("icon","filter_list"),n(3),D("box-title font-medium text-[15px] block text-primarytint1color"),d("title","Basic Detail")("titleView",!0),n(),d("ngIf",!o.skLoading),n(),d("ngIf",o.skLoading),n(2),d("logList",o.logList)("closeBtn",!1),n(3),D("box-title font-medium text-[15px] block text-primarytint1color"),d("title","Attachments")("titleView",!0)("iconClass","ti-btn btn-wave ti-btn-sm ti-btn-soft-primary waves-effect waves-light")("classbody","pt-0")("iconName","ri-add-line"),n(),d("ngIf",(o.Detail==null||o.Detail.files==null?null:o.Detail.files.length)>0),n(),d("ngIf",(o.Detail==null||o.Detail.files==null?null:o.Detail.files.length)===0))},dependencies:[z,F,w,X,K,U,$,k,A,R,j,q,te,Z,T,W],encapsulation:2})};export{ae as LeaveDetailComponent};
