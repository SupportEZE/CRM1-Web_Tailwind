import{a as re}from"./chunk-J4NDCUAB.js";import{a as se}from"./chunk-REKAXM5L.js";import{a as ae}from"./chunk-54KZ5YIV.js";import{a as ne}from"./chunk-SQZ3YN6N.js";import{c as te}from"./chunk-CIBZCVJQ.js";import{a as ee}from"./chunk-OTFCGVEU.js";import{a as Z}from"./chunk-HPLI5COI.js";import{b as oe}from"./chunk-DUVWFXSE.js";import{a as q}from"./chunk-CNF4GSI7.js";import{a as U}from"./chunk-OEHD5D2Y.js";import{a as ie}from"./chunk-GLWQGYBC.js";import{a as J}from"./chunk-DC4QM32I.js";import{F as Y,c as z,q as W,s as X}from"./chunk-VHE3PQ3O.js";import{$ as G,F as L,Qa as K,V as N,W as $,Z as H,jb as Q,l as j,v as O,w as V}from"./chunk-GYDYF5F3.js";import{K as B,M as D,Q as A,f as M,g as I,o as E,t as R}from"./chunk-PD5VTTIY.js";import{Aa as f,Ba as b,Hb as T,Mc as h,Nc as C,Ob as g,Oc as x,Yc as S,_b as r,bc as P,ed as k,gd as F,kc as s,lc as c,mc as v,nc as d,oc as _,qc as y,rb as o,sb as l,wc as u,yc as m}from"./chunk-2NSPOFEK.js";import"./chunk-EU2KAMEK.js";import"./chunk-66YHNWRR.js";var le=()=>[];function pe(n,e){if(n&1&&(d(0),s(1,"strong"),h(2),c(),_()),n&2){let t=m().$implicit,i=m().$implicit;o(2),x(" ",i.label===t.customer_type_name?t.point_value+"PT":"0"," ")}}function me(n,e){if(n&1&&(d(0),g(1,pe,3,1,"ng-container",7),_()),n&2){let t=e.$implicit,i=m().$implicit;o(),r("ngIf",i.label===t.customer_type_name)}}function ge(n,e){if(n&1&&(d(0),s(1,"td",21),g(2,me,2,1,"ng-container",15),c(),_()),n&2){let t=m().$implicit;o(2),r("ngForOf",t.point)}}function de(n,e){if(n&1){let t=y();s(0,"tr",11)(1,"td",12),h(2),c(),s(3,"td",13),h(4),k(5,"date"),c(),s(6,"td",14),h(7),c(),s(8,"td"),h(9),c(),g(10,ge,3,1,"ng-container",15),s(11,"td",16)(12,"span",17)(13,"app-toggle",18),u("checkedChange",function(a){let p=f(t).$implicit,w=m(2);return b(w.onToggleChange(a,p._id,p.status))}),c()()(),s(14,"td",19)(15,"app-icon-button",20),u("clickEvent",function(){let a=f(t).$implicit,p=m(2);return b(p.openMainLogModal(a._id))}),c(),s(16,"app-icon-button",20),u("clickEvent",function(){let a=f(t).$implicit,p=m(2);return b(p.goToEditPage(a._id))}),c()()()}if(n&2){let t=e.$implicit,i=e.index,a=m(2);o(2),C(i+1),o(2),C(t.created_at?F(5,10,t.created_at,"dd MMM yyyy hh:mm a"):""),o(3),C(t.created_name?t.created_name:""),o(2),C(t.point_category_name?t.point_category_name:""),o(),r("ngForOf",a.userSubTypes),o(3),r("checked",t.isChecked),o(2),r("icon","ri-file-list-line")("buttonClass","ti-btn btn-wave  ti-btn-sm ti-btn-soft-primary waves-effect waves-light"),o(),r("icon","ri-edit-line")("buttonClass","ti-btn btn-wave product-btn ti-btn-sm ti-btn-soft-success waves-effect waves-light")}}function _e(n,e){if(n&1){let t=y();d(0),s(1,"spk-reusable-tables",9),u("sortChanged",function(a){f(t);let p=m();return b(p.onSortChanged(a))})("selectionChange",function(a){f(t);let p=m();return b(p.handleSelectionChange(a))}),g(2,de,17,13,"tr",10),c(),_()}if(n&2){let t=m();o(),r("tableHead","border-b")("showCheckbox",!1)("showS_No",!0)("showSorting",!1)("showFilterRow",!0)("showAction",!0)("columns",t.tableHeader),o(),r("ngForOf",t.listData)}}function ue(n,e){n&1&&(s(0,"td",25),v(1,"app-skeleton"),c()),n&2&&(o(),P("h20 bg-skeleton"))}function fe(n,e){n&1&&(s(0,"tr",23),g(1,ue,2,2,"td",24),c()),n&2&&(o(),r("ngForOf",S(1,le).constructor(11)))}function be(n,e){n&1&&(d(0),g(1,fe,2,2,"tr",22),_()),n&2&&(o(),r("ngForOf",S(1,le).constructor(8)))}function he(n,e){n&1&&(d(0),v(1,"app-data-not-found"),_())}var ce=class n{constructor(e,t,i,a,p,w,Ce,ve,ye,Se,Le,we,Te){this.toastr=e;this.api=t;this.remove=i;this.logService=a;this.alert=p;this.router=w;this.dialog=Ce;this.fb=ve;this.moduleService=ye;this.comanFuncation=Se;this.dateService=Le;this.route=we;this.CommonApiService=Te;this.range=this.fb.group({start:new L(null),end:new L(null)})}range;customerType;customerLoginType;skLoading=!1;filter={};sorting={};listData=[];pagination={};submodule;FORMID=Z;tableData=[];tableHeader=[];fieldTypes=j;activeTab="Active";userSubTypes=[];accessRight={};ngOnInit(){let e=this.moduleService.getAccessMap("Masters","Point Category");e&&(this.accessRight=e),this.getSubType();let t=this.moduleService.getSubModuleByName("Masters","Point Category");t&&(this.submodule=t),this.route.paramMap.subscribe(i=>{i&&(this.customerType=i.get("type_name"),this.customerLoginType=i.get("login_type"),this.customerLoginType=="Influencer"?this.activeTab="Pending":this.activeTab="Active",this.getList())})}getSubType(){this.api.post({is_loyalty:!0},"customer-type/read-dropdown").subscribe(e=>{e.statusCode==200&&e.data&&(this.userSubTypes=e.data,e.data&&e.data.forEach(t=>t.table_class="text-right"),this.tableHeader=[{label:"Created At",value:""},{label:"Created By",value:""},{label:"Point Category",value:""},...e.data,{label:"Status",value:""}])})}getList(){this.skLoading=!0,this.api.post({filters:this.filter,page:this.pagination.cur_page??1},"point-category/read").subscribe(e=>{e.statusCode===200&&(this.skLoading=!1,this.listData=e.data,this.listData.forEach(t=>{t.status==="Active"?t.isChecked=!0:t.isChecked=!1}),this.pagination=e.pagination)})}onToggleChange(e,t,i){this.comanFuncation.statusChange(e,t,i,this.submodule,"toggle","point-category/update-status").subscribe(a=>{a?this.getList():this.getList()})}changeToPagination(e){e=="Previous"?this.pagination.prev&&this.pagination.cur_page>1&&(this.pagination.cur_page--,this.getList()):this.pagination.next&&(this.pagination.cur_page++,this.getList())}changeToPage(e){this.pagination.cur_page=e,this.getList()}onTabChange(e){this.activeTab=e,this.getList()}onSortChanged(e){this.sorting={},this.sorting[e.field]=e.order,this.getList()}handleSelectionChange(e){let{category_name:t,selections:i}=e;this.filter[t]=i,this.getList()}onRefresh(){this.filter={},this.getList()}openMainLogModal(e){this.comanFuncation.listLogsModal(this.submodule.sub_module_id,e,this.submodule.module_type).subscribe(t=>{})}goToPage(){this.router.navigate(["/apps/master/points-category-list/points-category-add"])}goToEditPage(e){this.router.navigate(["/apps/master/points-category-list/points-category-edit/edit/"+e])}static \u0275fac=function(t){return new(t||n)(l(V),l(H),l(ae),l(ee),l(G),l(D),l(K),l(N),l(J),l(te),l(Q),l(B),l(q))};static \u0275cmp=T({type:n,selectors:[["app-point-category-list"]],decls:11,vars:21,consts:[[3,"title","title1","activeitem"],[1,"row"],[1,"col-xl-12"],[1,"box"],[3,"logBtn","onRefresh","button1","pageTitle","listLength","refreshLabel","btnShow","btnShow1","btnShow2","addBtnLabel","logsLabel"],[1,"box-body"],[1,"table-responsive","overflow-auto","table-bordered-default"],[4,"ngIf"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"sortChanged","selectionChange","tableHead","showCheckbox","showS_No","showSorting","showFilterRow","showAction","columns"],["class","user-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"user-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"w50","!text-center"],[1,"w100"],[1,"w130"],[4,"ngFor","ngForOf"],[1,"w80"],[1,"badge"],[3,"checkedChange","checked"],[1,"!text-center","relative"],[3,"clickEvent","icon","buttonClass"],[1,"w80","text-right"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],["class","w120",4,"ngFor","ngForOf"],[1,"w120"]],template:function(t,i){t&1&&(v(0,"app-page-header",0),s(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-page-sub-header",4),u("logBtn",function(){return i.openMainLogModal("")})("onRefresh",function(){return i.onRefresh()})("button1",function(){return i.goToPage()}),c(),s(5,"div",5)(6,"div",6),g(7,_e,3,8,"ng-container",7)(8,be,2,2,"ng-container",7)(9,he,2,0,"ng-container",7),c()(),s(10,"app-pagination-footer",8),u("preButtonClick",function(){return i.changeToPagination("Previous")})("nextButtonClick",function(){return i.changeToPagination("Next")})("pageChange",function(p){return i.changeToPage(p)}),c()()()()),t&2&&(r("title","Master")("title1","Point Category")("activeitem","Point Category List"),o(4),r("pageTitle","Point Category List")("listLength",i.pagination.total)("listLength",2)("refreshLabel","Refresh")("btnShow",!0)("btnShow1",!0)("btnShow2",i.accessRight==null?null:i.accessRight.addRight)("addBtnLabel","Add Point Category")("logsLabel","Logs"),o(3),r("ngIf",!i.skLoading),o(),r("ngIf",i.skLoading),o(),r("ngIf",!i.listData.length&&!i.skLoading),o(),r("currentPage",i.pagination.cur_page)("totalPage",i.pagination.total_pages)("pageLimit",i.pagination.limit)("listLength",i.listData.length)("preBtn",!i.pagination.prev)("nextBtn",!i.pagination.next))},dependencies:[Y,M,I,ie,z,X,W,re,ne,se,E,R,A,U,$,oe,O],encapsulation:2})};export{ce as PointCategoryListComponent};
