import{a as Ze,b as Qe,c as et}from"./chunk-HMNG3Q5Y.js";import{a as Ke}from"./chunk-J4NDCUAB.js";import{a as Je}from"./chunk-ZON5AR26.js";import{c as Ge}from"./chunk-CIBZCVJQ.js";import{a as ze}from"./chunk-HPLI5COI.js";import{b as Ye}from"./chunk-DUVWFXSE.js";import{a as ke}from"./chunk-CNF4GSI7.js";import{a as qe}from"./chunk-OEHD5D2Y.js";import{a as Xe}from"./chunk-GLWQGYBC.js";import{a as De}from"./chunk-DC4QM32I.js";import{C as $e,D as st,F as Y,c as Me,q as Ue,s as We,u as je}from"./chunk-VHE3PQ3O.js";import{$ as Le,Aa as Ie,B as W,C as Ce,E as xe,Ea as Ee,F as ae,G as j,Ga as G,H as ye,Oa as Fe,Pa as Ve,Qa as Pe,R as Te,Sa as Oe,Ta as Re,Ua as He,V as Se,W as $,Z as we,Za as Ne,_ as lt,hb as X,ib as Be,l as he,v as be,va as Ae,w as ve,wa as z,z as U}from"./chunk-GYDYF5F3.js";import{M as ue,Q as fe,f as ge,g as E,t as q}from"./chunk-PD5VTTIY.js";import{Aa as g,Ba as u,Bc as B,Hb as M,Ka as ne,Lc as S,Mc as m,Nc as C,Ob as p,Oc as L,Uc as D,Vc as A,Wc as I,Yc as k,Zc as ie,_b as s,ad as pe,bc as F,bd as _e,cc as V,dc as N,fc as me,kc as l,lb as ce,lc as o,mc as _,nc as h,oc as b,qc as x,rb as a,sb as y,wc as v,yc as c}from"./chunk-2NSPOFEK.js";import{g as H,i as te}from"./chunk-66YHNWRR.js";var ot=H(lt());function dt(t,n){if(t&1&&(l(0,"div")(1,"a",8),_(2,"i",9),o(),l(3,"a",10),_(4,"i",11),o(),l(5,"a",12),_(6,"i",13),o(),l(7,"a",14),_(8,"i",15),o()()),t&2){let e=c();V("flex justify-center mt-4 ",e.teamClass,"")}}function ct(t,n){if(t&1){let e=x();l(0,"div",16)(1,"button",17),v("click",function(){g(e);let r=c();return u(r.onPresentClick())}),m(2,"Present"),o(),l(3,"button",18),v("click",function(){g(e);let r=c();return u(r.onleaveClicked())}),m(4,"Leave"),o()()}}var J=class t{name;role;teamClass;class1;description;bodyClass;image;backgroundColor;badgeColor;showIcons;showButtons;presentClicked=new ne;leaveClicked=new ne;onPresentClick(){this.presentClicked.emit()}onleaveClicked(){this.leaveClicked.emit()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=M({type:t,selectors:[["spk-team-card"]],inputs:{name:"name",role:"role",teamClass:"teamClass",class1:"class1",description:"description",bodyClass:"bodyClass",image:"image",backgroundColor:"backgroundColor",badgeColor:"badgeColor",showIcons:"showIcons",showButtons:"showButtons"},outputs:{presentClicked:"presentClicked",leaveClicked:"leaveClicked"},decls:15,vars:19,consts:[[1,"box","team-member","text-center"],[1,"mb-4","leading-none","flex","gap-2","justify-center"],["alt","...",1,"card-img",3,"src"],[1,""],[1,"mb-3","font-semibold"],[1,"text-textmuted","dark:text-textmuted/50","text-xs"],[3,"class",4,"ngIf"],["class","flex view-more-button gap-2 items-center",4,"ngIf"],["aria-label","anchor","href","javascript:void(0);",1,"ti-btn","ti-btn-icon","ti-btn-soft-primary","btn-wave","ti-btn-sm","waves-effect","waves-light"],[1,"ri-twitter-x-fill"],["aria-label","anchor","href","javascript:void(0);",1,"ti-btn","ti-btn-icon","ti-btn-soft-primary1","btn-wave","ti-btn-sm","ms-2","waves-effect","waves-light"],[1,"ri-facebook-fill"],["aria-label","anchor","href","javascript:void(0);",1,"ti-btn","ti-btn-icon","ti-btn-soft-primary2","btn-wave","ti-btn-sm","ms-2","waves-effect","waves-light"],[1,"ri-instagram-line"],["aria-label","anchor","href","javascript:void(0);",1,"ti-btn","ti-btn-icon","ti-btn-soft-primary3","btn-wave","ti-btn-sm","ms-2","waves-effect","waves-light"],[1,"ri-linkedin-fill"],[1,"flex","view-more-button","gap-2","items-center"],["type","button",1,"ti-btn","ti-btn-outline-primary","btn-wave","flex-auto",3,"click"],["type","button",1,"ti-btn","ti-btn-outline-secondary","btn-wave","flex-auto",3,"click"]],template:function(e,i){e&1&&(l(0,"div",0),_(1,"div"),l(2,"div")(3,"div",1)(4,"span"),_(5,"img",2),o()(),l(6,"div",3)(7,"p"),m(8),o(),l(9,"h6",4),m(10),o(),l(11,"p",5),m(12),o(),p(13,dt,9,3,"div",6)(14,ct,5,0,"div",7),o()()()),e&2&&(a(),V("team-bg-shape ",i.backgroundColor,""),a(),V("box-body ",i.bodyClass,""),a(2),N("avatar ",i.class1," avatar-xl avatar-rounded bg-",i.backgroundColor,""),a(),s("src",i.image,ce),a(2),V("mb-2 text-[11px] badge leading-none bg-",i.badgeColor," font-medium"),a(),L("",i.role," "),a(2),C(i.name),a(2),C(i.description),a(),s("ngIf",i.showIcons),a(),s("ngIf",i.showButtons))},dependencies:[q,E],encapsulation:2})};var P=H(Be());var oe=H(Be());function ut(t,n){t&1&&(h(0),m(1,"This field is required"),b())}function ft(t,n){if(t&1&&(l(0,"div",23),p(1,ut,2,0,"ng-container",24),o()),t&2){c();let e=S(16);a(),s("ngIf",e.errors==null?null:e.errors.required)}}function ht(t,n){t&1&&(l(0,"span",14),m(1,"*"),o())}function bt(t,n){t&1&&(h(0),m(1,"This field is required"),b())}function vt(t,n){if(t&1&&(l(0,"div",23),p(1,bt,2,0,"ng-container",24),o()),t&2){c();let e=S(26);a(),s("ngIf",e.errors==null?null:e.errors.required)}}var K=class t{constructor(n,e){this.dialogRef=n;this.modalData=e;e.attend_date=(0,oe.default)(e.attend_date).format("d MMM y"),this.todayDate=(0,oe.default)(this.todayDate).format("d MMM y")}selectedStartTime;selectedStopTime;todayDate=new Date;closeDialog(){this.dialogRef.close()}submitTime(){this.dialogRef.close({punch_in:this.selectedStartTime,punch_out:this.selectedStopTime})}goToLeaveAdd(){this.dialogRef.close({leave:!0})}static \u0275fac=function(e){return new(e||t)(y(Fe),y(Ve))};static \u0275cmp=M({type:t,selectors:[["app-date-dialog"]],decls:34,vars:13,consts:[["f","ngForm"],["startTime","ngModel"],["pickerStart",""],["stopTime","ngModel"],["pickerStop",""],[1,"mat-dialoge"],[1,"flex","items-center","justify-between","p-3","py-1"],["mat-dialog-title",""],["type","button",1,"ti-btn","ti-btn-icon","bg-danger/10","text-danger","hover:bg-danger","hover:text-white","!rounded-full","btn-wave",3,"click"],[1,"ri-close-line"],[3,"ngSubmit"],[1,"mat-typography","py-1"],[1,"mb-3"],[1,"form-label","mb-0"],[1,"text-red-500"],[1,"mat-custom-field","remove-space"],["matInput","","placeholder","Select Start Time","name","startTime","required","",3,"ngModelChange","ngxTimepicker","ngModel"],["class","mt-1 text-xs text-red-500 text-right",4,"ngIf"],["class","text-red-500",4,"ngIf"],["matInput","","placeholder","Select Stop Time","name","stopTime",3,"ngModelChange","ngxTimepicker","ngModel","required"],["align","end",1,"gap-2"],["type","button",1,"ti-btn","ti-btn-outline-secondary","btn-wave","flex-auto",3,"click"],[3,"buttonType","buttonClass","iconClass","loadingIconClass"],[1,"mt-1","text-xs","text-red-500","text-right"],[4,"ngIf"]],template:function(e,i){if(e&1){let r=x();l(0,"div",5)(1,"div",6)(2,"p",7),m(3),o(),l(4,"button",8),v("click",function(){return g(r),u(i.closeDialog())}),_(5,"i",9),o()(),l(6,"form",10,0),v("ngSubmit",function(){g(r);let f=S(7);return u(f.valid&&i.submitTime())}),l(8,"mat-dialog-content",11)(9,"div",12)(10,"label",13),m(11,"Start Time"),l(12,"span",14),m(13,"*"),o()(),l(14,"mat-form-field",15)(15,"input",16,1),I("ngModelChange",function(f){return g(r),A(i.selectedStartTime,f)||(i.selectedStartTime=f),u(f)}),o(),_(17,"ngx-material-timepicker",null,2),o(),p(19,ft,2,1,"div",17),o(),l(20,"div",12)(21,"label",13),m(22,"Stop Time"),p(23,ht,2,0,"span",18),o(),l(24,"mat-form-field",15)(25,"input",19,3),I("ngModelChange",function(f){return g(r),A(i.selectedStopTime,f)||(i.selectedStopTime=f),u(f)}),o(),_(27,"ngx-material-timepicker",null,4),o(),p(29,vt,2,1,"div",17),o()(),l(30,"mat-dialog-actions",20)(31,"button",21),v("click",function(){return g(r),u(i.goToLeaveAdd())}),m(32,"Mark Leave"),o(),_(33,"app-button",22),o()()()}if(e&2){let r=S(7),d=S(16),f=S(18),w=S(26),R=S(28);a(3),L("Mark attendance of ",i.modalData==null?null:i.modalData.attend_date,""),a(12),s("ngxTimepicker",f),D("ngModel",i.selectedStartTime),a(4),s("ngIf",d.touched||r.submitted),a(4),s("ngIf",i.todayDate!=(i.modalData==null?null:i.modalData.attend_date)),a(2),B("required",i.todayDate!=(i.modalData==null?null:i.modalData.attend_date)),s("ngxTimepicker",R),D("ngModel",i.selectedStopTime),a(4),s("ngIf",w.touched||r.submitted),a(4),s("buttonType","submit")("buttonClass","ti-btn ti-btn-primary m-0")("iconClass","ri-save-line")("loadingIconClass","ri-loader-2-fill")}},dependencies:[X,Oe,He,Re,G,z,$,ye,U,W,Ce,Te,j,xe,Y,E,$e,et,Ze,Qe],encapsulation:2})};var T=H(st());var Ct=()=>["Attendance"],O=()=>[],xt=(t,n,e,i,r)=>({name:t,label:n,icon:e,count:i,subTab:r}),rt=t=>[t],yt=(t,n,e,i)=>({name:t,label:n,icon:e,subTab:i});function Tt(t,n){t&1&&_(0,"app-skeleton"),t&2&&F("w100 h30 bg-skeleton")}function St(t,n){t&1&&(h(0),l(1,"div",11),p(2,Tt,1,2,"app-skeleton",12),o(),b()),t&2&&(a(2),s("ngForOf",k(1,O).constructor(6)))}function wt(t,n){if(t&1){let e=x();l(0,"app-listing-tab",15),v("tabChange",function(r){g(e);let d=c(2);return u(d.onTabChange(r.tab,r.subTab))}),o()}if(t&2){let e=n.$implicit,i=c(2);s("tabs",ie(8,rt,_e(2,xt,e.name,e.label,e.icon,e.count,e.subTab)))("activeTab",i.activeTab)}}function Lt(t,n){if(t&1&&(h(0),l(1,"nav",13)(2,"nav",13),p(3,wt,1,10,"app-listing-tab",14),o()(),b()),t&2){let e=c();a(3),s("ngForOf",e.mainTabs)}}function kt(t,n){if(t&1){let e=x();l(0,"app-listing-tab",18),v("tabChange",function(r){g(e);let d=c(2);return u(d.onSubTabChange(r.subTab))}),o()}if(t&2){let e=n.$implicit,i=c(2);s("tabs",ie(8,rt,pe(3,yt,e.name,e.label,e.icon,e.name)))("activeTab",i.activeSubTab)("countShow",!1)}}function Mt(t,n){if(t&1&&(l(0,"nav",16),p(1,kt,1,10,"app-listing-tab",17),o()),t&2){let e=c();a(),s("ngForOf",e.subTabs)}}function Dt(t,n){if(t&1){let e=x();l(0,"div",19)(1,"input",20),I("ngModelChange",function(r){g(e);let d=c();return A(d.selectedMonth,r)||(d.selectedMonth=r),u(r)}),v("ngModelChange",function(){g(e);let r=c();return u(r.getMonthList())}),o()()}if(t&2){let e=c();a(),D("ngModel",e.selectedMonth),s("max",e.maxMonth)}}function At(t,n){if(t&1&&(l(0,"div",34),_(1,"i"),l(2,"span",35),_(3,"i",36),o(),l(4,"h6",23),m(5),o()()),t&2){let e=n.$implicit;a(),N("align-middle ",e.icon," ",e.color," text-[15px]"),a(4),C(e.label)}}function It(t,n){if(t&1){let e=x();l(0,"button",37),v("click",function(){g(e);let r=c(2);return r.filter.user_name="",u(r.getMonthList())}),l(1,"mat-icon"),m(2,"close"),o()()}}function Et(t,n){t&1&&(l(0,"span"),_(1,"i",44),o())}function Ft(t,n){t&1&&(l(0,"span"),_(1,"i",45),o())}function Vt(t,n){t&1&&(l(0,"span"),_(1,"i",46),o())}function Pt(t,n){t&1&&(l(0,"span"),_(1,"i",47),o())}function Ot(t,n){t&1&&(l(0,"span"),_(1,"i",48),o())}function Rt(t,n){t&1&&(l(0,"span"),_(1,"i",49),o())}function Ht(t,n){t&1&&(l(0,"span"),_(1,"i",50),o())}function Nt(t,n){if(t&1){let e=x();h(0),l(1,"td",43),v("click",function(){let r=g(e).$implicit,d=c().$implicit,f=c(3);return u(r!=null&&r.punched?f.goToDetail(r==null?null:r.attendance_id):f.accessRight!=null&&f.accessRight.addRight&&(r.weekOff||r.leave||r.absent)?f.markPresent(d.userId,r.date):null)}),p(2,Et,2,0,"span",2)(3,Ft,2,0,"span",2)(4,Vt,2,0,"span",2)(5,Pt,2,0,"span",2)(6,Ot,2,0,"span",2)(7,Rt,2,0,"span",2)(8,Ht,2,0,"span",2),o(),b()}if(t&2){let e=n.$implicit,i=c(4);a(),s("matTooltip",!(e!=null&&e.punched)&&(i.accessRight!=null&&i.accessRight.addRight)&&(e.weekOff||e.holiday||e.absent)?"Mark Present":""),a(),s("ngIf",e.punched),a(),s("ngIf",e.leave),a(),s("ngIf",e.weekOff),a(),s("ngIf",e.holiday),a(),s("ngIf",e.regionalHoliday),a(),s("ngIf",e.absent),a(),s("ngIf",e.halfday)}}function Bt(t,n){if(t&1&&(l(0,"tr",39)(1,"td",40),m(2),o(),l(3,"td",41),m(4),o(),l(5,"td",40),m(6),o(),l(7,"td",40),m(8),o(),l(9,"td",40),m(10),o(),l(11,"td",40),m(12),o(),l(13,"td",40),m(14),o(),l(15,"td",40),m(16),o(),p(17,Nt,9,8,"ng-container",42),o()),t&2){let e=n.$implicit,i=n.index;a(2),C(i+1),a(2),C(e.userName),a(2),C(e.totalWoringDays||"0"),a(2),C(e.totalPresentDays||"0"),a(2),C(e.totalAbsentDays||"0"),a(2),C(e.totalWeekOffDays||"0"),a(2),C(e.totalHolidayDays||"0"),a(2),C(e.totalLeaveDays||"0"),a(),s("ngForOf",e.attendanceData)}}function qt(t,n){if(t&1&&(h(0),p(1,Bt,18,9,"tr",38),b()),t&2){let e=c(2);a(),s("ngForOf",e.monthDaysData)}}function Ut(t,n){t&1&&(l(0,"td"),_(1,"app-skeleton"),o()),t&2&&(a(),F("h20 bg-skeleton"))}function Wt(t,n){if(t&1&&(l(0,"tr",52),p(1,Ut,2,2,"td",42),o()),t&2){let e=c(3);a(),s("ngForOf",e.monthListColumn)}}function jt(t,n){t&1&&(h(0),p(1,Wt,2,1,"tr",51),b()),t&2&&(a(),s("ngForOf",k(1,O).constructor(8)))}function $t(t,n){t&1&&(h(0),_(1,"app-data-not-found"),b())}function zt(t,n){if(t&1){let e=x();l(0,"div")(1,"div",21)(2,"div",22)(3,"h6",23),m(4,"Note:"),o(),l(5,"div",24),p(6,At,6,5,"div",25),o()(),l(7,"div")(8,"div",26)(9,"spk-reusable-tables",27)(10,"tr")(11,"td"),m(12,"\xA0"),o(),l(13,"td",28)(14,"div",29)(15,"mat-form-field",30)(16,"input",31),I("ngModelChange",function(r){g(e);let d=c();return A(d.filter.user_name,r)||(d.filter.user_name=r),u(r)}),v("keyup.enter",function(){g(e);let r=c();return u(r.getMonthList())}),o(),p(17,It,3,0,"button",32),o()()(),l(18,"td"),m(19,"\xA0"),o(),l(20,"td"),m(21,"\xA0"),o(),l(22,"td"),m(23,"\xA0"),o(),l(24,"td"),m(25,"\xA0"),o(),l(26,"td"),m(27,"\xA0"),o(),l(28,"td"),m(29,"\xA0"),o()(),p(30,qt,2,1,"ng-container",2)(31,jt,2,2,"ng-container",2),o(),p(32,$t,2,0,"ng-container",2),o()()(),l(33,"app-pagination-footer",33),v("preButtonClick",function(){g(e);let r=c();return u(r.changeToPagination("Previous"))})("nextButtonClick",function(){g(e);let r=c();return u(r.changeToPagination("Next"))})("pageChange",function(r){g(e);let d=c();return u(d.changeToPage(r))}),o()()}if(t&2){let e=c();a(6),s("ngForOf",e.attendanceStatuses),a(3),s("tableHeight","630px")("showFilterRow",!1)("showCheckbox",!1)("showS_No",!0)("showAction",!1)("columns",e.monthListColumn),a(7),D("ngModel",e.filter.user_name),a(),me(e.filter.user_name?17:-1),a(13),s("ngIf",!e.monthSkLoading),a(),s("ngIf",e.monthSkLoading),a(),s("ngIf",!e.monthSkLoading&&e.monthDaysData.length===0),a(),s("currentPage",e.listPagination.cur_page)("totalPage",e.listPagination.total_pages)("pageLimit",e.listPagination.limit)("listLength",e.monthDaysData.length)("preBtn",!e.listPagination.prev)("nextBtn",!e.listPagination.next)}}function Gt(t,n){if(t&1&&(h(0),l(1,"span"),m(2),o(),b()),t&2){let e=c().$implicit,i=c().$implicit;a(2),C((i==null?null:i[e.name])||(i==null||i.form_data==null?null:i.form_data[e.name])||"--")}}function Xt(t,n){if(t&1){let e=x();h(0),l(1,"a",57),v("click",function(){g(e);let r=c(2).$implicit,d=c(3);return u(d.goToDetailPage(r._id))}),m(2),o(),b()}if(t&2){let e=c().$implicit,i=c().$implicit;a(2),L(" ",(i==null?null:i[e.name])||(i==null||i.form_data==null?null:i.form_data[e.name])||"--"," ")}}function Yt(t,n){if(t&1&&(h(0),l(1,"span",58),m(2),o(),b()),t&2){let e=c().$implicit,i=c().$implicit;a(),B("matTooltip",i[e.name]||(i.form_data==null?null:i.form_data[e.name])||"--"),a(),L(" ",i[e.name]||(i.form_data==null?null:i.form_data[e.name])||"--"," ")}}function Jt(t,n){if(t&1&&(h(0),l(1,"td"),p(2,Gt,3,1,"ng-container",2)(3,Xt,3,1,"ng-container",2)(4,Yt,3,2,"ng-container",2),o(),b()),t&2){let e=n.$implicit;a(2),s("ngIf",!(e.name==="name"||e.name==="start_address"||e.name==="stop_address")),a(),s("ngIf",e.name==="name"),a(),s("ngIf",e.name==="start_address"||e.name==="stop_address")}}function Kt(t,n){if(t&1&&(l(0,"tr",56)(1,"td",28),m(2),o(),p(3,Jt,5,3,"ng-container",42),o()),t&2){let e=n.index,i=c(3);a(2),C(e+1),a(),s("ngForOf",i.PageHeaders)}}function Zt(t,n){if(t&1&&(h(0),p(1,Kt,4,2,"tr",55),b()),t&2){let e=c(2);a(),s("ngForOf",e.listingData[e.activeTab])}}function Qt(t,n){t&1&&(l(0,"td"),_(1,"app-skeleton"),o()),t&2&&(a(),F("h20 bg-skeleton"))}function en(t,n){t&1&&(l(0,"tr",52),p(1,Qt,2,2,"td",42),o()),t&2&&(a(),s("ngForOf",k(1,O).constructor(10)))}function tn(t,n){t&1&&(h(0),p(1,en,2,2,"tr",51),b()),t&2&&(a(),s("ngForOf",k(1,O).constructor(8)))}function nn(t,n){t&1&&(h(0),_(1,"app-data-not-found"),b())}function an(t,n){if(t&1){let e=x();l(0,"div")(1,"div",53)(2,"div",26)(3,"spk-reusable-tables",54),v("sortChanged",function(r){g(e);let d=c();return u(d.onSortChanged(r))})("selectionChange",function(r){g(e);let d=c();return u(d.handleSelectionChange(r))})("textSearchChange",function(r){g(e);let d=c();return u(d.updateSearchFilter(r))})("dateRangeChange",function(r){g(e);let d=c();return u(d.handleDateRangeChange(r))}),p(4,Zt,2,1,"ng-container",2)(5,tn,2,2,"ng-container",2),o(),p(6,nn,2,0,"ng-container",2),o()()()}if(t&2){let e=c();a(3),s("tableHead","border-b")("showS_No",!0)("showFilterRow",!0)("columns",e.PageHeaders),a(),s("ngIf",e.listingData[e.activeTab]==null?null:e.listingData[e.activeTab].length),a(),s("ngIf",e.skLoading),a(),s("ngIf",!(e.listingData[e.activeTab]!=null&&e.listingData[e.activeTab].length)&&!e.skLoading)}}function on(t,n){t&1&&(h(0),_(1,"div",60),b())}function rn(t,n){t&1&&(l(0,"div",62),_(1,"app-skeleton"),o()),t&2&&(a(),F("wp100 h40 mb-3"))}function ln(t,n){t&1&&(h(0),p(1,rn,2,2,"div",61),b()),t&2&&(a(),s("ngForOf",k(1,O).constructor(8)))}function sn(t,n){t&1&&(h(0),_(1,"app-data-not-found"),b())}function dn(t,n){if(t&1&&(l(0,"div",59),p(1,on,2,0,"ng-container",2)(2,ln,2,2,"ng-container",2)(3,sn,2,0,"ng-container",2),o()),t&2){let e=c();a(),s("ngIf",(e.liveMapList==null?null:e.liveMapList.length)&&!e.skLoading),a(),s("ngIf",e.skLoading),a(),s("ngIf",!e.skLoading&&!(e.liveMapList!=null&&e.liveMapList.length))}}function cn(t,n){if(t&1){let e=x();l(0,"div",65)(1,"spk-team-card",66),v("presentClicked",function(){let r=g(e).$implicit,d=c(3);return u(d.markPresent(r==null?null:r._id,d.todayDate))})("leaveClicked",function(){g(e);let r=c(3);return u(r.goToLeaveAdd())}),o()()}if(t&2){let e=n.$implicit,i=c(3);a(),s("name",e.name)("role",e.user_code)("class1",e.class1)("description",e.description)("image","./assets/images/faces/12.jpg")("badgeColor","primary")("showIcons",!1)("showButtons",i.accessRight==null?null:i.accessRight.addRight)}}function mn(t,n){if(t&1&&(h(0),l(1,"div",63),p(2,cn,2,8,"div",64),o(),b()),t&2){let e=c(2);a(2),s("ngForOf",e.listingData[e.activeTab])}}function pn(t,n){t&1&&(h(0),_(1,"app-data-not-found"),b())}function _n(t,n){if(t&1&&(l(0,"div")(1,"div",53),p(2,mn,3,1,"ng-container",2)(3,pn,2,0,"ng-container",2),o()()),t&2){let e=c();a(2),s("ngIf",e.listingData[e.activeTab]==null?null:e.listingData[e.activeTab].length),a(),s("ngIf",!(e.listingData[e.activeTab]!=null&&e.listingData[e.activeTab].length))}}var at=class t{constructor(n,e,i,r,d,f,w,R,Z){this.commanfunction=n;this.moduleService=e;this.toastr=i;this.api=r;this.alert=d;this.fb=f;this.router=w;this.dialog=R;this.CommonApiService=Z;let Q=new Date,re=Q.getFullYear(),le=String(Q.getMonth()+1).padStart(2,"0");this.selectedMonth=`${re}-${le}`,this.maxMonth=`${re}-${le}`;let se=this.moduleService.getAccessMap("SFA","Attendance");se&&(this.accessRight=se);let ee=this.moduleService.getSubModuleByName("SFA","Attendance"),de=this.moduleService.getTableById("SFA","Attendance",this.FORMID.ID.AttendanceTable);ee&&(this.moduleId=ee.module_id,this.moduleName=ee.title),de&&(this.moduleTableId=de.table_id),this.getHeaderConfigListing(),this.range=this.fb.group({start:new ae(null),end:new ae(null)})}ComponentPageType;mainTabs=[];subTabs=[];disabled=!1;filter={};sorting={};selectedField="";isModalOpen=!1;range;FORMID=ze;selectedChoices=[];allModulesData=[];mastersModule={};attendanceModule=[];moduleTableId=0;activeTab="Present";activeSubTab="List View";skLoading=!1;monthSkLoading=!1;monthDaysData=[];monthListColumn=[];fieldTypes=he;tableData={};tableHeader=[];moduleId=0;moduleName="";moduleFormId=0;maxMonth;accessRight={};onRefresh(){this.filter={},this.activeTab==="Total"?this.getMonthList():this.activeTab==="Present"?this.activeSubTab==="List View"?this.getHeaderConfigListing():this.getLiveMapView():this.getList()}onTabChange(n,e){this.filter={},this.activeTab=n,this.activeSubTab=e,this.activeTab==="Total"?this.getMonthList():this.activeTab==="Present"&&this.activeSubTab==="List View"?this.getHeaderConfigListing():this.getList()}onSubTabChange(n){this.activeSubTab=n,this.activeSubTab==="List View"?this.getHeaderConfigListing():this.getLiveMapView()}generateMonthDates(){let n=new Date,e=n.getMonth(),i=new Date(n.getFullYear(),e+1,0).getDate(),r=n.getDate();this.monthListColumn=[],this.monthListColumn.push({label:"User Name",value:"User Name"},{label:"Total Days",value:"Total Days"},{label:"Present",value:"Present"},{label:"Absent",value:"Absent"},{label:"Weekly Off",value:"Weekly Off"},{label:"Holiday",value:"Holiday"},{label:"Leaves",value:"Leaves"});for(let d=1;d<=this.monthDaysData?.[0]?.attendanceData?.length;d++)this.monthListColumn.push({label:d,value:d.toString()})}goToDetailPage(n){this.activeTab==="Present"&&this.router.navigate(["/apps/sfa/attendance-list/attendance-detail",n])}listPageData={};PageTableData={};allPageHeaders=[];attendancePageDropdowns={};getHeaderConfigListing(){this.CommonApiService.getHeaderConfigListing(this.moduleTableId,this.moduleFormId).subscribe(n=>{this.tableData=n.data,this.tableHeader=n.data.table_data.tableHead,this.tableHeader=this.tableHeader.filter(e=>e.list_view_checked),this.getList()})}listingData=[];listPagination={};page=1;getList(){this.skLoading=!0,this.api.post({filters:this.filter,sorting:this.sorting,page:this.page,ComponentPageType:this.ComponentPageType},"attendance/read").subscribe(n=>{n.statusCode===200&&(this.skLoading=!1,this.listingData=n.data,this.mainTabs=[{name:"Total",label:"Month",icon:"ri-team-fill",count:this.listingData.counters?.totalUsers||0,subTab:""},{name:"Present",label:"Present",icon:"ri-calendar-check-fill",count:this.listingData.counters?.totalPunched||0,subTab:"List View"},{name:"Absent",label:"Absent",icon:"ri-calendar-close-fill",count:this.listingData.counters?.totalAbsent||0,subTab:""},{name:"Weekly Off",label:"Weekly Off",icon:"ri-calendar-todo-fill",count:this.listingData.counters?.totalWeekOff||0,subTab:""},{name:"Holiday",label:"Holiday",icon:"ri-roadster-fill",count:this.listingData.counters?.totalHoliday||0,subTab:""},{name:"Leave",label:"Leave",icon:"ri-calendar-todo-fill",count:this.listingData.counters?.totalLeave||0,subTab:""}],this.subTabs=[{name:"List View",label:"List View",icon:"ri-layout-vertical-fill"},{name:"Map View",label:"Live Map View",icon:"ri-map-pin-fill"}],this.listingData={Total:n.data.totalUsers||[],Present:n.data.punchedUsers||[],Absent:n.data.absentUsers||[],"Weekly Off":n.data.weekOffUsers||[],Holiday:n.data.holidayUsers||[],Leave:n.data.leaveUsers||[]},this.listingData?.Present?.map(e=>{e.start_time=e.punch_in?P.default.utc(e.punch_in).utcOffset("+05:30").format("hh:mm a"):"-",e.stop_time=e.punch_out?P.default.utc(e.punch_out).utcOffset("+05:30").format("hh:mm a"):"-",e.attend_date=(0,P.default)(e.attend_date).format("DD MMM yy")}))})}goToLeaveAdd(){this.router.navigateByUrl("/apps/sfa/leave-list/leave-add")}convertToUTC(n,e){e=new Date(e);let i=e.toISOString().split("T")[0],r=n.match(/(\d+):(\d+)\s*(AM|PM)/i);if(!r)throw new Error("Invalid time format");let d=parseInt(r[1],10),f=parseInt(r[2],10),w=r[3].toUpperCase();w==="AM"?d===12&&(d=0):w==="PM"&&d!==12&&(d+=12);let R=`${i}T${String(d).padStart(2,"0")}:${String(f).padStart(2,"0")}:00`,Z=new Date(R);return new Date(Z.getTime()-Z.getTimezoneOffset()*6e4)}todayDate=new Date;markPresent(n,e){this.dialog.open(K,{data:{attend_date:e}}).afterClosed().subscribe(r=>{if(r){if(r.leave){this.goToLeaveAdd();return}let d=this.convertToUTC(r.punch_in,e),f=r.punch_out?this.convertToUTC(r.punch_out,e):null;this.api.post({user_id:n,punch_in:d,punch_out:f,attend_date:e},"attendance/punch-in").subscribe(w=>te(this,null,function*(){w.statusCode==200&&(this.toastr.success(w.message,"","toast-top-right"),this.activeTab!="Total"?this.getList():this.getMonthList())}))}})}goToDetail(n){this.router.navigate(["/apps/sfa/attendance-list/attendance-detail",n])}selectedMonth;getMonthList(){this.monthSkLoading=!0,this.selectedMonth&&(this.filter.month=this.selectedMonth.split("-")[1],this.filter.year=this.selectedMonth.split("-")[0]),this.filter=this.commanfunction.removeBlankKeys(this.filter),this.api.post({filters:this.filter,sorting:this.sorting,page:this.page},"attendance/month-read").subscribe(n=>{n.statusCode===200&&(this.monthSkLoading=!1,this.monthDaysData=n.data,this.listPagination=n.pagination,this.generateMonthDates())})}onSortChanged(n){this.sorting={},this.sorting[n.field]=n.order,this.getList()}changeToPagination(n){n=="Previous"?this.listPagination.prev&&this.page>1&&(this.page--,this.getList()):this.listPagination.next&&(this.page++,this.getList())}changeToPage(n){this.page=n,this.listPagination.cur_page=n,this.getList()}handleSelectionChange(n){let{category_name:e,selections:i}=n;this.filter[e]=i,this.getList()}updateSearchFilter(n){this.filter[n.name]=n.searchText,this.getList()}handleDateRangeChange(n){this.filter=n,this.getList()}onDeleteAttendance(n){this.alert.confirm("Are you sure?").then(e=>{e.isConfirmed&&this.api.patch({_id:n,is_delete:1},"attendance/delete").subscribe(i=>{i.statusCode===200&&(ot.default.fire("Deleted!",i.message,"success"),this.getList())})})}openHeaderSettingModal(){this.dialog.open(Je,{width:"450px",panelClass:"mat-right-modal",position:{right:"0px"},data:{lastPage:"header-config",moduleFormId:this.moduleFormId,moduleTableId:this.moduleTableId,PageTableData:this.tableData,allPageHeaders:this.tableHeader,PageHeaders:this.tableHeader}}).afterClosed().subscribe(e=>{e===!0&&(this.tableHeader=e.headers,this.getHeaderConfigListing())})}map;liveMapList=[];getLiveMapView(){this.skLoading=!0,this.api.post({attend_date:this.todayDate},"attendance/map-view").subscribe(n=>te(this,null,function*(){this.skLoading=!1,n.statusCode==200&&(this.liveMapList=n.data,this.liveMapList.length&&setTimeout(()=>{this.initializeMap()}))}))}initializeMap(){this.map=T.map("map").setView([28.6139,77.209],12),T.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.addMarkersToMap()}addMarkersToMap(){if(this.map){let n=T.icon({iconUrl:"./assets/images/faces/12.jpg",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),e=[];if(this.liveMapList&&Array.isArray(this.liveMapList)){if(this.liveMapList.forEach(i=>{let r=parseFloat(i.latitude),d=parseFloat(i.longitude);!isNaN(r)&&!isNaN(d)&&(T.marker([r,d],{icon:n}).addTo(this.map).bindPopup(`
                            Name: <b>${i?.created_name}</b><br>
                            Time: <b>${(0,P.default)(i?.created_at).format("hh:mm a")}</b><br>
                            Address: <b>${i?.location}</b>
                        `,{autoClose:!1}).openPopup(),e.push(T.latLng(r,d)))}),e.length){let i=T.latLngBounds(e);this.map.fitBounds(i,{padding:[50,50]})}}else console.error("listingData2 is not available or not in the correct format")}else console.error("Map is not initialized")}listingData2=[{start_lat:"28.4089",start_lng:"77.3178",customer_details:{customer_name:"ABC Enterprises",district:"Faridabad",state:"Haryana"}},{start_lat:"28.6139",start_lng:"77.2090",customer_details:{customer_name:"XYZ Traders",district:"New Delhi",state:"Delhi"}},{start_lat:"28.4595",start_lng:"77.0266",customer_details:{customer_name:"GHI Industries",district:"Gurugram",state:"Haryana"}}];attendanceStatuses=[{icon:"ri-star-fill",color:"text-primary",label:"Holiday"},{icon:"ri-calendar-2-fill",color:"text-primarytint1color",label:"Weekly Off"},{icon:"ri-check-double-line",color:"text-success",label:"Present"},{icon:"ri-star-half-line",color:"text-info",label:"Half Day"},{icon:"ri-close-line",color:"text-danger",label:"Absent"},{icon:"ri-flight-takeoff-fill",color:"text-primarytint2color",label:"On Leave"}];PageHeaders=[{id:1,label:"User Name",name:"name",placeholder:"Enter User Name",type:"SHORT_TEXT",min_length:0,max_length:0,show_guide:!1,required:!0,read_only:!1,validation_error:"User Name is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,id_child_dependency:!0,child_dependency:[],options:[],data_type:"string",sequence:1,class_name:"input-field",icon:"user",tooltip:"Enter the user\u2019s name.",grid_column:1,help_text:"User's personal identification.",validation_pattern:null,example_value:"John Doe",filter_checked:!0},{id:3,label:"User Code",name:"user_code",placeholder:"Enter User Code",type:"SHORT_TEXT",min_length:0,max_length:10,show_guide:!0,required:!0,read_only:!1,validation_error:"User Code is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,is_child_dependency:!1,options:[],data_type:"string",sequence:2,class_name:"input-field",icon:"code",tooltip:"Enter the user's unique code.",grid_column:2,help_text:"This code is used for identification.",validation_pattern:"^\\d+$",example_value:"12345",filter_checked:!0},{label:"Designation",name:"designation",type:"SHORT_TEXT",filter_checked:!0},{id:4,label:"Reporting Manager",name:"reporting_manager_name",placeholder:"Enter Reporting Manager's Name",type:"SHORT_TEXT",min_length:0,max_length:100,show_guide:!0,required:!0,read_only:!1,validation_error:"Reporting Manager's Name is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,is_child_dependency:!1,options:[],data_type:"string",sequence:3,class_name:"input-field",icon:"manager",tooltip:"Enter the name of the reporting manager.",grid_column:1,help_text:"The name of the person the user reports to.",validation_pattern:null,example_value:"Jane Smith",filter_checked:!0},{label:"Start Meter Reading",name:"start_meter_reading"},{label:"Uniform",name:"uniform"},{label:"Vehicle Type",name:"vehicle_type"},{label:"Working Type",name:"working_type"},{label:"Stop Meter Reading",name:"stop_meter_reading"},{id:5,label:"Start Time",name:"start_time",placeholder:"Select Start Time",type:"datetime",min_length:0,max_length:0,show_guide:!0,required:!0,read_only:!1,validation_error:"Start Time is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,id_child_dependency:!1,child_dependency:[],options:[],data_type:"datetime",sequence:4,class_name:"datetime-field",icon:"clock-in",tooltip:"Select the time when the user started their work.",grid_column:1,help_text:"The time when the user starts their work.",validation_pattern:null,example_value:"08:00 AM"},{id:6,label:"Stop Time",name:"stop_time",placeholder:"Select Stop Time",type:"datetime",min_length:0,max_length:0,show_guide:!0,required:!0,read_only:!1,validation_error:"Stop Time is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,id_child_dependency:!1,child_dependency:[],options:[],data_type:"datetime",sequence:5,class_name:"datetime-field",icon:"clock-out",tooltip:"Select the time when the user stopped their work.",grid_column:1,help_text:"The time when the user ends their work.",validation_pattern:null,example_value:"06:00 PM"},{id:7,label:"Start Address",name:"start_address",placeholder:"Enter Start Address",type:"input",min_length:0,max_length:255,show_guide:!0,required:!0,read_only:!1,validation_error:"Start Address is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,id_child_dependency:!1,child_dependency:[],options:[],data_type:"string",sequence:6,class_name:"input-field",icon:"location",tooltip:"Enter the start address of the user's work location.",grid_column:1,help_text:"The address where the user starts their work.",validation_pattern:null,example_value:"123 Main St, Cityville"},{id:8,label:"Stop Address",name:"stop_address",placeholder:"Enter Stop Address",type:"input",min_length:0,max_length:255,show_guide:!0,required:!0,read_only:!1,validation_error:"Stop Address is required.",parent_id:1,child:[],is_show:!0,is_enable:!0,is_parent_dependency:!1,id_child_dependency:!1,child_dependency:[],options:[],data_type:"string",sequence:7,class_name:"input-field",icon:"location",tooltip:"Enter the stop address of the user's work location.",grid_column:1,help_text:"The address where the user ends their work.",validation_pattern:null,example_value:"456 Oak St, Cityville"},{label:"Remark",name:"remark"}];static \u0275fac=function(e){return new(e||t)(y(Ge),y(De),y(ve),y(we),y(Le),y(Se),y(ue),y(Pe),y(ke))};static \u0275cmp=M({type:t,selectors:[["app-attendance-list"]],inputs:{ComponentPageType:"ComponentPageType"},decls:15,vars:19,consts:[[3,"buttonClick1","title","title1","activeitem","btnShow1","buttonText1","icon1","dataHsOverlay"],[1,"box","py-3","px-4"],[4,"ngIf"],[1,"row"],[1,"col-xl-12"],[1,"box"],["class","sm:flex sm:space-x-2 sm:rtl:space-x-reverse gap-1 py-2 px-4 pb-0","aria-label","Tabs","role","tablist",4,"ngIf"],[1,"flex","items-center","justify-between"],[3,"onRefresh","pageTitle","btnShow","refreshLabel"],["class","xl:col-span-4 col-span-12 m-3",4,"ngIf"],["class","p-4 pt-2",4,"ngIf"],[1,"flex","items-center","gap-3"],[3,"class",4,"ngFor","ngForOf"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1"],[3,"tabs","activeTab","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab"],["aria-label","Tabs","role","tablist",1,"sm:flex","sm:space-x-2","sm:rtl:space-x-reverse","gap-1","py-2","px-4","pb-0"],[3,"tabs","activeTab","countShow","tabChange",4,"ngFor","ngForOf"],[3,"tabChange","tabs","activeTab","countShow"],[1,"xl:col-span-4","col-span-12","m-3"],["type","month","name","selectedMonth",3,"ngModelChange","ngModel","max"],[1,"box-body","relative"],[1,"flex","items-center","px-4","py-0","mb-5"],[1,"text-sm"],[1,"attendant__info-wrapper"],["class","attendant__info-icon",4,"ngFor","ngForOf"],[1,"table-responsive","overflow-auto","table-bordered-default"],["tableClass","ti-custom-table text-nowrap ti-custom-table-hover",3,"tableHeight","showFilterRow","showCheckbox","showS_No","showAction","columns"],[1,"!text-center"],[1,"table-search-filters"],[1,"table-input"],["matInput","","type","text","placeholder","Search...",3,"ngModelChange","keyup.enter","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear"],[3,"preButtonClick","nextButtonClick","pageChange","currentPage","totalPage","pageLimit","listLength","preBtn","nextBtn"],[1,"attendant__info-icon"],[1,"attachment__info-arrow"],[1,"ri-arrow-right-line","text-textmuted"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["class","todo-box border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"todo-box","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"text-center"],[1,""],[4,"ngFor","ngForOf"],[1,"cursor-pointer",3,"click","matTooltip"],[1,"align-middle","ri-check-double-line","text-success","text-[15px]"],[1,"align-middle","ri-flight-takeoff-fill","text-primarytint2color","text-[15px]"],[1,"align-middle","ri-calendar-2-fill","text-primarytint1color","text-[15px]"],[1,"align-middle","ri-star-fill","text-primary","text-[15px]"],[1,"align-middle","ri-star-half-line","text-info","text-[15px]"],[1,"align-middle","ri-close-line","text-danger","text-[15px]"],[1,"align-middle","ri-star-half-line","text-[15px]","text-info"],["class","border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"box-body"],["tableClass","ti-custom-table ti-custom-table-head ti-custom-table-hover ti-head-primary whitespace-nowrap",3,"sortChanged","selectionChange","textSearchChange","dateRangeChange","tableHead","showS_No","showFilterRow","columns"],["class","attendance-list border-b !border-defaultborder dark:!border-defaultborder/10",4,"ngFor","ngForOf"],[1,"attendance-list","border-b","!border-defaultborder","dark:!border-defaultborder/10"],[1,"text-primary","font-semibold","underline",3,"click"],[1,"ellipsis",3,"matTooltip"],[1,"p-4","pt-2"],["id","map",2,"height","400px","width","100%"],["class","xl:col-span-12 col-span-12",4,"ngFor","ngForOf"],[1,"xl:col-span-12","col-span-12"],[1,"grid","grid-cols-12","gap-x-6"],["class","xl:col-span-3 lg:col-span-4 md:col-span-6 sm:col-span-6 col-span-12",4,"ngFor","ngForOf"],[1,"xl:col-span-3","lg:col-span-4","md:col-span-6","sm:col-span-6","col-span-12"],[3,"presentClicked","leaveClicked","name","role","class1","description","image","badgeColor","showIcons","showButtons"]],template:function(e,i){e&1&&(l(0,"app-page-header",0),v("buttonClick1",function(){return i.openHeaderSettingModal()}),o(),l(1,"div",1),p(2,St,3,2,"ng-container",2)(3,Lt,4,1,"ng-container",2),o(),l(4,"div",3)(5,"div",4)(6,"div",5),p(7,Mt,2,1,"nav",6),l(8,"div",7)(9,"app-page-sub-header",8),v("onRefresh",function(){return i.onRefresh()}),o(),p(10,Dt,2,2,"div",9),o(),p(11,zt,34,18,"div",2)(12,an,7,7,"div",2)(13,dn,4,3,"div",10)(14,_n,4,2,"div",2),o()()()),e&2&&(s("title","Attendance Modules")("title1",k(18,Ct))("activeitem","Attendance List")("btnShow1",!1)("buttonText1","Header Config")("icon1","settings")("dataHsOverlay","#attendance-header-config"),a(2),s("ngIf",i.skLoading),a(),s("ngIf",!i.skLoading),a(4),s("ngIf",i.activeTab==="Present"),a(2),s("pageTitle","Attendance List")("btnShow",!0)("refreshLabel","Refresh"),a(),s("ngIf",i.activeTab==="Total"),a(),s("ngIf",i.activeTab==="Total"),a(),s("ngIf",i.activeTab==="Present"&&i.activeSubTab==="List View"),a(),s("ngIf",i.activeTab==="Present"&&i.activeSubTab==="Map View"),a(),s("ngIf",i.activeTab!=="Total"&&i.activeTab!=="Present"))},dependencies:[Y,ge,E,U,W,j,Xe,Me,We,Ue,Ke,je,Ne,X,Ie,Ee,G,z,Ae,q,fe,qe,$,Ye,be,J],encapsulation:2})};export{at as a};
